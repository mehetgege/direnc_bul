<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3C3 Trading Bot - Complete Edition with WebSocket Trading</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        /* Reset ve Temel Stiller */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100% );
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            padding-top: 80px; /* Sticky header için boşluk */
        }

        /* Light Theme */
        body.light-theme {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #dee2e6 100%);
            color: #212529;
        }

        /* Sticky Header - En önemli kısım */
        .sticky-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding: 15px 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .light-theme .sticky-header {
            background: rgba(248, 249, 250, 0.95);
            border-bottom: 1px solid rgba(0,0,0,0.1);
            color: #212529;
        }

        .sticky-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .price-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .current-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: #4ECDC4;
            text-shadow: 0 2px 4px rgba(78, 205, 196, 0.3);
        }

        .light-theme .current-price {
            color: #2c3e50;
            text-shadow: none;
        }

        .price-change {
            font-size: 1rem;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .price-change.positive {
            background: rgba(0, 212, 170, 0.2);
            color: #00D4AA;
            border: 1px solid rgba(0, 212, 170, 0.3);
        }

        .price-change.negative {
            background: rgba(248, 73, 96, 0.2);
            color: #F84960;
            border: 1px solid rgba(248, 73, 96, 0.3);
        }

        .symbol-info {
            font-size: 0.9rem;
            color: #888;
            font-weight: 500;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quick-status {
            font-size: 0.8rem;
            padding: 6px 12px;
            border-radius: 15px;
            font-weight: 600;
            text-align: center;
        }

        .status-connected {
            background: rgba(0, 212, 170, 0.2);
            color: #00D4AA;
            border: 1px solid rgba(0, 212, 170, 0.3);
        }

        .status-trading {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .status-disconnected {
            background: rgba(248, 73, 96, 0.2);
            color: #F84960;
            border: 1px solid rgba(248, 73, 96, 0.3);
        }

        /* Container ve Grid Sistem */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .main-header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(15px);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .light-theme .main-header {
            background: rgba(255,255,255,0.8);
            border: 1px solid rgba(0,0,0,0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }

        /* Panel Tasarımı */
        .panel {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(15px);
            border-radius: 18px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .light-theme .panel {
            background: rgba(255,255,255,0.9);
            border: 1px solid rgba(0,0,0,0.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
       
        .panel:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 28px rgba(0,0,0,0.4);
            border-color: rgba(78, 205, 196, 0.3);
        }

        .panel h3 {
            color: #4ECDC4;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid rgba(78, 205, 196, 0.2);
            padding-bottom: 10px;
        }

        .light-theme .panel h3 {
            color: #2c3e50;
            border-bottom-color: rgba(44, 62, 80, 0.2);
        }

        /* Buton Tasarımları */
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 6px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn.success {
            background: linear-gradient(135deg, #00D4AA, #00ff88);
            color: #000;
            box-shadow: 0 4px 12px rgba(0, 212, 170, 0.3);
        }

        .btn.success:hover {
            box-shadow: 0 8px 20px rgba(0, 212, 170, 0.4);
        }

        .btn.danger {
            background: linear-gradient(135deg, #F84960, #FF6B6B);
            box-shadow: 0 4px 12px rgba(248, 73, 96, 0.3);
        }

        .btn.danger:hover {
            box-shadow: 0 8px 20px rgba(248, 73, 96, 0.4);
        }

        .btn.warning {
            background: linear-gradient(135deg, #FFC107, #FF8F00);
            color: #000;
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.3);
        }

        .btn.warning:hover {
            box-shadow: 0 8px 20px rgba(255, 193, 7, 0.4);
        }

        .btn.info {
            background: linear-gradient(135deg, #4ECDC4, #45B7D1);
            color: #000;
            box-shadow: 0 4px 12px rgba(78, 205, 196, 0.3);
        }

        .btn.info:hover {
            box-shadow: 0 8px 20px rgba(78, 205, 196, 0.4);
        }

        /* Input ve Form Elemanları */
        input, select, textarea {
            width: 100%;
            padding: 14px 16px;
            border-radius: 12px;
            border: 2px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.05);
            color: #fff;
            margin: 10px 0;
            font-size: 14px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4ECDC4;
            background: rgba(255,255,255,0.1);
            box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.1);
        }

        .light-theme input, .light-theme select, .light-theme textarea {
            background: rgba(0,0,0,0.05);
            border: 2px solid rgba(0,0,0,0.1);
            color: #212529;
        }

        .light-theme input:focus, .light-theme select:focus, .light-theme textarea:focus {
            border-color: #2c3e50;
            background: rgba(0,0,0,0.08);
            box-shadow: 0 0 0 3px rgba(44, 62, 80, 0.1);
        }

        input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .light-theme input::placeholder {
            color: rgba(0,0,0,0.5);
        }

        /* Responsive Tasarım */
        @media (max-width: 1200px) {
            .grid {
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
                gap: 20px;
            }
            
            .sticky-content {
                padding: 0 15px;
            }
            
            .current-price {
                font-size: 1.6rem;
            }
        }

        @media (max-width: 768px) {
            body {
                padding-top: 120px; /* Sticky header daha yüksek mobile'da */
            }
            
            .sticky-header {
                padding: 12px 15px;
            }
            
            .sticky-content {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .current-price {
                font-size: 1.4rem;
            }
            
            .price-change {
                font-size: 0.9rem;
            }
            
            .container {
                padding: 15px;
            }
            
            .grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .main-header {
                padding: 20px 15px;
            }
            
            .panel {
                padding: 18px;
            }
            
            .header-controls {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            body {
                padding-top: 140px;
            }
            
            .current-price {
                font-size: 1.2rem;
            }
            
            .price-change {
                font-size: 0.8rem;
                padding: 4px 8px;
            }
            
            .container {
                padding: 10px;
            }
            
            .main-header {
                padding: 15px 10px;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 13px;
                margin: 4px;
            }
            
            .panel {
                padding: 15px;
                border-radius: 15px;
            }
            
            .grid {
                gap: 12px;
            }
        }
        
</style>
</head>
<body>
    <!-- Sticky Header - Sayfayı scroll ederken üstte sabit kalacak -->
    <div class="sticky-header">
        <div class="sticky-content">
            <!-- Sol taraf: Fiyat bilgileri -->
            <div class="price-section">
                <div class="current-price" id="stickyPrice">$0.00000000</div>
                <div class="price-change positive" id="stickyChange">
                    <span>📈</span>
                    <span>+0.000%</span>
                </div>
                <div class="symbol-info" id="stickySymbol">Coin seçin</div>
            </div>
            
            <!-- Sağ taraf: Durum kontrolleri -->
            <div class="header-controls">
                <div class="quick-status status-disconnected" id="stickyConnection">
                    🔴 Bağlantısız
                </div>
                <div class="quick-status status-trading" id="stickyTrading">
                    ⏸️ Trading Kapalı
                </div>
                <button class="btn info" onclick="scrollToTop()" style="padding: 8px 12px; font-size: 12px;">
                    ⬆️ Üst
                </button>
            </div>
        </div>
    </div>

    <!-- Ana Container -->
    <div class="container">
        <!-- Ana Header (Sticky olmayan, detaylı bilgiler için) -->
        <div class="main-header">
            <h1 style="font-size: 2.5rem; margin-bottom: 20px; background: linear-gradient(135deg, #4ECDC4, #00D4AA); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                🚀 3C3 Advanced Trading Bot with WebSocket Trading
            </h1>
            
            <div style="margin: 25px 0;">
                <div style="font-size: 3rem; font-weight: 700; color: #4ECDC4; margin-bottom: 10px; text-shadow: 0 4px 8px rgba(78, 205, 196, 0.3);" id="mainHeaderPrice">
                    $0.00000000
                </div>
                <div style="font-size: 1.3rem; display: flex; align-items: center; justify-content: center; gap: 15px; flex-wrap: wrap;">
                    <span id="mainHeaderChange" style="padding: 8px 16px; border-radius: 25px; font-weight: 600;">📈 +0.000%</span>
                    <span style="font-size: 1rem; color: #888; font-weight: 500;" id="mainHeaderSymbol">Sembol yok</span>
                    <span style="font-size: 0.9rem; color: #666;" id="lastUpdateTime">Son güncelleme: -</span>
                </div>
            </div>
            
            <!-- Durum İndikatörleri -->
            <div style="display: flex; justify-content: center; gap: 25px; margin-top: 30px; flex-wrap: wrap;">
                <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 15px; min-width: 140px;">
                    <div style="font-size: 0.8rem; color: #888; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px;">Bağlantı Durumu</div>
                    <div id="mainConnectionStatus" style="font-size: 1rem; font-weight: 600; color: #F84960;">🔴 Bağlantı Yok</div>
                </div>
                
                <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 15px; min-width: 140px;">
                    <div style="font-size: 0.8rem; color: #888; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px;">AI Durumu</div>
                    <div id="mainAiStatus" style="font-size: 1rem; font-weight: 600; color: #4ECDC4;">🧠 AI Bekliyor</div>
                </div>
                
                <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 15px; min-width: 140px;">
                    <div style="font-size: 0.8rem; color: #888; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px;">Trading Durumu</div>
                    <div id="mainTradingStatus" style="font-size: 1rem; font-weight: 600; color: #FFC107;">⏸️ Kapalı</div>
                </div>
                
                <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 15px; min-width: 140px;">
                    <div style="font-size: 0.8rem; color: #888; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px;">Aktif Sinyal</div>
                    <div id="mainActiveSignals" style="font-size: 1rem; font-weight: 600; color: #888;">⏳ Sinyal Yok</div>
                </div>
            </div>
            
            <!-- Hızlı Eylemler -->
            <div style="margin-top: 25px; display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                <button class="btn success" onclick="quickConnect()" id="quickConnectBtn">
                    🔌 Hızlı Bağlan
                </button>
                <button class="btn warning" onclick="toggleTheme()">
                    🌙 Tema Değiştir
                </button>
                <button class="btn info" onclick="showHelp()">
                    ❓ Yardım
                </button>
                <button class="btn" onclick="showStats()">
                    📊 İstatistikler
                </button>
            </div>
        </div>

        <!-- Ana Grid Başlangıcı -->
        <div class="grid">
            <!-- Bağlantı ve Kontrol Paneli -->
            <div class="panel">
                <h3>🔗 Bağlantı ve Kontrol Merkezi</h3>
                
                <!-- Coin Seçimi -->
                <div style="margin-bottom: 25px;">
                    <label style="font-size: 1rem; color: #ccc; margin-bottom: 12px; display: block; font-weight: 500;">
                        📈 Analiz Edilecek Coin:
                    </label>
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <input type="text" id="manualSymbol" placeholder="Coin sembolü (BTC, ETH, PEPE, DOGE...)" 
                               style="flex: 1;" value="BTC">
                        <button class="btn info" onclick="searchCoin()" style="padding: 14px 20px;">
                            🔍 Ara
                        </button>
                    </div>
                    
                    <!-- Popüler Coinler -->
                    <div style="margin-bottom: 15px;">
                        <div style="font-size: 0.8rem; color: #888; margin-bottom: 8px;">Popüler Coinler:</div>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="selectCoin('BTC')">BTC</button>
                            <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="selectCoin('ETH')">ETH</button>
                            <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="selectCoin('PEPE')">PEPE</button>
                            <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="selectCoin('DOGE')">DOGE</button>
                            <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="selectCoin('SHIB')">SHIB</button>
                        </div>
                    </div>
                    
                    <!-- Bağlantı Butonu -->
                    <button class="btn success" id="connectBtn" onclick="toggleConnection()" 
                            style="width: 100%; font-size: 1.1rem; padding: 16px;">
                        🔌 WebSocket Bağlantısını Başlat
                    </button>
                </div>
                
                
<!-- Detaylı Bağlantı Bilgileri -->
                <div style="background: rgba(255,255,255,0.03); border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.1);">
                    <h4 style="color: #4ECDC4; margin-bottom: 15px; font-size: 1rem; display: flex; align-items: center; gap: 8px;">
                        📡 Bağlantı Detayları
                    </h4>
                    
                    <!-- 2x3 Grid ile bağlantı bilgileri -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; font-size: 0.9rem;">
                        <div style="padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">WebSocket Durumu:</div>
                            <div id="wsStatus" style="color: #F84960; font-weight: 600;">🔴 Kapalı</div>
                        </div>
                        
                        <div style="padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Trading WS:</div>
                            <div id="tradingWsStatus" style="color: #F84960; font-weight: 600;">🔴 Kapalı</div>
                        </div>
                        
                        <div style="padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Aktif Sembol:</div>
                            <div id="currentSymbol" style="color: #4ECDC4; font-weight: 600;">-</div>
                        </div>
                        
                        <div style="padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Son Güncelleme:</div>
                            <div id="lastUpdate" style="color: #888; font-weight: 600;">-</div>
                        </div>
                        
                        <div style="padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Ping Süresi:</div>
                            <div id="pingStatus" style="color: #888; font-weight: 600;">-</div>
                        </div>
                        
                        <div style="padding: 8px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Çalışma Süresi:</div>
                            <div id="uptime" style="color: #888; font-weight: 600;">-</div>
                        </div>
                    </div>
                </div>

                <!-- Hızlı Eylemler -->
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn warning" onclick="toggleTheme()" style="flex: 1; min-width: 120px;">
                        🌙 Tema
                    </button>
                    <button class="btn info" onclick="showConnectionLog()" style="flex: 1; min-width: 120px;">
                        📋 Log
                    </button>
                    <button class="btn" onclick="resetConnection()" style="flex: 1; min-width: 120px;">
                        🔄 Reset
                    </button>
                </div>
            </div>

            <!-- Live Trading Panel -->
            <div class="panel">
                <h3>🚀 Live Trading Merkezi</h3>
                
                <!-- API Credentials Bölümü -->
                <div style="margin-bottom: 25px;">
                    <label style="font-size: 1rem; color: #ccc; margin-bottom: 12px; display: block; font-weight: 500;">
                        🔑 MEXC API Credentials:
                    </label>
                    
                    <!-- API Key Input -->
                    <div style="margin-bottom: 12px;">
                        <label style="font-size: 0.8rem; color: #888; margin-bottom: 6px; display: block;">API Key:</label>
                        <input type="password" id="apiKey" placeholder="API Key buraya yapıştırın..." 
                               style="margin-bottom: 0;" 
                               onchange="saveApiCredentials()"
                               onfocus="showApiHelp('key')">
                    </div>
                    
                    <!-- API Secret Input -->
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.8rem; color: #888; margin-bottom: 6px; display: block;">API Secret:</label>
                        <input type="password" id="apiSecret" placeholder="API Secret buraya yapıştırın..." 
                               style="margin-bottom: 0;" 
                               onchange="saveApiCredentials()"
                               onfocus="showApiHelp('secret')">
                    </div>
                    
                    <!-- API Test Butonu -->
                    <button class="btn info" onclick="testApiCredentials()" id="testApiBtn" style="width: 100%; margin-bottom: 15px;">
                        🧪 API Credentials Test Et
                    </button>
                    
                    <!-- Güvenlik Uyarısı -->
                    <div style="font-size: 0.75rem; color: #FFC107; padding: 12px; background: rgba(255,193,7,0.1); border-radius: 8px; border-left: 4px solid #FFC107; margin-bottom: 15px;">
                        <div style="font-weight: 600; margin-bottom: 4px;">⚠️ Güvenlik Uyarısı:</div>
                        <div>• API anahtarlarınız tarayıcıda güvenli değil</div>
                        <div>• Sadece test için düşük miktarlar kullanın</div>
                        <div>• Gerçek trading için VPS server kullanın</div>
                    </div>
                </div>
                
                <!-- Trading Kontrol Alanı -->
                <div style="margin-bottom: 25px;">
                    <label style="font-size: 1rem; color: #ccc; margin-bottom: 12px; display: block; font-weight: 500;">
                        ⚡ Trading Kontrolleri:
                    </label>
                    
                    <!-- Trading Durum Kartları -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px;">
                        <div style="padding: 12px; background: rgba(255,255,255,0.05); border-radius: 10px; text-align: center; border: 2px solid transparent;" id="tradingStatusCard">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px; text-transform: uppercase;">Trading Durumu</div>
                            <div style="font-size: 1.1rem; font-weight: 700; color: #FFC107;" id="tradingStatus">⏸️ Kapalı</div>
                        </div>
                        
                        <div style="padding: 12px; background: rgba(255,255,255,0.05); border-radius: 10px; text-align: center;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px; text-transform: uppercase;">Position Size</div>
                            <div style="font-size: 1.1rem; font-weight: 700; color: #4ECDC4;" id="positionSizeDisplay">50 USDT</div>
                        </div>
                    </div>
                    
                    <!-- Ana Trading Butonu -->
                    <button class="btn success" id="tradingToggle" onclick="toggleTrading()" 
                            style="width: 100%; margin-bottom: 15px; font-size: 1.2rem; padding: 18px; position: relative; overflow: hidden;">
                        <span id="tradingButtonText">🟢 Trading Sistemini Başlat</span>
                        <div id="tradingButtonLoader" style="display: none; position: absolute; right: 20px;">
                            <div style="width: 20px; height: 20px; border: 2px solid #ffffff40; border-top: 2px solid #ffffff; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                        </div>
                    </button>
                    
                    <!-- Trading Açıklama -->
                    <div style="font-size: 0.8rem; color: #666; text-align: center; padding: 10px; background: rgba(255,255,255,0.03); border-radius: 8px;">
                        💡 <strong>Otomatik Trading:</strong> Sinyal geldiğinde belirlenen parametrelerle otomatik pozisyon açılır
                    </div>
                </div>
                
<!-- Aktif Pozisyon Görüntüleme Alanı -->
                <div style="margin-bottom: 20px;">
                    <label style="font-size: 1rem; color: #ccc; margin-bottom: 12px; display: block; font-weight: 500;">
                        📊 Aktif Pozisyon Durumu:
                    </label>
                    
                    <!-- Pozisyon Detay Kartı -->
                    <div id="positionStatus" style="min-height: 120px; background: rgba(0,0,0,0.4); border-radius: 12px; padding: 20px; border: 2px solid rgba(255,255,255,0.1); position: relative; overflow: hidden;">
                        <!-- Varsayılan Durum: Pozisyon Yok -->
                        <div id="noPositionState" style="text-align: center; color: #888; margin-top: 25px;">
                            <div style="font-size: 2.5rem; margin-bottom: 10px;">📊</div>
                            <div style="font-size: 1rem; font-weight: 500; margin-bottom: 5px;">Aktif pozisyon bulunmuyor</div>
                            <div style="font-size: 0.8rem; color: #666;">Sinyal geldiğinde otomatik pozisyon açılacak</div>
                        </div>
                        
                        <!-- Aktif Pozisyon Durumu (JavaScript ile gösterilecek) -->
                        <div id="activePositionState" style="display: none;">
                            <!-- Pozisyon detayları buraya dinamik olarak eklenecek -->
                        </div>
                    </div>
                </div>

                <!-- Hızlı Trading İstatistikleri -->
                <div style="margin-bottom: 15px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <div style="padding: 12px; background: rgba(0,212,170,0.1); border-radius: 10px; text-align: center; border: 1px solid rgba(0,212,170,0.2);">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px;">Günlük PnL</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #00D4AA;" id="dailyPnLDisplay">+0.00 USDT</div>
                        </div>
                        
                        <div style="padding: 12px; background: rgba(78,205,196,0.1); border-radius: 10px; text-align: center; border: 1px solid rgba(78,205,196,0.2);">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px;">Toplam İşlem</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #4ECDC4;" id="totalTradesDisplay">0</div>
                        </div>
                    </div>
                </div>

                <!-- Manuel İşlem Butonu -->
                <button class="btn warning" onclick="openManualTradeModal()" style="width: 100%; margin-bottom: 10px;">
                    ✋ Manuel İşlem Aç
                </button>
            </div>


            <!-- Aktif Sinyal Detayları Paneli -->
            <div class="panel">
                <h3>🎯 Aktif Sinyal Detayları</h3>
                
                <!-- Ana Sinyal Görüntüleme Kartı -->
                <div id="currentSignal" class="signal-box" style="min-height: 140px; position: relative; overflow: hidden;">
                    <!-- Varsayılan Durum: Sinyal Yok -->
                    <div id="noSignalState" style="text-align: center; color: #888; margin-top: 35px;">
                        <div style="font-size: 3rem; margin-bottom: 12px;">⏳</div>
                        <div style="font-size: 1.1rem; font-weight: 500; margin-bottom: 8px;">Sinyal bekleniyor...</div>
                        <div style="font-size: 0.85rem; color: #666;">AI market verilerini analiz ediyor</div>
                    </div>
                    
                    <!-- Aktif Sinyal Durumu (JavaScript ile gösterilecek) -->
                    <div id="activeSignalState" style="display: none;">
                        <!-- Sinyal detayları buraya dinamik olarak eklenecek -->
                    </div>
                </div>
                
                <!-- Sinyal Güven Seviyesi Göstergesi -->
                <div style="margin-top: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="font-size: 0.9rem; color: #ccc; font-weight: 500;">Güven Seviyesi:</span>
                        <span id="confidencePercent" style="color: #4ECDC4; font-weight: 600; font-size: 1rem;">0%</span>
                    </div>
                    
                    <!-- Animated Progress Bar -->
                    <div style="background: rgba(255,255,255,0.1); border-radius: 10px; height: 12px; overflow: hidden; position: relative;">
                        <div id="confidenceBar" style="background: linear-gradient(90deg, #F84960 0%, #FFC107 50%, #00D4AA 100%); height: 100%; width: 0%; transition: width 0.8s ease; border-radius: 10px; position: relative;">
                            <!-- Animasyonlu efekt -->
                            <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); animation: shimmer 2s infinite;"></div>
                        </div>
                    </div>
                    
                    <!-- Güven seviyesi açıklaması -->
                    <div style="display: flex; justify-content: space-between; font-size: 0.7rem; margin-top: 6px; color: #888;">
                        <span>Düşük (0-50%)</span>
                        <span>Orta (50-75%)</span>
                        <span>Yüksek (75-100%)</span>
                    </div>
                </div>

                <!-- Detaylı Sinyal Bilgileri Grid -->
                <div style="margin-top: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.85rem;">
                        <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Entry Price:</div>
                            <div id="signalEntryPrice" style="color: #4ECDC4; font-weight: 600;">-</div>
                        </div>
                        
                        <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Strateji:</div>
                            <div id="signalStrategy" style="color: #FFC107; font-weight: 600;">-</div>
                        </div>
                        
                        <div style="padding: 10px; background: rgba(0,212,170,0.1); border-radius: 8px; border: 1px solid rgba(0,212,170,0.2);">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Take Profit:</div>
                            <div id="signalTakeProfit" style="color: #00D4AA; font-weight: 600;">-</div>
                        </div>
                        
                        <div style="padding: 10px; background: rgba(248,73,96,0.1); border-radius: 8px; border: 1px solid rgba(248,73,96,0.2);">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Stop Loss:</div>
                            <div id="signalStopLoss" style="color: #F84960; font-weight: 600;">-</div>
                        </div>
                        
                        <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Süre:</div>
                            <div id="signalDuration" style="color: #888; font-weight: 600;">-</div>
                        </div>
                        
                        <div style="padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                            <div style="color: #888; font-size: 0.75rem; margin-bottom: 4px;">Zaman Damgası:</div>
                            <div id="signalTimestamp" style="color: #888; font-weight: 600;">-</div>
                        </div>
                    </div>
                </div>

                <!-- Sinyal Eylem Butonları -->
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn success" onclick="acceptSignal()" id="acceptSignalBtn" style="flex: 1;" disabled>
                        ✅ Sinyali Kabul Et
                    </button>
                    <button class="btn danger" onclick="rejectSignal()" id="rejectSignalBtn" style="flex: 1;" disabled>
                        ❌ Sinyali Reddet
                    </button>
                </div>
                
                <!-- Test Sinyal Butonu -->
                <button class="btn info" onclick="generateTestSignal()" style="width: 100%; margin-top: 10px;">
                    🧪 Test Sinyali Oluştur
                </button>
            </div>
            
<!-- Debug Console Panel - Geliştiriciler için önemli -->
            <div class="panel">
                <h3>🔧 Debug Console ve API Test</h3>
                
                <!-- Debug Console Kontrolleri -->
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px; margin-bottom: 12px; flex-wrap: wrap;">
                        <button class="btn info" onclick="clearDebugConsole()" style="padding: 8px 16px; font-size: 0.85rem;">
                            🗑️ Temizle
                        </button>
                        <button class="btn" onclick="toggleDebugAutoScroll()" id="autoScrollBtn" style="padding: 8px 16px; font-size: 0.85rem;">
                            📜 Auto Scroll: ON
                        </button>
                        <button class="btn warning" onclick="exportDebugLog()" style="padding: 8px 16px; font-size: 0.85rem;">
                            📤 Log Export
                        </button>
                    </div>
                </div>
                
                <!-- Gerçek Zamanlı Debug Output - Mobil friendly scrollable area -->
                <div id="mobileDebugConsole" style="
                    background: rgba(0,0,0,0.9); 
                    border-radius: 10px; 
                    padding: 15px; 
                    max-height: 250px; 
                    overflow-y: auto; 
                    font-family: 'Courier New', 'Monaco', monospace; 
                    font-size: 11px;
                    border: 2px solid rgba(78, 205, 196, 0.3);
                    scrollbar-width: thin;
                    scrollbar-color: #4ECDC4 transparent;
                ">
                    <div style="color: #4ECDC4; border-left: 3px solid #4ECDC4; padding-left: 8px;">
                        [System Ready] 3C3 Trading Bot debug console hazır...
                    </div>
                    <div style="color: #888; border-left: 3px solid #888; padding-left: 8px; margin-top: 4px;">
                        [Info] WebSocket bağlantısı için coin sembolü girin
                    </div>
                </div>
                
                <!-- API Test Araçları -->
                <div style="margin-top: 20px;">
                    <h4 style="color: #FFC107; font-size: 0.95rem; margin-bottom: 12px;">🧪 API Test Araçları:</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <button class="btn info" onclick="testApiConnection()" style="padding: 10px; font-size: 0.8rem;">
                            🔌 API Bağlantı Test
                        </button>
                        <button class="btn info" onclick="testWithDifferentProxies()" style="padding: 10px; font-size: 0.8rem;">
                            🔄 Proxy Test
                        </button>
                        <button class="btn info" onclick="pingMexcServers()" style="padding: 10px; font-size: 0.8rem;">
                            📡 MEXC Ping Test
                        </button>
                        <button class="btn info" onclick="checkSystemHealth()" style="padding: 10px; font-size: 0.8rem;">
                            💚 Sistem Sağlık Check
                        </button>
                    </div>
                </div>
            </div>

            <!-- Bot Ayarları Panel - Kullanıcı konfigürasyonları için kritik -->
            <div class="panel">
                <h3>⚙️ Bot Ayarları ve AI Konfigürasyonu</h3>
                
                <!-- Sinyal Parametreleri Bölümü -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #4ECDC4; font-size: 1rem; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        🎯 Sinyal Parametreleri
                    </h4>
                    
                    <!-- Volume Threshold Slider -->
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.85rem; color: #ccc; margin-bottom: 8px; display: block;">
                            Volume Eşiği (1.2x - 5.0x):
                        </label>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <input type="range" id="volumeThreshold" min="1.2" max="5.0" step="0.1" value="2.0" 
                                   style="flex: 1; width: auto; margin: 0;" 
                                   onchange="updateBotSetting('volumeThreshold', this.value)"
                                   oninput="updateSliderDisplay('volumeThresholdValue', this.value + 'x')">
                            <span id="volumeThresholdValue" style="color: #00D4AA; font-weight: 600; min-width: 45px;">2.0x</span>
                        </div>
                        <div style="font-size: 0.7rem; color: #666; margin-top: 4px;">
                            Yüksek değer = Daha güvenilir ama daha az sinyal
                        </div>
                    </div>
                    
                    <!-- Take Profit Percentage Slider -->
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.85rem; color: #ccc; margin-bottom: 8px; display: block;">
                            Take Profit Yüzdesi (0.3% - 3.0%):
                        </label>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <input type="range" id="takeProfitPercent" min="0.3" max="3.0" step="0.1" value="0.8" 
                                   style="flex: 1; width: auto; margin: 0;" 
                                   onchange="updateBotSetting('takeProfitPercent', this.value)"
                                   oninput="updateSliderDisplay('takeProfitValue', this.value + '%')">
                            <span id="takeProfitValue" style="color: #00D4AA; font-weight: 600; min-width: 45px;">0.8%</span>
                        </div>
                    </div>

                    <!-- Stop Loss Percentage Slider -->
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.85rem; color: #ccc; margin-bottom: 8px; display: block;">
                            Stop Loss Yüzdesi (0.2% - 2.0%):
                        </label>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <input type="range" id="stopLossPercent" min="0.2" max="2.0" step="0.1" value="0.5" 
                                   style="flex: 1; width: auto; margin: 0;" 
                                   onchange="updateBotSetting('stopLossPercent', this.value)"
                                   oninput="updateSliderDisplay('stopLossValue', this.value + '%')">
                            <span id="stopLossValue" style="color: #F84960; font-weight: 600; min-width: 45px;">0.5%</span>
                        </div>
                    </div>

                    <!-- Minimum Confidence Slider -->
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.85rem; color: #ccc; margin-bottom: 8px; display: block;">
                            Minimum Güven Seviyesi (50% - 95%):
                        </label>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <input type="range" id="minConfidence" min="50" max="95" step="5" value="70" 
                                   style="flex: 1; width: auto; margin: 0;" 
                                   onchange="updateBotSetting('minConfidence', this.value)"
                                   oninput="updateSliderDisplay('minConfidenceValue', this.value + '%')">
                            <span id="minConfidenceValue" style="color: #4ECDC4; font-weight: 600; min-width: 45px;">70%</span>
                        </div>
                    </div>

                    <!-- Position Size Input -->
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.85rem; color: #ccc; margin-bottom: 8px; display: block;">
                            Position Size (USDT):
                        </label>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <input type="number" id="positionSizeInput" min="0.1" max="10000" step="0.1" value="50" 
                                   style="flex: 1; width: auto; margin: 0; padding: 8px 12px;" 
                                   onchange="updatePositionSize(this.value)"
                                   placeholder="Position boyutu...">
                            <span style="color: #4ECDC4; font-weight: 600; font-size: 0.9rem;">USDT</span>
                        </div>
                        <div style="font-size: 0.7rem; color: #666; margin-top: 4px;">
                            Min: 0.1 USDT | Max: 10,000 USDT | Leverage: 20x
                        </div>
                    </div>
                </div>

                <!-- AI Ayarları Bölümü -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #FF6B6B; font-size: 1rem; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        🧠 AI Öğrenme Ayarları
                    </h4>
                    
                    <!-- AI Özellikleri Checkboxlar -->
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.85rem; color: #ccc; display: flex; align-items: center; gap: 10px; margin-bottom: 8px; cursor: pointer;">
                            <input type="checkbox" id="autoOptimization" checked 
                                   style="width: auto; margin: 0;" 
                                   onchange="updateBotSetting('autoOptimization', this.checked)">
                            <span>Otomatik Optimizasyon (AI kendini geliştirir)</span>
                        </label>
                        
                        <label style="font-size: 0.85rem; color: #ccc; display: flex; align-items: center; gap: 10px; margin-bottom: 8px; cursor: pointer;">
                            <input type="checkbox" id="adaptiveThresholds" checked 
                                   style="width: auto; margin: 0;" 
                                   onchange="updateBotSetting('adaptiveThresholds', this.checked)">
                            <span>Adaptif Eşikler (Performansa göre ayarlama)</span>
                        </label>
                        
                        <label style="font-size: 0.85rem; color: #ccc; display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="riskManagement" checked 
                                   style="width: auto; margin: 0;" 
                                   onchange="updateBotSetting('riskManagement', this.checked)">
                            <span>Gelişmiş Risk Yönetimi</span>
                        </label>
                    </div>

                    <!-- Learning Speed Dropdown -->
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 0.85rem; color: #ccc; margin-bottom: 8px; display: block;">
                            AI Öğrenme Hızı:
                        </label>
                        <select id="learningSpeed" 
                                style="width: 100%; margin: 0; padding: 10px;" 
                                onchange="updateBotSetting('learningSpeed', this.value)">
                            <option value="slow">🐌 Yavaş - Konservatif öğrenme</option>
                            <option value="medium" selected>⚡ Orta - Dengeli öğrenme</option>
                            <option value="fast">🚀 Hızlı - Agresif öğrenme</option>
                        </select>
                    </div>
                </div>
               
<!-- Bot Ayarları Eylem Butonları - Bu butonlar kullanıcının yapılandırmalarını yönetir -->
                <div style="margin-top: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                        <button class="btn success" onclick="saveSettings()" style="padding: 12px; font-size: 0.9rem;">
                            💾 Ayarları Kaydet
                        </button>
                        <button class="btn warning" onclick="resetSettings()" style="padding: 12px; font-size: 0.9rem;">
                            🔄 Varsayılana Dön
                        </button>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                        <button class="btn danger" onclick="resetAI()" style="padding: 10px; font-size: 0.8rem;">
                            🧠 AI Sıfırla
                        </button>
                        <button class="btn info" onclick="exportSettings()" style="padding: 10px; font-size: 0.8rem;">
                            📤 Export
                        </button>
                        <button class="btn info" onclick="importSettings()" style="padding: 10px; font-size: 0.8rem;">
                            📥 Import
                        </button>
                    </div>
                </div>
            </div>


            <!-- Strateji Performans Analizi Paneli - AI öğrenme sisteminin kalbi -->
            <div class="panel">
                <h3>📊 Strateji Performans Analizi</h3>
                
                <!-- Bu panel, AI'nin farklı trading stratejilerinin başarısını takip eder -->
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 0.85rem; color: #888; margin-bottom: 12px;">
                        AI sisteminin her strateji için öğrendiği performans metrikleri:
                    </div>
                    
                    <!-- Whale Strategy Performance - Büyük balina emirlerini takip eden strateji -->
                    <div style="background: rgba(255,107,107,0.1); border-radius: 10px; padding: 15px; margin-bottom: 12px; border: 1px solid rgba(255,107,107,0.2);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 600; color: #FF6B6B; display: flex; align-items: center; gap: 8px;">
                                🐋 Whale Orders Stratejisi
                                <span style="font-size: 0.7rem; background: rgba(255,107,107,0.2); padding: 2px 6px; border-radius: 4px;" id="whaleStrategyStatus">Öğreniyor</span>
                            </span>
                            <span id="whaleSuccess" style="color: #FF6B6B; font-weight: 700; font-size: 1.1rem;">0% (0/0)</span>
                        </div>
                        <div style="font-size: 0.75rem; color: #888; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                            <span>Avg Profit: <strong id="whaleAvgProfit" style="color: #FF6B6B;">0.00%</strong></span>
                            <span>Avg Time: <strong id="whaleAvgTime" style="color: #FF6B6B;">-</strong></span>
                            <span>Güvenilirlik: <strong id="whaleReliability" style="color: #FF6B6B;">-%</strong></span>
                        </div>
                    </div>
                    
                    <!-- Order Imbalance Strategy - Emir dengesizliklerini analiz eden strateji -->
                    <div style="background: rgba(255,193,7,0.1); border-radius: 10px; padding: 15px; margin-bottom: 12px; border: 1px solid rgba(255,193,7,0.2);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 600; color: #FFC107; display: flex; align-items: center; gap: 8px;">
                                ⚖️ Order Imbalance Stratejisi
                                <span style="font-size: 0.7rem; background: rgba(255,193,7,0.2); padding: 2px 6px; border-radius: 4px;" id="imbalanceStrategyStatus">Öğreniyor</span>
                            </span>
                            <span id="imbalanceSuccess" style="color: #FFC107; font-weight: 700; font-size: 1.1rem;">0% (0/0)</span>
                        </div>
                        <div style="font-size: 0.75rem; color: #888; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                            <span>Avg Profit: <strong id="imbalanceAvgProfit" style="color: #FFC107;">0.00%</strong></span>
                            <span>Avg Time: <strong id="imbalanceAvgTime" style="color: #FFC107;">-</strong></span>
                            <span>Güvenilirlik: <strong id="imbalanceReliability" style="color: #FFC107;">-%</strong></span>
                        </div>
                    </div>
                    
                    <!-- Volume Spike Strategy - Hacim patlamalarını takip eden strateji -->
                    <div style="background: rgba(78,205,196,0.1); border-radius: 10px; padding: 15px; margin-bottom: 12px; border: 1px solid rgba(78,205,196,0.2);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 600; color: #4ECDC4; display: flex; align-items: center; gap: 8px;">
                                📈 Volume Spike Stratejisi
                                <span style="font-size: 0.7rem; background: rgba(78,205,196,0.2); padding: 2px 6px; border-radius: 4px;" id="volumeStrategyStatus">Öğreniyor</span>
                            </span>
                            <span id="volumeSuccess" style="color: #4ECDC4; font-weight: 700; font-size: 1.1rem;">0% (0/0)</span>
                        </div>
                        <div style="font-size: 0.75rem; color: #888; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                            <span>Avg Profit: <strong id="volumeAvgProfit" style="color: #4ECDC4;">0.00%</strong></span>
                            <span>Avg Time: <strong id="volumeAvgTime" style="color: #4ECDC4;">-</strong></span>
                            <span>Güvenilirlik: <strong id="volumeReliability" style="color: #4ECDC4;">-%</strong></span>
                        </div>
                    </div>
                    
                    <!-- Support/Resistance Strategy - Destek ve direnç seviyelerini analiz eden strateji -->
                    <div style="background: rgba(0,212,170,0.1); border-radius: 10px; padding: 15px; margin-bottom: 12px; border: 1px solid rgba(0,212,170,0.2);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-weight: 600; color: #00D4AA; display: flex; align-items: center; gap: 8px;">
                                📏 Support/Resistance Stratejisi
                                <span style="font-size: 0.7rem; background: rgba(0,212,170,0.2); padding: 2px 6px; border-radius: 4px;" id="srStrategyStatus">Öğreniyor</span>
                            </span>
                            <span id="srSuccess" style="color: #00D4AA; font-weight: 700; font-size: 1.1rem;">0% (0/0)</span>
                        </div>
                        <div style="font-size: 0.75rem; color: #888; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                            <span>Avg Profit: <strong id="srAvgProfit" style="color: #00D4AA;">0.00%</strong></span>
                            <span>Avg Time: <strong id="srAvgTime" style="color: #00D4AA;">-</strong></span>
                            <span>Güvenilirlik: <strong id="srReliability" style="color: #00D4AA;">-%</strong></span>
                        </div>
                    </div>

                    <!-- En İyi Strateji Önerisi - AI'nin öğrendiği en başarılı strateji -->
                    <div style="margin-top: 15px; padding: 15px; background: linear-gradient(135deg, rgba(0,212,170,0.1), rgba(78,205,196,0.1)); border-radius: 12px; border: 2px solid rgba(0,212,170,0.3);">
                        <div style="font-size: 0.9rem; font-weight: 600; color: #00D4AA; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                            🏆 AI Tarafından Önerilen En İyi Strateji
                        </div>
                        <div style="font-size: 1rem; font-weight: 700; color: #ffffff; margin-bottom: 6px;" id="bestStrategy">
                            Veri toplanıyor...
                        </div>
                        <div style="font-size: 0.8rem; color: #888;" id="bestStrategyDetails">
                            En az 3 işlem tamamlandıktan sonra AI en iyi stratejiyi belirleyecek
                        </div>
                        
                        <!-- Best Strategy Progress Indicator -->
                        <div style="margin-top: 10px;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 4px;">AI Analiz İlerlemesi:</div>
                            <div style="background: rgba(255,255,255,0.1); height: 6px; border-radius: 3px; overflow: hidden;">
                                <div id="aiAnalysisProgress" style="background: linear-gradient(90deg, #00D4AA, #4ECDC4); height: 100%; width: 0%; transition: width 0.5s ease;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Strateji Karşılaştırma Grafik Alanı (placeholder) -->
                <div style="margin-top: 20px;">
                    <h4 style="color: #4ECDC4; font-size: 0.95rem; margin-bottom: 10px;">📈 Performans Karşılaştırması:</h4>
                    <div id="strategyComparisonChart" style="background: rgba(0,0,0,0.3); border-radius: 8px; padding: 20px; text-align: center; color: #888; border: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-size: 1.5rem; margin-bottom: 10px;">📊</div>
                        <div>Yeterli veri toplandıktan sonra strateji karşılaştırma grafiği burada görünecek</div>
                    </div>
                </div>
            </div>
           
<!-- Sinyal Geçmişi ve İstatistikler Paneli - Trading performansının detaylı analizini yapan kritik bileşen -->
            <div class="panel">
                <h3>📈 Sinyal Geçmişi ve Performans İstatistikleri</h3>
                
                <!-- Ana İstatistik Kartları - Hızlı performans özeti için tasarlanmış responsive grid yapısı -->
                <div style="margin-bottom: 25px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                        <!-- Toplam Sinyal Sayısı - Sistemin ürettiği tüm sinyallerin sayısını gösterir -->
                        <div style="text-align: center; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 12px; border: 2px solid rgba(255,255,255,0.1); transition: all 0.3s ease;">
                            <div style="font-size: 1.8rem; font-weight: 700; color: #ffffff; margin-bottom: 6px;" id="totalSignals">0</div>
                            <div style="font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 1px;">Toplam Sinyal</div>
                            <div style="font-size: 0.65rem; color: #666; margin-top: 4px;" id="totalSignalsSubtext">Tüm zamanlar</div>
                        </div>
                        
                        <!-- Başarılı Sinyal Sayısı - Take Profit ile kapanan sinyaller -->
                        <div style="text-align: center; padding: 15px; background: rgba(0,212,170,0.1); border-radius: 12px; border: 2px solid rgba(0,212,170,0.3); transition: all 0.3s ease;">
                            <div style="font-size: 1.8rem; font-weight: 700; color: #00D4AA; margin-bottom: 6px;" id="successfulSignals">0</div>
                            <div style="font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 1px;">Başarılı</div>
                            <div style="font-size: 0.65rem; color: #00D4AA; margin-top: 4px;" id="successfulSignalsSubtext">TP Hit</div>
                        </div>
                        
                        <!-- Başarı Oranı Yüzdesi - Kazanma oranının matematiksel hesaplaması -->
                        <div style="text-align: center; padding: 15px; background: rgba(78,205,196,0.1); border-radius: 12px; border: 2px solid rgba(78,205,196,0.3); transition: all 0.3s ease;">
                            <div style="font-size: 1.8rem; font-weight: 700; color: #4ECDC4; margin-bottom: 6px;" id="successRate">0.0%</div>
                            <div style="font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 1px;">Başarı Oranı</div>
                            <div style="font-size: 0.65rem; color: #4ECDC4; margin-top: 4px;" id="successRateSubtext">Win Rate</div>
                        </div>
                        
                        <!-- Ortalama Kar Yüzdesi - Tüm işlemlerin kar/zarar ortalaması -->
                        <div style="text-align: center; padding: 15px; background: rgba(255,193,7,0.1); border-radius: 12px; border: 2px solid rgba(255,193,7,0.3); transition: all 0.3s ease;">
                            <div style="font-size: 1.8rem; font-weight: 700; color: #FFC107; margin-bottom: 6px;" id="avgProfit">+0.00%</div>
                            <div style="font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 1px;">Avg Kar</div>
                            <div style="font-size: 0.65rem; color: #FFC107; margin-top: 4px;" id="avgProfitSubtext">Per Trade</div>
                        </div>
                    </div>
                </div>

                <!-- Zaman Bazlı Performans Analizi - Farklı zaman dilimlerindeki başarı metriklerini karşılaştırır -->
                <div style="margin-bottom: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="color: #4ECDC4; font-size: 1rem; margin: 0; display: flex; align-items: center; gap: 8px;">
                            ⏰ Zaman Bazlı Performans
                        </h4>
                        <!-- Zaman dilimi seçici - Kullanıcının analiz etmek istediği periyodu seçmesini sağlar -->
                        <select id="timeFrameSelector" style="width: auto; padding: 6px 12px; font-size: 0.8rem; margin: 0;" onchange="updateTimeFrameStats(this.value)">
                            <option value="today">Bugün</option>
                            <option value="week">Bu Hafta</option>
                            <option value="month">Bu Ay</option>
                            <option value="all" selected>Tüm Zamanlar</option>
                        </select>
                    </div>
                    
                    <!-- Responsive zaman bazlı istatistik kartları -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
                        <!-- Bugünkü Performans - Son 24 saatin özeti -->
                        <div style="padding: 12px; background: rgba(0,212,170,0.05); border-radius: 10px; border: 1px solid rgba(0,212,170,0.2); transition: all 0.3s ease;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 8px; text-transform: uppercase; display: flex; align-items: center; gap: 6px;">
                                <span>📅</span> Bugün
                            </div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: #00D4AA; margin-bottom: 4px;" id="todaySignals">0</div>
                            <div style="font-size: 0.7rem; color: #666; display: flex; justify-content: space-between;">
                                <span>Sinyal</span>
                                <span id="todayProfit" style="color: #00D4AA; font-weight: 600;">+0.00%</span>
                            </div>
                        </div>
                        
                        <!-- Bu Saatin Aktivitesi - Son 60 dakikanın özeti -->
                        <div style="padding: 12px; background: rgba(78,205,196,0.05); border-radius: 10px; border: 1px solid rgba(78,205,196,0.2); transition: all 0.3s ease;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 8px; text-transform: uppercase; display: flex; align-items: center; gap: 6px;">
                                <span>🕐</span> Bu Saat
                            </div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: #4ECDC4; margin-bottom: 4px;" id="hourlySignals">0</div>
                            <div style="font-size: 0.7rem; color: #666; display: flex; justify-content: space-between;">
                                <span>Sinyal</span>
                                <span id="hourlyProfit" style="color: #4ECDC4; font-weight: 600;">+0.00%</span>
                            </div>
                        </div>
                        
                        <!-- Haftalık Trend - Son 7 günün genel eğilimi -->
                        <div style="padding: 12px; background: rgba(255,193,7,0.05); border-radius: 10px; border: 1px solid rgba(255,193,7,0.2); transition: all 0.3s ease;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 8px; text-transform: uppercase; display: flex; align-items: center; gap: 6px;">
                                <span>📊</span> Bu Hafta
                            </div>
                            <div style="font-size: 1.4rem; font-weight: 700; color: #FFC107; margin-bottom: 4px;" id="weeklySignals">0</div>
                            <div style="font-size: 0.7rem; color: #666; display: flex; justify-content: space-between;">
                                <span>Sinyal</span>
                                <span id="weeklyProfit" style="color: #FFC107; font-weight: 600;">+0.00%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detaylı Sinyal Geçmişi Listesi - Her sinyalin tam detaylarını içeren scrollable tablo -->
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
                        <h4 style="color: #4ECDC4; font-size: 1rem; margin: 0; display: flex; align-items: center; gap: 8px;">
                            📋 Detaylı Sinyal Kayıtları
                        </h4>
                        <!-- Filtreleme butonları - Kullanıcının belirli sinyal türlerini görmesini sağlar -->
                        <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                            <button class="btn" onclick="filterSignals('all')" id="filterAllBtn" style="padding: 6px 12px; font-size: 0.75rem; background: rgba(78,205,196,0.8);">
                                Tümü
                            </button>
                            <button class="btn success" onclick="filterSignals('successful')" style="padding: 6px 12px; font-size: 0.75rem;">
                                ✅ Başarılı
                            </button>
                            <button class="btn danger" onclick="filterSignals('failed')" style="padding: 6px 12px; font-size: 0.75rem;">
                                ❌ Başarısız
                            </button>
                            <button class="btn warning" onclick="filterSignals('pending')" style="padding: 6px 12px; font-size: 0.75rem;">
                                ⏳ Bekleyen
                            </button>
                        </div>
                    </div>
                    
                    <!-- Ana sinyal geçmişi container - Mobil-first yaklaşımla tasarlanmış scrollable area -->
                    <div id="signalHistory" style="
                        max-height: 320px; 
                        overflow-y: auto; 
                        background: rgba(0,0,0,0.4); 
                        border-radius: 12px; 
                        padding: 15px; 
                        border: 2px solid rgba(255,255,255,0.1);
                        scrollbar-width: thin;
                        scrollbar-color: #4ECDC4 rgba(255,255,255,0.1);
                    ">
                        <!-- Varsayılan boş durum mesajı -->
                        <div id="noSignalsMessage" style="text-align: center; color: #888; margin: 40px 0;">
                            <div style="font-size: 3rem; margin-bottom: 15px; opacity: 0.6;">📊</div>
                            <div style="font-size: 1.1rem; font-weight: 500; margin-bottom: 8px;">Henüz sinyal geçmişi bulunmuyor</div>
                            <div style="font-size: 0.85rem; color: #666; max-width: 300px; margin: 0 auto; line-height: 1.4;">
                                AI sistem bağlantısı kurulduktan sonra üretilen sinyaller buraya kaydedilecek. Her sinyalin entry fiyatı, take profit, stop loss ve zaman damgası bilgileri detaylı olarak görüntülenecektir.
                            </div>
                        </div>
                        
                        <!-- Dinamik sinyal listesi - JavaScript tarafından doldurulacak -->
                        <div id="signalListContainer">
                            <!-- Bu alan JavaScript tarafından doldurulacak. -->
                        </div>
                    </div>
                </div>

                <!-- Sinyal yönetimi ve veri export işlemleri için buton grubu -->
                <div style="margin-top: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px;">
                        <!-- Geçmişi temizleme - Tüm sinyal verilerini siler -->
                        <button class="btn danger" onclick="clearHistory()" style="padding: 10px; font-size: 0.85rem;">
                            🗑️ Geçmişi Temizle
                        </button>
                        <!-- CSV export - Analiz için dış araçlara veri aktarımı -->
                        <button class="btn info" onclick="exportHistory()" style="padding: 10px; font-size: 0.85rem;">
                            📤 CSV Export
                        </button>
                        <!-- PDF rapor oluşturma - Profesyonel raporlama için -->
                        <button class="btn warning" onclick="generateReport()" style="padding: 10px; font-size: 0.85rem;">
                            📊 PDF Rapor
                        </button>
                        <!-- Gelişmiş analiz aracı - Derin istatistiksel analiz -->
                        <button class="btn info" onclick="openAdvancedAnalysis()" style="padding: 10px; font-size: 0.85rem;">
                            🔬 Gelişmiş Analiz
                        </button>
                    </div>
                </div>
            </div>


           
<!-- AI Öğrenme Sistemi ve Sistem Sağlığı Paneli - Botun beynini gösteren en kritik bileşen -->
            <div class="panel">
                <h3>🤖 AI Öğrenme Sistemi ve Performans Monitörü</h3>
                
                <!-- AI sisteminin öğrenme durumunu gerçek zamanlı olarak gösterir -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #FF6B6B; font-size: 1rem; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        🧠 Neural Network Öğrenme Durumu
                    </h4>
                    
                    <!-- AI öğrenme metrikleri - Machine learning algoritmalarının performansını takip eder -->
                    <div style="background: rgba(255,255,255,0.03); border-radius: 12px; padding: 20px; border: 1px solid rgba(255,255,255,0.1); position: relative; overflow: hidden;">
                        <!-- Arka plan animasyonu - AI'nin çalıştığını görsel olarak gösterir -->
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(45deg, transparent 30%, rgba(78,205,196,0.05) 50%, transparent 70%); animation: aiThinking 3s linear infinite;"></div>
                        
                        <!-- AI performans metrikleri grid yapısında -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; position: relative; z-index: 1;">
                            <div>
                                <div style="font-size: 0.8rem; color: #888; margin-bottom: 6px; display: flex; align-items: center; gap: 6px;">
                                    <span>📊</span> İşlenen Veri Miktarı:
                                </div>
                                <div style="font-size: 1.4rem; font-weight: 700; color: #4ECDC4;" id="aiProcessedData">0</div>
                                <div style="font-size: 0.7rem; color: #666;">Market data points</div>
                            </div>
                            <div>
                                <div style="font-size: 0.8rem; color: #888; margin-bottom: 6px; display: flex; align-items: center; gap: 6px;">
                                    <span>🎯</span> Öğrenme Doğruluğu:
                                </div>
                                <div style="font-size: 1.4rem; font-weight: 700; color: #00D4AA;" id="aiAccuracy">0%</div>
                                <div style="font-size: 0.7rem; color: #666;">Prediction accuracy</div>
                            </div>
                            <div>
                                <div style="font-size: 0.8rem; color: #888; margin-bottom: 6px; display: flex; align-items: center; gap: 6px;">
                                    <span>⚡</span> Performans Skoru:
                                </div>
                                <div style="font-size: 1.4rem; font-weight: 700; color: #FFC107;" id="aiPerformance">0/100</div>
                                <div style="font-size: 0.7rem; color: #666;">Overall AI score</div>
                            </div>
                            <div>
                                <div style="font-size: 0.8rem; color: #888; margin-bottom: 6px; display: flex; align-items: center; gap: 6px;">
                                    <span>🔄</span> Öğrenme Durumu:
                                </div>
                                <div style="font-size: 1.1rem; font-weight: 600; color: #4ECDC4;" id="aiLearningStatus">Başlangıç Modu</div>
                                <div style="font-size: 0.7rem; color: #666;" id="aiStatusDetails">Sistem hazırlanıyor...</div>
                            </div>
                        </div>
                        
                        <!-- Animated AI gelişim progress barı - Neural network'ün öğrenme ilerlemesini gösterir -->
                        <div style="margin-top: 15px; position: relative; z-index: 1;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span style="font-size: 0.8rem; color: #888;">Neural Network Eğitim İlerlemesi:</span>
                                <span style="font-size: 0.9rem; font-weight: 600; color: #4ECDC4;" id="aiProgressPercent">0%</span>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); height: 12px; border-radius: 6px; overflow: hidden; position: relative;">
                                <div id="overallAIProgress" style="background: linear-gradient(90deg, #FF6B6B 0%, #FFC107 30%, #4ECDC4 70%, #00D4AA 100%); height: 100%; width: 0%; transition: width 1s ease; position: relative;">
                                    <!-- Progress bar üzerinde akan ışık efekti -->
                                    <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); animation: progressShine 2s linear infinite;"></div>
                                </div>
                            </div>
                            <!-- Progress seviye açıklamaları -->
                            <div style="display: flex; justify-content: space-between; font-size: 0.65rem; margin-top: 6px; color: #666;">
                                <span>Başlangıç</span>
                                <span>Öğreniyor</span>
                                <span>Gelişti</span>
                                <span>Uzman</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sistem Sağlığı ve Performans Monitörü - Bot'un teknik durumunu izler -->
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #00D4AA; font-size: 1rem; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        💚 Sistem Sağlığı ve Performans
                    </h4>
                    
                    <!-- Real-time sistem durumu kartları -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px;">
                        <!-- CPU kullanımı göstergesi (simüle edilmiş) -->
                        <div style="padding: 12px; background: rgba(0,212,170,0.05); border-radius: 10px; border: 1px solid rgba(0,212,170,0.2); text-align: center;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                <span>🖥️</span> CPU Kullanımı
                            </div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #00D4AA; margin-bottom: 4px;" id="cpuUsage">0%</div>
                            <div style="background: rgba(255,255,255,0.1); height: 4px; border-radius: 2px; overflow: hidden;">
                                <div id="cpuBar" style="background: #00D4AA; height: 100%; width: 0%; transition: width 0.5s ease;"></div>
                            </div>
                        </div>
                        
                        <!-- Memory kullanımı göstergesi -->
                        <div style="padding: 12px; background: rgba(78,205,196,0.05); border-radius: 10px; border: 1px solid rgba(78,205,196,0.2); text-align: center;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                <span>🧠</span> Bellek Kullanımı
                            </div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #4ECDC4; margin-bottom: 4px;" id="memoryUsage">0%</div>
                            <div style="background: rgba(255,255,255,0.1); height: 4px; border-radius: 2px; overflow: hidden;">
                                <div id="memoryBar" style="background: #4ECDC4; height: 100%; width: 0%; transition: width 0.5s ease;"></div>
                            </div>
                        </div>
                        
                        <!-- Network latency göstergesi -->
                        <div style="padding: 12px; background: rgba(255,193,7,0.05); border-radius: 10px; border: 1px solid rgba(255,193,7,0.2); text-align: center;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                <span>📡</span> Network Ping
                            </div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #FFC107; margin-bottom: 4px;" id="networkPing">0ms</div>
                            <div style="font-size: 0.65rem; color: #666;" id="networkStatus">Bağlantı kontrol ediliyor...</div>
                        </div>
                        
                        <!-- Sistem uptime göstergesi -->
                        <div style="padding: 12px; background: rgba(255,255,255,0.05); border-radius: 10px; border: 1px solid rgba(255,255,255,0.1); text-align: center;">
                            <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                <span>⏱️</span> Çalışma Süresi
                            </div>
                            <div style="font-size: 1.3rem; font-weight: 700; color: #ffffff; margin-bottom: 4px;" id="systemUptime">00:00:00</div>
                            <div style="font-size: 0.65rem; color: #666;">Kesintisiz çalışma</div>
                        </div>
                    </div>
                </div>

                <!-- AI Model Konfigürasyonu ve İstatistikleri -->
                <div style="margin-bottom: 15px;">
                    <h4 style="color: #FFC107; font-size: 0.95rem; margin-bottom: 12px;">🔧 AI Model Detayları:</h4>
                    <div style="background: rgba(255,193,7,0.05); border-radius: 10px; padding: 15px; border: 1px solid rgba(255,193,7,0.2);">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; font-size: 0.8rem;">
                            <div>
                                <span style="color: #888;">Model Tipi:</span>
                                <span style="color: #FFC107; font-weight: 600; margin-left: 8px;" id="aiModelType">Hybrid Neural Network</span>
                            </div>
                            <div>
                                <span style="color: #888;">Öğrenme Algoritması:</span>
                                <span style="color: #FFC107; font-weight: 600; margin-left: 8px;" id="learningAlgorithm">Reinforcement Learning</span>
                            </div>
                            <div>
                                <span style="color: #888;">Son Güncelleme:</span>
                                <span style="color: #888; font-weight: 600; margin-left: 8px;" id="lastModelUpdate">-</span>
                            </div>
                            <div>
                                <span style="color: #888;">Model Versiyonu:</span>
                                <span style="color: #4ECDC4; font-weight: 600; margin-left: 8px;" id="modelVersion">v4.2.1</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Market Verileri ve Teknik Analiz Paneli - Gerçek zamanlı market datasını analiz eder -->
            <div class="panel">
                <h3>📊 Market Verileri ve Teknik Analiz</h3>
                
                <!-- Anlık market durumu - Fiyat hareketlerini ve piyasa psikolojisini gösterir -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #4ECDC4; font-size: 1rem; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        💹 Anlık Piyasa Durumu
                    </h4>
                    
                    <!-- Real-time market metrics - Kritik trading göstergeleri -->
                    <div style="background: rgba(0,0,0,0.3); border-radius: 12px; padding: 20px; border: 2px solid rgba(78,205,196,0.2);">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px;">
                            <!-- Son işlem fiyatı ve değişim -->
                            <div style="text-align: center;">
                                <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px;">Son Fiyat</div>
                                <div style="font-size: 1.4rem; font-weight: 700; color: #4ECDC4; margin-bottom: 4px;" id="marketCurrentPrice">$0.00</div>
                                <div style="font-size: 0.8rem; font-weight: 600;" id="marketPriceChange">+0.00%</div>
                            </div>
                            
                            <!-- 24 saatlik hacim bilgisi -->
                            <div style="text-align: center;">
                                <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px;">24h Volume</div>
                                <div style="font-size: 1.4rem; font-weight: 700; color: #FFC107; margin-bottom: 4px;" id="volume24h">0</div>
                                <div style="font-size: 0.8rem; color: #666;" id="volumeChange">+0.00%</div>
                            </div>
                            
                            <!-- Market volatilite göstergesi -->
                            <div style="text-align: center;">
                                <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px;">Volatilite</div>
                                <div style="font-size: 1.4rem; font-weight: 700; color: #FF6B6B; margin-bottom: 4px;" id="marketVolatility">Düşük</div>
                                <div style="font-size: 0.8rem; color: #666;" id="volatilityPercent">0.00%</div>
                            </div>
                            
                            <!-- Market sentiment göstergesi -->
                            <div style="text-align: center;">
                                <div style="font-size: 0.75rem; color: #888; margin-bottom: 6px;">Piyasa Duygusu</div>
                                <div style="font-size: 1.4rem; font-weight: 700; color: #00D4AA; margin-bottom: 4px;" id="marketSentiment">Nötr</div>
                                <div style="font-size: 0.8rem; color: #666;" id="sentimentScore">50/100</div>
                            </div>
                        </div>
                    </div>
                </div>
               
<!-- Teknik İndikatörler - Trading kararlarında kullanılan matematiksel hesaplamalar -->
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #FF6B6B; font-size: 1rem; margin-bottom: 12px;">📈 Teknik İndikatörler:</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <!-- RSI (Relative Strength Index) - Aşırı alım/satım durumunu gösterir -->
                        <div style="padding: 12px; background: rgba(255,107,107,0.1); border-radius: 8px; border: 1px solid rgba(255,107,107,0.2);">
                            <div style="font-size: 0.8rem; color: #888; margin-bottom: 6px;">RSI (14)</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #FF6B6B;" id="rsiValue">50</div>
                            <div style="font-size: 0.7rem; color: #666;" id="rsiStatus">Nötr Bölge</div>
                        </div>
                        
                        <!-- MACD - Trend değişimlerini algılar -->
                        <div style="padding: 12px; background: rgba(78,205,196,0.1); border-radius: 8px; border: 1px solid rgba(78,205,196,0.2);">
                            <div style="font-size: 0.8rem; color: #888; margin-bottom: 6px;">MACD</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #4ECDC4;" id="macdValue">0.00</div>
                            <div style="font-size: 0.7rem; color: #666;" id="macdStatus">Sinyal Yok</div>
                        </div>
                    </div>
                </div>

                <!-- OrderBook Derinlik Analizi - Alış/satış emirlerinin dağılımını gösterir -->
                <div style="margin-bottom: 15px;">
                    <h4 style="color: #00D4AA; font-size: 0.95rem; margin-bottom: 10px;">📚 OrderBook Analizi:</h4>
                    <div style="background: rgba(0,212,170,0.05); border-radius: 10px; padding: 15px; border: 1px solid rgba(0,212,170,0.2);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <!-- Alış baskısı göstergesi -->
                            <div style="flex: 1; text-align: center;">
                                <div style="font-size: 0.75rem; color: #888; margin-bottom: 4px;">Alış Baskısı</div>
                                <div style="font-size: 1.1rem; font-weight: 700; color: #00D4AA;" id="buyPressure">0%</div>
                            </div>
                            <!-- Satış baskısı göstergesi -->
                            <div style="flex: 1; text-align: center;">
                                <div style="font-size: 0.75rem; color: #888; margin-bottom: 4px;">Satış Baskısı</div>
                                <div style="font-size: 1.1rem; font-weight: 700; color: #F84960;" id="sellPressure">0%</div>
                            </div>
                        </div>
                        <!-- Görsel orderbook dengesini gösteren bar -->
                        <div style="background: rgba(248,73,96,0.3); height: 8px; border-radius: 4px; overflow: hidden;">
                            <div id="orderbookBalance" style="background: #00D4AA; height: 100%; width: 50%; transition: width 0.5s ease;"></div>
                        </div>
                        <div style="font-size: 0.7rem; color: #888; text-align: center; margin-top: 6px;" id="orderbookImbalance">Dengeli Piyasa</div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Toast Bildirim Sistemi - Kullanıcıya önemli mesajları ileten popup sistem -->
        <div id="toast" class="toast"></div>

        <!-- Loading Overlay - Sistem işlemlerini beklerken gösterilen loading ekranı -->
        <div id="loadingOverlay" style="
            position: fixed; 
            top: 0; left: 0; right: 0; bottom: 0; 
            background: rgba(0,0,0,0.8); 
            backdrop-filter: blur(5px);
            display: none; 
            justify-content: center; 
            align-items: center; 
            z-index: 10000;
        ">
            <div style="text-align: center; color: #ffffff;">
                <div style="width: 60px; height: 60px; border: 4px solid rgba(78,205,196,0.3); border-top: 4px solid #4ECDC4; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
                <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;">Sistem İşlemi</div>
                <div style="font-size: 0.9rem; color: #888;" id="loadingMessage">İşlem yapılıyor...</div>
            </div>
        </div>
    </div>

    <!-- CSS Animasyonları - UI deneyimini zenginleştiren görsel efektler -->
    <style>
        /* AI düşünme animasyonu - AI'nin aktif olduğunu gösteren sürükleyici efekt */
        @keyframes aiThinking {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(300%); }
        }

        /* Progress bar üzerinde akan ışık efekti - İlerlemeyi vurgulayan animasyon */
        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(400%); }
        }

        /* Shimmer efekti - Güven çubuğunda kalite hissi veren animasyon */
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Loading spinner animasyonu - Bekleyen işlemleri gösteren dönen çember */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Pulse animasyonu - Bağlantı durumunu vurgulayan nabız efekti */
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }

        /* Toast bildirim sistemi stilleri */
        .toast {
            position: fixed;
            top: 100px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            color: #ffffff;
            padding: 15px 20px;
            border-radius: 12px;
            border-left: 4px solid #4ECDC4;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 9999;
            max-width: 350px;
            font-size: 14px;
            font-weight: 500;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left-color: #00D4AA;
            background: rgba(0,212,170,0.1);
        }

        .toast.error {
            border-left-color: #F84960;
            background: rgba(248,73,96,0.1);
        }

        .toast.warning {
            border-left-color: #FFC107;
            background: rgba(255,193,7,0.1);
        }

        .toast.info {
            border-left-color: #4ECDC4;
            background: rgba(78,205,196,0.1);
        }

        /* Hover efektleri - Kullanıcı etkileşimini artıran interaktif animasyonlar */
        .panel:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 28px rgba(0,0,0,0.4);
            border-color: rgba(78, 205, 196, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        /* Sticky header için smooth scroll behavior */
        html {
            scroll-behavior: smooth;
        }

        /* Custom scrollbar tasarımı - Modern görünüm için */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #4ECDC4, #00D4AA);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #00D4AA, #4ECDC4);
        }

        /* Light theme için özel düzenlemeler */
        .light-theme ::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.1);
        }
        
        .light-theme ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #2c3e50, #34495e);
        }

        /* WebSocket Trading Specific Styles */
        .trading-status-active {
            background: rgba(0,212,170,0.2) !important;
            border-color: rgba(0,212,170,0.5) !important;
            animation: pulse 2s infinite;
        }

        .position-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            border: 2px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }

        .position-card.long {
            border-color: rgba(0,212,170,0.3);
            background: rgba(0,212,170,0.05);
        }

        .position-card.short {
            border-color: rgba(248,73,96,0.3);
            background: rgba(248,73,96,0.05);
        }

        .signal-notification {
            animation: pulse 1s infinite;
            border: 2px solid #FFC107 !important;
            background: rgba(255,193,7,0.1) !important;
        }

        /* Balance tracking styles */
        .balance-positive {
            color: #00D4AA !important;
        }

        .balance-negative {
            color: #F84960 !important;
        }

        .balance-neutral {
            color: #888 !important;
        }

        /* Order status indicators */
        .order-pending {
            color: #FFC107;
        }

        .order-filled {
            color: #00D4AA;
        }

        .order-cancelled {
            color: #F84960;
        }

        .order-partial {
            color: #4ECDC4;
        }

        /* Mobile optimizations for trading */
        @media (max-width: 768px) {
            .toast {
                right: 10px;
                left: 10px;
                max-width: none;
                transform: translateY(-100px);
            }

            .toast.show {
                transform: translateY(0);
            }

            .position-card {
                padding: 12px;
            }
        }
    </style>

    <!-- JavaScript Başlangıcı - Botun fonksiyonel beyni burada başlar -->
    <script>
        // === GLOBAL DEĞİŞKENLER === 
        // Bu bölüm botun tüm bileşenlerinin kullandığı temel veri yapılarını tanımlar
        
        // WebSocket bağlantısı ve durum yönetimi
        let ws = null;                      // Ana WebSocket connection objesi (Market Data)
        let tradingWs = null;               // Trading WebSocket connection objesi (Orders, Positions, Balance)
        let isConnected = false;            // Market data bağlantı durumu flag'i
        let isTradingConnected = false;     // Trading bağlantı durumu flag'i
        let currentSymbol = '';             // Aktif olarak analiz edilen coin sembolü
        let lastPrice = 0;                  // En son alınan fiyat verisi
        let reconnectAttempts = 0;          // Otomatik yeniden bağlanma sayacı
        let maxReconnectAttempts = 5;       // Maksimum yeniden bağlanma denemesi
        let pingInterval = null;            // WebSocket ping/pong timer'ı
        let tradingPingInterval = null;     // Trading WebSocket ping timer'ı
        let debugAutoScroll = true;         // Debug console otomatik scroll durumu
        let systemStartTime = Date.now();   // Sistem başlangıç zamanı (uptime hesabı için)

        // Trading sistemi değişkenleri
        let tradingEnabled = false;         // Otomatik trading açık/kapalı durumu
        let activePosition = null;          // Şu anda açık olan pozisyon bilgisi
        let activeSignal = null;            // Aktif sinyal objesi (entry, TP, SL bilgileri ile)
        let dailyPnL = 0;                   // Günlük kar/zarar toplamı
        let maxDailyLoss = 100;             // Günlük maksimum zarar limiti
        let positionSize = 50;              // Default pozisyon büyüklüğü (USDT)
        let lastSignalTime = 0;             // Son sinyal zamanı (cooldown için)

        // WebSocket Trading specific variables
        let currentBalance = {              // Mevcut bakiye bilgileri
            total: 0,                       // Toplam bakiye (USDT)
            available: 0,                   // Kullanılabilir bakiye
            frozen: 0,                      // Donmuş bakiye (açık pozisyonlarda)
            unrealizedPnL: 0               // Gerçekleşmemiş kar/zarar
        };

        let openOrders = [];                // Açık emirler listesi
        let orderHistory = [];              // Emir geçmişi
        let positionHistory = [];           // Pozisyon geçmişi
        let balanceHistory = [];            // Bakiye değişim geçmişi

        // API credentials - MEXC trading API'si için gerekli kimlik bilgileri
        let apiCredentials = {
            key: '',                        // API anahtarı
            secret: ''                      // API secret key
        };

        // Trading performans istatistikleri
        let tradingStats = {
            totalTrades: 0,                 // Toplam yapılan işlem sayısı
            winTrades: 0,                   // Kazançlı işlem sayısı
            lossTrades: 0,                  // Zararlı işlem sayısı
            totalProfit: 0,                 // Toplam kar/zarar (USDT)
            dailyTrades: 0,                 // Günlük işlem sayısı
            bestTrade: 0,                   // En yüksek kar (%)
            worstTrade: 0,                  // En yüksek zarar (%)
            avgTradeTime: 0                 // Ortalama işlem süresi (saniye)
        };

        // Market verisi ve analiz için gerekli diziler
        let priceHistory = [];              // Fiyat geçmişi dizisi (teknik analiz için)
        let volumeHistory = [];             // Hacim geçmişi dizisi
        let orderBookData = {               // OrderBook verisi
            bids: [],                       // Alış emirleri [fiyat, miktar]
            asks: []                        // Satış emirleri [fiyat, miktar]
        };
        let signalHistory = [];             // Tüm sinyal geçmişi (analiz için)

        // Bot konfigürasyon parametreleri - Kullanıcının ayarlayabileceği değerler
        let botSettings = {
            volumeThreshold: 2.0,           // Volume spike algılama eşiği (2x = %100 artış)
            takeProfitPercent: 0.8,         // Take profit yüzdesi (0.8 = %0.8)
            stopLossPercent: 0.5,           // Stop loss yüzdesi (0.5 = %0.5)
            minConfidence: 70,              // Minimum sinyal güven seviyesi (70 = %70)
            signalCooldown: 30000,          // Sinyaller arası minimum bekleme süresi (30 saniye)
            learningSpeed: 'medium',        // AI öğrenme hızı (slow/medium/fast)
            autoOptimization: true,         // Otomatik parametre optimizasyonu
            adaptiveThresholds: true,       // Performansa göre eşik ayarlama
            riskManagement: true            // Gelişmiş risk yönetimi
        };
       
        // === PROJECT HYPERION AI GLOBAL DEĞİŞKENLERİ ===
        let aiSupervisor = null;
        let aiOrderbook = null;
        let aiVolume = null;
        let aiSentiment = null;
        let antiManipulationMatrix = null;
        let signalGenerator = null;

        // AI öğrenme sistemi - Botun akıllı davranmasını sağlayan core algoritma
        let aiLearningData = {
            totalProcessed: 0,              // AI'nin işlediği toplam veri sayısı
            learningProgress: 0,            // Öğrenme ilerlemesi (0-100 arası)
            performanceScore: 0,            // Genel AI performans skoru
            accuracy: 0,                    // Tahmin doğruluğu yüzdesi
            strategies: {                   // Her strateji için ayrı öğrenme verileri
                whale: { total: 0, success: 0, profits: [], times: [], reliability: 0 },
                imbalance: { total: 0, success: 0, profits: [], times: [], reliability: 0 },
                volume: { total: 0, success: 0, profits: [], times: [], reliability: 0 },
                sr: { total: 0, success: 0, profits: [], times: [], reliability: 0 }
            },
            lastModelUpdate: null           // AI modelinin son güncellenme zamanı
        };

        // === TEMEL YARDIMCI FONKSİYONLAR ===
        // Bu fonksiyonlar botun temel işleyişini sağlayan araçlardır

        /**
         * DOM elementlerini güvenli şekilde günceller
         */
        function safeUpdateElement(elementId, value, property = 'textContent') {
            const element = document.getElementById(elementId);
            if (element) {
                element[property] = value;
                return true;
            }
            return false;
        }

        /**
         * Coin sembolünü doğrular ve MEXC formatına çevirir
         */
        function validateSymbol(symbol) {
            const coin = symbol.trim().toUpperCase();
            if (/^[A-Z]{2,10}$/.test(coin)) {
                return { 
                    valid: true, 
                    coin: coin + '_USDT',
                    message: `🔍 ${coin}_USDT analizi başlatılıyor...` 
                };
            }
            return { 
                valid: false, 
                coin: null, 
                message: `❌ Geçersiz format. Örnek: BTC, ETH, PEPE` 
            };
        }

        /**
         * Fiyatları kullanıcı dostu formatta gösterir
         */
        function formatPrice(price) {
            if (price === 0 || !price) return '$0.00000000';
            if (price >= 1) return `$${price.toFixed(4)}`;
            if (price >= 0.01) return `$${price.toFixed(6)}`;
            return `$${price.toFixed(8)}`;
        }

        /**
         * USDT değerlerini formatlar
         */
        function formatUSDT(amount) {
            if (Math.abs(amount) >= 1000) {
                return `${(amount / 1000).toFixed(2)}K USDT`;
            }
            return `${amount.toFixed(2)} USDT`;
        }

        /**
         * Zaman formatını kullanıcı dostu hale getirir
         */
        function formatTime(seconds) {
            if (seconds < 60) return `${seconds}s`;
            if (seconds < 3600) return `${Math.floor(seconds / 60)}m ${seconds % 60}s`;
            return `${Math.floor(seconds / 3600)}h ${Math.floor((seconds % 3600) / 60)}m`;
        }

        /**
         * Toast bildirim sistemi
         */
        function showToast(message, type = 'info', duration = 3000) {
            const toast = document.getElementById('toast');
            if (!toast) return;
            
            toast.textContent = message;
            toast.className = `toast show ${type}`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
            
            addToMobileDebug(`Toast: ${message}`, type);
        }

        /**
         * Debug log sistemi
         */
        function debugLog(message, type = 'info') {
            console.log(`[${type.toUpperCase()}] ${message}`);
            addToMobileDebug(message, type);
        }

        /**
         * Mobil debug console'a log ekler
         */
        function addToMobileDebug(message, type = 'info') {
            const consoleEl = document.getElementById('mobileDebugConsole');
            if (!consoleEl) return;
            
            const colors = {
                info: '#4ECDC4', success: '#00D4AA', warning: '#FFC107',
                error: '#F84960', api: '#FF6B6B', trade: '#764ba2', ai: '#FF6B6B'
            };
            
            const timestamp = new Date().toLocaleTimeString('tr-TR');
            const logEntry = document.createElement('div');
            logEntry.style.color = colors[type] || colors.info;
            logEntry.style.marginBottom = '3px';
            logEntry.style.borderLeft = `3px solid ${colors[type] || colors.info}`;
            logEntry.style.paddingLeft = '8px';
            logEntry.style.fontSize = '11px';
            logEntry.style.lineHeight = '1.4';
            logEntry.innerHTML = `<span style="color: #888;">[${timestamp}]</span> ${message}`;
            
            consoleEl.insertBefore(logEntry, consoleEl.firstChild);
            
            if (debugAutoScroll) {
                consoleEl.scrollTop = 0;
            }
            
            if (consoleEl.children.length > 200) {
                consoleEl.removeChild(consoleEl.lastChild);
            }
        }

        function clearDebugConsole() {
            const consoleEl = document.getElementById('mobileDebugConsole');
            if (consoleEl) {
                consoleEl.innerHTML = '';
                debugLog('Debug console temizlendi.', 'info');
            }
        }

        function toggleDebugAutoScroll() {
            debugAutoScroll = !debugAutoScroll;
            const btn = document.getElementById('autoScrollBtn');
            if (btn) {
                btn.textContent = `📜 Auto Scroll: ${debugAutoScroll ? 'ON' : 'OFF'}`;
            }
            debugLog(`Auto scroll ${debugAutoScroll ? 'açıldı' : 'kapatıldı'}`, 'info');
        }

        /**
         * Sistem uptime hesaplayıcısı
         */
        function updateSystemUptime() {
            const uptimeSeconds = Math.floor((Date.now() - systemStartTime) / 1000);
            const hours = String(Math.floor(uptimeSeconds / 3600)).padStart(2, '0');
            const minutes = String(Math.floor((uptimeSeconds % 3600) / 60)).padStart(2, '0');
            const seconds = String(uptimeSeconds % 60).padStart(2, '0');
            safeUpdateElement('systemUptime', `${hours}:${minutes}:${seconds}`);
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showLoading(message = 'İşlem yapılıyor...') {
            safeUpdateElement('loadingMessage', message);
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) overlay.style.display = 'flex';
        }

        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) overlay.style.display = 'none';
        }


       
        // === API CREDENTIALS YÖNETİMİ ===
        function saveApiCredentials() {
            debugLog('💾 API credentials kaydediliyor...', 'api');
            const key = document.getElementById('apiKey').value.trim();
            const secret = document.getElementById('apiSecret').value.trim();
            
            if (!key || !secret) {
                showToast('⚠️ API Key ve Secret alanlarını doldurun', 'warning');
                return;
            }
            
            apiCredentials.key = key;
            apiCredentials.secret = secret;
            
            debugLog(`✅ API credentials bellekte kaydedildi.`, 'success');
            showToast('💾 API credentials kaydedildi', 'success');
            
            // Trading WebSocket bağlantısını başlat
            if (isConnected && !isTradingConnected) {
                connectTradingWebSocket();
            }
        }

        function loadApiCredentials() {
            // Bu örnekte güvenlik nedeniyle localStorage kullanılmamaktadır.
            // Sayfa yenilendiğinde tekrar girilmesi gerekir.
            // Gerçek bir uygulamada daha güvenli bir depolama yöntemi gerekir.
        }

        function createSignature(params, secret) {
            if (typeof CryptoJS === 'undefined') {
                debugLog('❌ CryptoJS kütüphanesi yüklenmedi!', 'error');
                return '';
            }
            const queryString = Object.keys(params).sort().map(key => `${key}=${params[key]}`).join('&');
            return CryptoJS.HmacSHA256(queryString, secret).toString();
        }

        async function testApiCredentials() {
            if (!apiCredentials.key || !apiCredentials.secret) {
                showToast('❌ Önce API credentials girin', 'error');
                return;
            }
            debugLog('🧪 API credentials test ediliyor...', 'api');
            showLoading('API credentials test ediliyor...');
            
            // Bu kısım normalde bir API isteği gönderir.
            // Tarayıcı ortamında CORS sorunları nedeniyle simüle edilmiştir.
            setTimeout(() => {
                hideLoading();
                showToast('✅ API bağlantısı başarılı (Simülasyon)', 'success');
                debugLog('✅ API test başarılı (Simülasyon)', 'success');
                
                // Test başarılıysa trading WebSocket'i başlat
                if (isConnected && !isTradingConnected) {
                    connectTradingWebSocket();
                }
            }, 1500);
        }

        // === WEBSOCKET BAĞLANTI SİSTEMİ ===
        function connect() {
            const coinInput = document.getElementById('manualSymbol').value.trim();
            const validation = validateSymbol(coinInput);
            if (!validation.valid) {
                showToast(validation.message, 'error');
                return;
            }

            currentSymbol = validation.coin;
            debugLog(`🔗 ${currentSymbol} için MEXC bağlantısı başlatılıyor...`, 'info');
            
            // UI güncellemeleri
            updateConnectionUI('connecting');
            
            const wsUrl = 'wss://futures.mexc.com/edge';
            ws = new WebSocket(wsUrl);
            
            ws.onopen = () => {
                isConnected = true;
                reconnectAttempts = 0;
                updateConnectionUI('connected');
                debugLog('✅ MEXC WebSocket bağlantısı kuruldu', 'success');
                showToast(`✅ ${currentSymbol} için bağlantı başarılı`, 'success');
                subscribeToPair(currentSymbol);
                startPingSystem();
                
                // API credentials varsa trading WebSocket'i de başlat
                if (apiCredentials.key && apiCredentials.secret) {
                    connectTradingWebSocket();
                }
            };

            ws.onmessage = (event) => {
                try {
                    const data = JSON.parse(event.data);
                    handleMarketData(data);
                } catch (error) {
                    debugLog(`❌ Market verisi işleme hatası: ${error.message}`, 'error');
                }
            };

            ws.onclose = (event) => {
                isConnected = false;
                updateConnectionUI('disconnected');
                debugLog(`⚠️ WebSocket bağlantısı kapandı (Kod: ${event.code})`, 'warning');
                stopPingSystem();
                attemptReconnection();
            };

            ws.onerror = (error) => {
                debugLog(`❌ WebSocket bağlantı hatası`, 'error');
                showToast('❌ Bağlantı hatası oluştu', 'error');
                updateConnectionUI('disconnected');
            };
        }

        function disconnect() {
            if (ws) {
                ws.close(1000, 'Kullanıcı tarafından kapatıldı');
            }
            if (tradingWs) {
                tradingWs.close(1000, 'Kullanıcı tarafından kapatıldı');
            }
            ws = null;
            tradingWs = null;
            isConnected = false;
            isTradingConnected = false;
            stopPingSystem();
            stopTradingPingSystem();
            updateConnectionUI('disconnected');
            updateTradingConnectionUI('disconnected');
            debugLog('🔴 WebSocket bağlantıları kapatıldı', 'info');
            reconnectAttempts = 0;
        }

        function toggleConnection() {
            if (isConnected) {
                disconnect();
            } else {
                connect();
            }
        }

        function subscribeToPair(symbol) {
            if (!ws || ws.readyState !== WebSocket.OPEN) return;
            const subscriptions = [
                { method: 'sub.deal', param: { symbol } },
                { method: 'sub.depth', param: { symbol, depth: 20 } },
                { method: 'sub.ticker', param: { symbol } }
            ];
            subscriptions.forEach(sub => ws.send(JSON.stringify(sub)));
            debugLog(`📡 ${symbol} için veri kanallarına abone olundu`, 'info');
        }

        function startPingSystem() {
            stopPingSystem();
            pingInterval = setInterval(() => {
                if (ws && ws.readyState === WebSocket.OPEN) {
                    ws.send(JSON.stringify({ method: 'ping' }));
                }
            }, 30000);
        }

        function stopPingSystem() {
            if (pingInterval) {
                clearInterval(pingInterval);
                pingInterval = null;
            }
        }

        function attemptReconnection() {
            if (reconnectAttempts >= maxReconnectAttempts) {
                debugLog(`❌ Maksimum yeniden bağlanma denemesi aşıldı.`, 'error');
                return;
            }
            reconnectAttempts++;
            const delay = Math.min(5 * reconnectAttempts, 30) * 1000;
            debugLog(`🔄 ${delay / 1000}s sonra yeniden bağlanma denenecek... (${reconnectAttempts}/${maxReconnectAttempts})`, 'warning');
            setTimeout(() => {
                if (!isConnected) connect();
            }, delay);
        }

        function updateConnectionUI(status) {
            const connectBtn = document.getElementById('connectBtn');
            const wsStatus = document.getElementById('wsStatus');
            const stickyConnection = document.getElementById('stickyConnection');
            
            if (status === 'connecting') {
                connectBtn.textContent = '⏳ Bağlanılıyor...';
                connectBtn.disabled = true;
                wsStatus.textContent = '⏳ Bağlanılıyor...';
                wsStatus.style.color = '#FFC107';
            } else if (status === 'connected') {
                connectBtn.textContent = '🔌 Bağlantıyı Kes';
                connectBtn.className = 'btn danger';
                connectBtn.disabled = false;
                wsStatus.textContent = '✅ Bağlı';
                wsStatus.style.color = '#00D4AA';
                stickyConnection.className = 'quick-status status-connected';
                stickyConnection.innerHTML = '✅ Bağlı';
            } else { // disconnected
                connectBtn.textContent = '🔌 WebSocket Bağlantısını Başlat';
                connectBtn.className = 'btn success';
                connectBtn.disabled = false;
                wsStatus.textContent = '🔴 Kapalı';
                wsStatus.style.color = '#F84960';
                stickyConnection.className = 'quick-status status-disconnected';
                stickyConnection.innerHTML = '🔴 Bağlantısız';
            }
        }

        // === WEBSOCKET TRADING SİSTEMİ ===
        function connectTradingWebSocket() {
            if (!apiCredentials.key || !apiCredentials.secret) {
                debugLog('❌ Trading WebSocket için API credentials gerekli', 'error');
                return;
            }

            debugLog('🔗 Trading WebSocket bağlantısı başlatılıyor...', 'trade');
            updateTradingConnectionUI('connecting');

            // MEXC Trading WebSocket URL (simülasyon için aynı URL kullanılıyor)
            const tradingWsUrl = 'wss://futures.mexc.com/edge';
            tradingWs = new WebSocket(tradingWsUrl);

            tradingWs.onopen = () => {
                isTradingConnected = true;
                updateTradingConnectionUI('connected');
                debugLog('✅ Trading WebSocket bağlantısı kuruldu', 'success');
                showToast('✅ Trading WebSocket bağlandı', 'success');
                subscribeToTradingChannels();
                startTradingPingSystem();
                
                // İlk bakiye sorgusunu yap
                requestAccountBalance();
            };

            tradingWs.onmessage = (event) => {
                try {
                    const data = JSON.parse(event.data);
                    handleTradingData(data);
                } catch (error) {
                    debugLog(`❌ Trading verisi işleme hatası: ${error.message}`, 'error');
                }
            };

            tradingWs.onclose = (event) => {
                isTradingConnected = false;
                updateTradingConnectionUI('disconnected');
                debugLog(`⚠️ Trading WebSocket bağlantısı kapandı (Kod: ${event.code})`, 'warning');
                stopTradingPingSystem();
            };

            tradingWs.onerror = (error) => {
                debugLog(`❌ Trading WebSocket bağlantı hatası`, 'error');
                updateTradingConnectionUI('disconnected');
            };
        }

        function subscribeToTradingChannels() {
            if (!tradingWs || tradingWs.readyState !== WebSocket.OPEN) return;
            
            const subscriptions = [
                { method: 'sub.orders', param: {} },        // Emir güncellemeleri
                { method: 'sub.positions', param: {} },     // Pozisyon güncellemeleri
                { method: 'sub.balance', param: {} }        // Bakiye güncellemeleri
            ];
            
            subscriptions.forEach(sub => {
                tradingWs.send(JSON.stringify(sub));
                debugLog(`📡 Trading kanalına abone olundu: ${sub.method}`, 'trade');
            });
        }

        function startTradingPingSystem() {
            stopTradingPingSystem();
            tradingPingInterval = setInterval(() => {
                if (tradingWs && tradingWs.readyState === WebSocket.OPEN) {
                    tradingWs.send(JSON.stringify({ method: 'ping' }));
                }
            }, 30000);
        }

        function stopTradingPingSystem() {
            if (tradingPingInterval) {
                clearInterval(tradingPingInterval);
                tradingPingInterval = null;
            }
        }

        function updateTradingConnectionUI(status) {
            const tradingWsStatus = document.getElementById('tradingWsStatus');
            
            if (status === 'connecting') {
                tradingWsStatus.textContent = '⏳ Bağlanılıyor...';
                tradingWsStatus.style.color = '#FFC107';
            } else if (status === 'connected') {
                tradingWsStatus.textContent = '✅ Bağlı';
                tradingWsStatus.style.color = '#00D4AA';
            } else { // disconnected
                tradingWsStatus.textContent = '🔴 Kapalı';
                tradingWsStatus.style.color = '#F84960';
            }
        }

        // === MARKET DATA İŞLEME SİSTEMİ ===
        function handleMarketData(data) {
            if (data.method === 'pong') {
                debugLog('📶 Pong alındı', 'info');
                return;
            }
            if (!data.channel || !data.data) return;

            switch (data.channel) {
                case 'push.deal':
                    handleTradeData(data.data);
                    break;
                case 'push.depth':
                    handleOrderBookData(data.data);
                    break;
                case 'push.ticker':
                    handleTickerData(data.data);
                    break;
            }
            triggerAIAnalysis();
        }

        function handleTradeData(tradeData) {
            const price = parseFloat(tradeData.p);
            if (isNaN(price) || price <= 0) return;

            const changePercent = lastPrice > 0 ? ((price - lastPrice) / lastPrice) * 100 : 0;
            lastPrice = price;
            priceHistory.push(price);
            if (priceHistory.length > 200) priceHistory.shift();

            updatePriceDisplay(price, changePercent);
            
            // Aktif pozisyon varsa PnL güncelle
            if (activePosition) {
                updatePositionPnL(price);
            }
        }

        function handleOrderBookData(orderBookData) {
            if (orderBookData.bids && orderBookData.asks) {
                orderBookData.bids = orderBookData.bids.map(bid => [parseFloat(bid[0]), parseFloat(bid[1])]);
                orderBookData.asks = orderBookData.asks.map(ask => [parseFloat(ask[0]), parseFloat(ask[1])]);
                
                // Order book analizi
                analyzeOrderBookImbalance(orderBookData);
            }
        }

        function handleTickerData(tickerData) {
            safeUpdateElement('volume24h', parseFloat(tickerData.volume).toFixed(2));
            volumeHistory.push(parseFloat(tickerData.volume));
            if (volumeHistory.length > 100) volumeHistory.shift();
        }

        function updatePriceDisplay(price, change) {
            const formattedPrice = formatPrice(price);
            safeUpdateElement('stickyPrice', formattedPrice);
            safeUpdateElement('mainHeaderPrice', formattedPrice);
            safeUpdateElement('marketCurrentPrice', formattedPrice);

            const changeEl = document.getElementById('stickyChange');
            const mainChangeEl = document.getElementById('mainHeaderChange');
            const marketChangeEl = document.getElementById('marketPriceChange');
            
            if (change >= 0) {
                changeEl.className = 'price-change positive';
                mainChangeEl.style.color = '#00D4AA';
                marketChangeEl.style.color = '#00D4AA';
                changeEl.innerHTML = `<span>📈</span><span>+${change.toFixed(3)}%</span>`;
            } else {
                changeEl.className = 'price-change negative';
                mainChangeEl.style.color = '#F84960';
                marketChangeEl.style.color = '#F84960';
                changeEl.innerHTML = `<span>📉</span><span>${change.toFixed(3)}%</span>`;
            }
            
            mainChangeEl.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(3)}%`;
            marketChangeEl.textContent = `${change >= 0 ? '+' : ''}${change.toFixed(3)}%`;
            safeUpdateElement('lastUpdateTime', `Son güncelleme: ${new Date().toLocaleTimeString()}`);
        }

        // === TRADING DATA İŞLEME SİSTEMİ ===
        function handleTradingData(data) {
            if (data.method === 'pong') {
                debugLog('📶 Trading Pong alındı', 'trade');
                return;
            }

            switch (data.channel) {
                case 'push.orders':
                    handleOrderUpdate(data.data);
                    break;
                case 'push.positions':
                    handlePositionUpdate(data.data);
                    break;
                case 'push.balance':
                    handleBalanceUpdate(data.data);
                    break;
            }
        }

        function handleOrderUpdate(orderData) {
            debugLog(`📋 Emir güncellendi: ${orderData.orderId} - ${orderData.status}`, 'trade');
            
            // Emir listesini güncelle
            const existingOrderIndex = openOrders.findIndex(order => order.orderId === orderData.orderId);
            
            if (orderData.status === 'FILLED' || orderData.status === 'CANCELLED') {
                // Tamamlanan veya iptal edilen emirleri açık emirler listesinden çıkar
                if (existingOrderIndex !== -1) {
                    openOrders.splice(existingOrderIndex, 1);
                }
                // Geçmişe ekle
                orderHistory.unshift(orderData);
                if (orderHistory.length > 100) orderHistory.pop();
            } else {
                // Açık emirleri güncelle
                if (existingOrderIndex !== -1) {
                    openOrders[existingOrderIndex] = orderData;
                } else {
                    openOrders.push(orderData);
                }
            }
            
            updateOrdersDisplay();
            showToast(`📋 Emir ${orderData.status}: ${orderData.symbol}`, 'info');
        }

        function handlePositionUpdate(positionData) {
            debugLog(`📊 Pozisyon güncellendi: ${positionData.symbol} - ${positionData.side}`, 'trade');
            
            if (positionData.size > 0) {
                activePosition = positionData;
                updateActivePositionDisplay();
            } else {
                // Pozisyon kapandı
                if (activePosition) {
                    positionHistory.unshift(activePosition);
                    if (positionHistory.length > 50) positionHistory.pop();
                }
                activePosition = null;
                updateActivePositionDisplay();
            }
            
            showToast(`📊 Pozisyon güncellendi: ${positionData.symbol}`, 'info');
        }

        function handleBalanceUpdate(balanceData) {
            debugLog(`💰 Bakiye güncellendi: ${balanceData.total} USDT`, 'trade');
            
            const oldBalance = currentBalance.total;
            currentBalance = balanceData;
            
            // Bakiye değişimini kaydet
            balanceHistory.unshift({
                timestamp: Date.now(),
                balance: balanceData.total,
                change: balanceData.total - oldBalance
            });
            if (balanceHistory.length > 100) balanceHistory.pop();
            
            updateBalanceDisplay();
            
            // Günlük PnL hesapla
            const todayStart = new Date();
            todayStart.setHours(0, 0, 0, 0);
            const todayBalanceHistory = balanceHistory.filter(b => b.timestamp >= todayStart.getTime());
            if (todayBalanceHistory.length > 0) {
                const startBalance = todayBalanceHistory[todayBalanceHistory.length - 1].balance;
                dailyPnL = balanceData.total - startBalance;
                safeUpdateElement('dailyPnLDisplay', formatUSDT(dailyPnL));
            }
        }


        // === WEBSOCKET TRADING FONKSİYONLARI ===
        
        /**
         * WebSocket üzerinden BUY emri gönderir
         */
        async function executeWebSocketBuy(symbol, quantity, price = null, orderType = 'MARKET') {
            if (!isTradingConnected || !tradingWs) {
                debugLog('❌ Trading WebSocket bağlantısı yok', 'error');
                showToast('❌ Trading bağlantısı gerekli', 'error');
                return null;
            }

            const orderId = generateOrderId();
            const timestamp = Date.now();
            
            const orderData = {
                method: 'order.place',
                params: {
                    orderId: orderId,
                    symbol: symbol,
                    side: 'BUY',
                    type: orderType,
                    quantity: quantity,
                    price: price,
                    timestamp: timestamp
                }
            };

            // API imzası oluştur
            if (apiCredentials.secret) {
                orderData.params.signature = createSignature(orderData.params, apiCredentials.secret);
            }

            try {
                debugLog(`📈 BUY emri gönderiliyor: ${quantity} ${symbol} @ ${price || 'MARKET'}`, 'trade');
                tradingWs.send(JSON.stringify(orderData));
                
                showToast(`📈 BUY emri gönderildi: ${quantity} ${symbol}`, 'success');
                
                // Simülasyon için emir durumunu güncelle
                setTimeout(() => {
                    const simulatedOrder = {
                        orderId: orderId,
                        symbol: symbol,
                        side: 'BUY',
                        type: orderType,
                        quantity: quantity,
                        price: price || lastPrice,
                        status: 'FILLED',
                        timestamp: timestamp
                    };
                    handleOrderUpdate(simulatedOrder);
                }, 1000);
                
                return orderId;
            } catch (error) {
                debugLog(`❌ BUY emri hatası: ${error.message}`, 'error');
                showToast('❌ BUY emri gönderilemedi', 'error');
                return null;
            }
        }

        /**
         * WebSocket üzerinden SELL emri gönderir
         */
        async function executeWebSocketSell(symbol, quantity, price = null, orderType = 'MARKET') {
            if (!isTradingConnected || !tradingWs) {
                debugLog('❌ Trading WebSocket bağlantısı yok', 'error');
                showToast('❌ Trading bağlantısı gerekli', 'error');
                return null;
            }

            const orderId = generateOrderId();
            const timestamp = Date.now();
            
            const orderData = {
                method: 'order.place',
                params: {
                    orderId: orderId,
                    symbol: symbol,
                    side: 'SELL',
                    type: orderType,
                    quantity: quantity,
                    price: price,
                    timestamp: timestamp
                }
            };

            // API imzası oluştur
            if (apiCredentials.secret) {
                orderData.params.signature = createSignature(orderData.params, apiCredentials.secret);
            }

            try {
                debugLog(`📉 SELL emri gönderiliyor: ${quantity} ${symbol} @ ${price || 'MARKET'}`, 'trade');
                tradingWs.send(JSON.stringify(orderData));
                
                showToast(`📉 SELL emri gönderildi: ${quantity} ${symbol}`, 'success');
                
                // Simülasyon için emir durumunu güncelle
                setTimeout(() => {
                    const simulatedOrder = {
                        orderId: orderId,
                        symbol: symbol,
                        side: 'SELL',
                        type: orderType,
                        quantity: quantity,
                        price: price || lastPrice,
                        status: 'FILLED',
                        timestamp: timestamp
                    };
                    handleOrderUpdate(simulatedOrder);
                }, 1000);
                
                return orderId;
            } catch (error) {
                debugLog(`❌ SELL emri hatası: ${error.message}`, 'error');
                showToast('❌ SELL emri gönderilemedi', 'error');
                return null;
            }
        }

        /**
         * WebSocket üzerinden emir iptal eder
         */
        async function cancelWebSocketOrder(orderId) {
            if (!isTradingConnected || !tradingWs) {
                debugLog('❌ Trading WebSocket bağlantısı yok', 'error');
                return false;
            }

            const cancelData = {
                method: 'order.cancel',
                params: {
                    orderId: orderId,
                    timestamp: Date.now()
                }
            };

            try {
                debugLog(`❌ Emir iptal ediliyor: ${orderId}`, 'trade');
                tradingWs.send(JSON.stringify(cancelData));
                showToast(`❌ Emir iptal edildi: ${orderId}`, 'warning');
                return true;
            } catch (error) {
                debugLog(`❌ Emir iptal hatası: ${error.message}`, 'error');
                return false;
            }
        }

        /**
         * Hesap bakiyesini sorgular
         */
        function requestAccountBalance() {
            if (!isTradingConnected || !tradingWs) return;

            const balanceRequest = {
                method: 'account.balance',
                params: {
                    timestamp: Date.now()
                }
            };

            tradingWs.send(JSON.stringify(balanceRequest));
            debugLog('💰 Hesap bakiyesi sorgulanıyor...', 'trade');
        }

        /**
         * Açık pozisyonları sorgular
         */
        function requestOpenPositions() {
            if (!isTradingConnected || !tradingWs) return;

            const positionsRequest = {
                method: 'positions.query',
                params: {
                    timestamp: Date.now()
                }
            };

            tradingWs.send(JSON.stringify(positionsRequest));
            debugLog('📊 Açık pozisyonlar sorgulanıyor...', 'trade');
        }

        /**
         * Benzersiz emir ID'si oluşturur
         */
        function generateOrderId() {
            return `3C3_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        }

        // === POZİSYON YÖNETİMİ ===
        
        /**
         * Aktif pozisyonun PnL'ini günceller
         */
        function updatePositionPnL(currentPrice) {
            if (!activePosition) return;

            const entryPrice = parseFloat(activePosition.entryPrice);
            const size = parseFloat(activePosition.size);
            const side = activePosition.side;

            let pnl = 0;
            if (side === 'LONG') {
                pnl = (currentPrice - entryPrice) * size;
            } else if (side === 'SHORT') {
                pnl = (entryPrice - currentPrice) * size;
            }

            const pnlPercent = (pnl / (entryPrice * size)) * 100;

            activePosition.unrealizedPnL = pnl;
            activePosition.pnlPercent = pnlPercent;

            updateActivePositionDisplay();
        }

        /**
         * Aktif pozisyon görüntüsünü günceller
         */
        function updateActivePositionDisplay() {
            const noPositionState = document.getElementById('noPositionState');
            const activePositionState = document.getElementById('activePositionState');

            if (!activePosition) {
                noPositionState.style.display = 'block';
                activePositionState.style.display = 'none';
                return;
            }

            noPositionState.style.display = 'none';
            activePositionState.style.display = 'block';

            const pnl = activePosition.unrealizedPnL || 0;
            const pnlPercent = activePosition.pnlPercent || 0;
            const pnlColor = pnl >= 0 ? '#00D4AA' : '#F84960';
            const sideColor = activePosition.side === 'LONG' ? '#00D4AA' : '#F84960';

            activePositionState.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <div>
                        <div style="font-size: 1.2rem; font-weight: 700; color: ${sideColor};">
                            ${activePosition.side} ${activePosition.symbol}
                        </div>
                        <div style="font-size: 0.8rem; color: #888;">
                            Size: ${activePosition.size} | Entry: ${formatPrice(activePosition.entryPrice)}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 1.1rem; font-weight: 700; color: ${pnlColor};">
                            ${formatUSDT(pnl)}
                        </div>
                        <div style="font-size: 0.8rem; color: ${pnlColor};">
                            ${pnlPercent >= 0 ? '+' : ''}${pnlPercent.toFixed(2)}%
                        </div>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button class="btn danger" onclick="closePosition()" style="padding: 8px; font-size: 0.8rem;">
                        🔴 Pozisyonu Kapat
                    </button>
                    <button class="btn warning" onclick="modifyPosition()" style="padding: 8px; font-size: 0.8rem;">
                        ⚙️ Düzenle
                    </button>
                </div>
            `;
        }

        /**
         * Pozisyonu kapatır
         */
        async function closePosition() {
            if (!activePosition) {
                showToast('❌ Kapatılacak pozisyon yok', 'error');
                return;
            }

            const symbol = activePosition.symbol;
            const size = activePosition.size;
            const side = activePosition.side === 'LONG' ? 'SELL' : 'BUY';

            debugLog(`🔴 Pozisyon kapatılıyor: ${side} ${size} ${symbol}`, 'trade');
            
            if (side === 'SELL') {
                await executeWebSocketSell(symbol, size);
            } else {
                await executeWebSocketBuy(symbol, size);
            }

            showToast(`🔴 Pozisyon kapatma emri gönderildi`, 'warning');
        }

        /**
         * Pozisyonu düzenler (Stop Loss / Take Profit)
         */
        function modifyPosition() {
            if (!activePosition) return;
            
            showToast('⚙️ Pozisyon düzenleme paneli yakında...', 'info');
            // Bu fonksiyon gelecekte genişletilebilir
        }

        // === BALANCE TRACKING SİSTEMİ ===
        
        /**
         * Bakiye görüntüsünü günceller
         */
        function updateBalanceDisplay() {
            // Ana bakiye göstergeleri
            safeUpdateElement('totalBalance', formatUSDT(currentBalance.total));
            safeUpdateElement('availableBalance', formatUSDT(currentBalance.available));
            safeUpdateElement('frozenBalance', formatUSDT(currentBalance.frozen));
            
            // Günlük PnL renklendirmesi
            const dailyPnLElement = document.getElementById('dailyPnLDisplay');
            if (dailyPnLElement) {
                dailyPnLElement.textContent = formatUSDT(dailyPnL);
                if (dailyPnL > 0) {
                    dailyPnLElement.className = 'balance-positive';
                } else if (dailyPnL < 0) {
                    dailyPnLElement.className = 'balance-negative';
                } else {
                    dailyPnLElement.className = 'balance-neutral';
                }
            }
        }

        /**
         * Emirlerin görüntüsünü günceller
         */
        function updateOrdersDisplay() {
            // Açık emirler sayısını güncelle
            safeUpdateElement('openOrdersCount', openOrders.length);
            
            // Toplam işlem sayısını güncelle
            tradingStats.totalTrades = orderHistory.filter(order => order.status === 'FILLED').length;
            safeUpdateElement('totalTradesDisplay', tradingStats.totalTrades);
        }

        // === ORDER BOOK ANALİZİ ===
        
        /**
         * Order book dengesizliğini analiz eder
         */
        function analyzeOrderBookImbalance(orderBook) {
            if (!orderBook.bids || !orderBook.asks || orderBook.bids.length === 0 || orderBook.asks.length === 0) {
                return;
            }

            // İlk 10 seviyedeki toplam hacmi hesapla
            const bidVolume = orderBook.bids.slice(0, 10).reduce((sum, bid) => sum + bid[1], 0);
            const askVolume = orderBook.asks.slice(0, 10).reduce((sum, ask) => sum + ask[1], 0);
            const totalVolume = bidVolume + askVolume;

            if (totalVolume === 0) return;

            const buyPressure = (bidVolume / totalVolume) * 100;
            const sellPressure = (askVolume / totalVolume) * 100;

            // UI güncelle
            safeUpdateElement('buyPressure', `${buyPressure.toFixed(1)}%`);
            safeUpdateElement('sellPressure', `${sellPressure.toFixed(1)}%`);

            const balanceBar = document.getElementById('orderbookBalance');
            if (balanceBar) {
                balanceBar.style.width = `${buyPressure}%`;
            }

            // Dengesizlik durumunu belirle
            let imbalanceText = 'Dengeli Piyasa';
            if (buyPressure > 60) {
                imbalanceText = 'Güçlü Alış Baskısı';
            } else if (sellPressure > 60) {
                imbalanceText = 'Güçlü Satış Baskısı';
            } else if (buyPressure > 55) {
                imbalanceText = 'Hafif Alış Baskısı';
            } else if (sellPressure > 55) {
                imbalanceText = 'Hafif Satış Baskısı';
            }

            safeUpdateElement('orderbookImbalance', imbalanceText);

            // AI sistemine order book verilerini gönder
            if (aiOrderbook) {
                aiOrderbook.analyze({
                    bids: orderBook.bids,
                    asks: orderBook.asks,
                    buyPressure: buyPressure,
                    sellPressure: sellPressure,
                    imbalance: imbalanceText
                });
            }
        }

        // === SİNYAL İŞLEME VE OTOMATİK TRADING ===
        
        /**
         * AI sinyali geldiğinde otomatik trading yapar
         */
        async function processAISignal(signal) {
            if (!tradingEnabled) {
                debugLog('⏸️ Trading kapalı, sinyal işlenmedi', 'warning');
                return;
            }

            if (!isTradingConnected) {
                debugLog('❌ Trading WebSocket bağlantısı yok, sinyal işlenemedi', 'error');
                return;
            }

            // Günlük zarar limitini kontrol et
            if (dailyPnL < -maxDailyLoss) {
                debugLog('🛑 Günlük zarar limiti aşıldı, trading durduruldu', 'error');
                tradingEnabled = false;
                updateTradingStatus();
                return;
            }

            // Aktif pozisyon varsa yeni sinyal alma
            if (activePosition) {
                debugLog('⏳ Aktif pozisyon var, yeni sinyal bekletiliyor', 'warning');
                return;
            }

            debugLog(`🎯 AI sinyali işleniyor: ${signal.side} ${signal.symbol}`, 'trade');

            try {
                let orderId = null;
                const quantity = calculatePositionSize(signal.entryPrice);

                if (signal.side === 'LONG') {
                    orderId = await executeWebSocketBuy(signal.symbol, quantity, signal.entryPrice, 'LIMIT');
                } else if (signal.side === 'SHORT') {
                    orderId = await executeWebSocketSell(signal.symbol, quantity, signal.entryPrice, 'LIMIT');
                }

                if (orderId) {
                    // Sinyali aktif sinyal olarak kaydet
                    activeSignal = {
                        ...signal,
                        orderId: orderId,
                        timestamp: Date.now(),
                        status: 'ACTIVE'
                    };

                    updateActiveSignalDisplay();
                    showToast(`🎯 AI sinyali işlendi: ${signal.side} ${signal.symbol}`, 'success');
                    
                    // Ses bildirimi çal (Android telefon için)
                    playSignalNotification();
                }
            } catch (error) {
                debugLog(`❌ Sinyal işleme hatası: ${error.message}`, 'error');
                showToast('❌ Sinyal işlenemedi', 'error');
            }
        }

        /**
         * Pozisyon büyüklüğünü hesaplar
         */
        function calculatePositionSize(entryPrice) {
            const maxRisk = positionSize; // USDT cinsinden
            const quantity = maxRisk / entryPrice;
            return parseFloat(quantity.toFixed(6));
        }

        /**
         * Sinyal bildirimi sesi çalar (Android telefon için)
         */
        function playSignalNotification() {
            try {
                // Web Audio API ile basit bir beep sesi oluştur
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.value = 800; // 800 Hz
                oscillator.type = 'sine';

                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);

                debugLog('🔊 Sinyal bildirimi sesi çalındı', 'info');
            } catch (error) {
                debugLog(`❌ Ses bildirimi hatası: ${error.message}`, 'error');
            }
        }

        /**
         * Trading durumunu günceller
         */
        function updateTradingStatus() {
            const tradingStatus = document.getElementById('tradingStatus');
            const tradingToggle = document.getElementById('tradingToggle');
            const tradingButtonText = document.getElementById('tradingButtonText');
            const stickyTrading = document.getElementById('stickyTrading');
            const mainTradingStatus = document.getElementById('mainTradingStatus');

            if (tradingEnabled) {
                tradingStatus.textContent = '🟢 Aktif';
                tradingStatus.style.color = '#00D4AA';
                tradingToggle.className = 'btn danger';
                tradingButtonText.textContent = '🔴 Trading Sistemini Durdur';
                stickyTrading.className = 'quick-status status-trading';
                stickyTrading.innerHTML = '🟢 Trading Aktif';
                mainTradingStatus.textContent = '🟢 Aktif';
                mainTradingStatus.style.color = '#00D4AA';
            } else {
                tradingStatus.textContent = '⏸️ Kapalı';
                tradingStatus.style.color = '#FFC107';
                tradingToggle.className = 'btn success';
                tradingButtonText.textContent = '🟢 Trading Sistemini Başlat';
                stickyTrading.className = 'quick-status status-trading';
                stickyTrading.innerHTML = '⏸️ Trading Kapalı';
                mainTradingStatus.textContent = '⏸️ Kapalı';
                mainTradingStatus.style.color = '#FFC107';
            }
        }


        // === AI ANALİZ SİSTEMİ ===
        
        /**
         * AI analizini tetikler - Her market verisi geldiğinde çalışır
         */
        function triggerAIAnalysis() {
            if (priceHistory.length < 20) return; // Yeterli veri yok
            
            // AI sistemlerini güncelle
            updateAILearningData();
            
            // Her stratejiyi analiz et
            analyzeWhaleOrders();
            analyzeOrderImbalance();
            analyzeVolumeSpikes();
            analyzeSupportResistance();
            
            // Sinyal üretimini kontrol et
            checkForSignalGeneration();
        }

        /**
         * AI öğrenme verilerini günceller
         */
        function updateAILearningData() {
            aiLearningData.totalProcessed++;
            
            // Öğrenme ilerlemesini hesapla (logaritmik büyüme)
            const progress = Math.min(95, Math.log10(aiLearningData.totalProcessed + 1) * 25);
            aiLearningData.learningProgress = progress;
            
            // Performans skorunu hesapla
            const totalTrades = Object.values(aiLearningData.strategies).reduce((sum, s) => sum + s.total, 0);
            const successfulTrades = Object.values(aiLearningData.strategies).reduce((sum, s) => sum + s.success, 0);
            
            if (totalTrades > 0) {
                aiLearningData.accuracy = (successfulTrades / totalTrades) * 100;
                aiLearningData.performanceScore = Math.min(100, aiLearningData.accuracy + (progress * 0.3));
            }
            
            // UI güncelle
            updateAIDisplays();
        }

        /**
         * AI görüntülerini günceller
         */
        function updateAIDisplays() {
            safeUpdateElement('aiProcessedData', aiLearningData.totalProcessed.toLocaleString());
            safeUpdateElement('aiAccuracy', `${aiLearningData.accuracy.toFixed(1)}%`);
            safeUpdateElement('aiPerformance', `${Math.floor(aiLearningData.performanceScore)}/100`);
            safeUpdateElement('aiProgressPercent', `${Math.floor(aiLearningData.learningProgress)}%`);
            
            // Progress bar güncelle
            const progressBar = document.getElementById('overallAIProgress');
            if (progressBar) {
                progressBar.style.width = `${aiLearningData.learningProgress}%`;
            }
            
            // AI durumunu güncelle
            let status = 'Başlangıç Modu';
            let details = 'Sistem hazırlanıyor...';
            
            if (aiLearningData.learningProgress > 80) {
                status = 'Uzman Seviye';
                details = 'Yüksek performans modu aktif';
            } else if (aiLearningData.learningProgress > 50) {
                status = 'Gelişmiş Seviye';
                details = 'Aktif öğrenme devam ediyor';
            } else if (aiLearningData.learningProgress > 20) {
                status = 'Öğrenme Modu';
                details = 'Veri analizi yapılıyor';
            }
            
            safeUpdateElement('aiLearningStatus', status);
            safeUpdateElement('aiStatusDetails', details);
        }

        /**
         * Whale (büyük) emirleri analiz eder
         */
        function analyzeWhaleOrders() {
            if (orderBookData.bids.length === 0 || orderBookData.asks.length === 0) return;
            
            // Büyük emirleri tespit et (ortalama emir büyüklüğünün 5 katı)
            const allOrders = [...orderBookData.bids, ...orderBookData.asks];
            const avgOrderSize = allOrders.reduce((sum, order) => sum + order[1], 0) / allOrders.length;
            const whaleThreshold = avgOrderSize * 5;
            
            const whaleOrders = allOrders.filter(order => order[1] > whaleThreshold);
            
            if (whaleOrders.length > 0) {
                debugLog(`🐋 ${whaleOrders.length} whale emri tespit edildi`, 'ai');
                
                // Whale emirlerinin yönünü analiz et
                const whaleBids = orderBookData.bids.filter(bid => bid[1] > whaleThreshold);
                const whaleAsks = orderBookData.asks.filter(ask => ask[1] > whaleThreshold);
                
                if (whaleBids.length > whaleAsks.length * 2) {
                    // Güçlü alış whale aktivitesi
                    generateSignal('whale', 'LONG', 85, 'Whale alış baskısı tespit edildi');
                } else if (whaleAsks.length > whaleBids.length * 2) {
                    // Güçlü satış whale aktivitesi
                    generateSignal('whale', 'SHORT', 85, 'Whale satış baskısı tespit edildi');
                }
            }
        }

        /**
         * Order book dengesizliğini analiz eder
         */
        function analyzeOrderImbalance() {
            if (orderBookData.bids.length === 0 || orderBookData.asks.length === 0) return;
            
            // İlk 5 seviyedeki toplam hacmi hesapla
            const bidVolume = orderBookData.bids.slice(0, 5).reduce((sum, bid) => sum + bid[1], 0);
            const askVolume = orderBookData.asks.slice(0, 5).reduce((sum, ask) => sum + ask[1], 0);
            const totalVolume = bidVolume + askVolume;
            
            if (totalVolume === 0) return;
            
            const imbalanceRatio = bidVolume / askVolume;
            
            // Güçlü dengesizlik tespit et
            if (imbalanceRatio > 3) {
                generateSignal('imbalance', 'LONG', 75, `Güçlü alış dengesizliği (${imbalanceRatio.toFixed(2)}:1)`);
            } else if (imbalanceRatio < 0.33) {
                generateSignal('imbalance', 'SHORT', 75, `Güçlü satış dengesizliği (1:${(1/imbalanceRatio).toFixed(2)})`);
            }
        }

        /**
         * Volume spike'larını analiz eder
         */
        function analyzeVolumeSpikes() {
            if (volumeHistory.length < 10) return;
            
            const currentVolume = volumeHistory[volumeHistory.length - 1];
            const avgVolume = volumeHistory.slice(-10, -1).reduce((sum, vol) => sum + vol, 0) / 9;
            
            if (avgVolume === 0) return;
            
            const volumeRatio = currentVolume / avgVolume;
            
            // Volume spike tespit et
            if (volumeRatio > botSettings.volumeThreshold) {
                const confidence = Math.min(95, 60 + (volumeRatio - botSettings.volumeThreshold) * 10);
                
                // Fiyat yönünü kontrol et
                if (priceHistory.length >= 2) {
                    const priceChange = priceHistory[priceHistory.length - 1] - priceHistory[priceHistory.length - 2];
                    const side = priceChange > 0 ? 'LONG' : 'SHORT';
                    
                    generateSignal('volume', side, confidence, `Volume spike: ${volumeRatio.toFixed(2)}x`);
                }
            }
        }

        /**
         * Destek ve direnç seviyelerini analiz eder
         */
        function analyzeSupportResistance() {
            if (priceHistory.length < 50) return;
            
            const recentPrices = priceHistory.slice(-50);
            const currentPrice = recentPrices[recentPrices.length - 1];
            
            // Basit destek/direnç tespiti
            const highs = [];
            const lows = [];
            
            for (let i = 2; i < recentPrices.length - 2; i++) {
                const price = recentPrices[i];
                const prev2 = recentPrices[i - 2];
                const prev1 = recentPrices[i - 1];
                const next1 = recentPrices[i + 1];
                const next2 = recentPrices[i + 2];
                
                // Yerel maksimum
                if (price > prev2 && price > prev1 && price > next1 && price > next2) {
                    highs.push(price);
                }
                
                // Yerel minimum
                if (price < prev2 && price < prev1 && price < next1 && price < next2) {
                    lows.push(price);
                }
            }
            
            // En yakın destek ve direnç seviyelerini bul
            const resistance = highs.filter(h => h > currentPrice).sort((a, b) => a - b)[0];
            const support = lows.filter(l => l < currentPrice).sort((a, b) => b - a)[0];
            
            // Destek/direnç yakınlığını kontrol et
            if (support && Math.abs(currentPrice - support) / currentPrice < 0.005) {
                generateSignal('sr', 'LONG', 70, `Destek seviyesi yakınında: ${formatPrice(support)}`);
            } else if (resistance && Math.abs(resistance - currentPrice) / currentPrice < 0.005) {
                generateSignal('sr', 'SHORT', 70, `Direnç seviyesi yakınında: ${formatPrice(resistance)}`);
            }
        }

        /**
         * Sinyal üretir ve değerlendirir
         */
        function generateSignal(strategy, side, confidence, reason) {
            // Minimum güven seviyesini kontrol et
            if (confidence < botSettings.minConfidence) {
                return;
            }
            
            // Cooldown kontrolü
            const now = Date.now();
            if (now - lastSignalTime < botSettings.signalCooldown) {
                return;
            }
            
            // Sinyal objesi oluştur
            const signal = {
                id: generateSignalId(),
                strategy: strategy,
                side: side,
                symbol: currentSymbol,
                entryPrice: lastPrice,
                takeProfit: calculateTakeProfit(lastPrice, side),
                stopLoss: calculateStopLoss(lastPrice, side),
                confidence: confidence,
                reason: reason,
                timestamp: now,
                status: 'PENDING'
            };
            
            debugLog(`🎯 Sinyal üretildi: ${strategy} ${side} (${confidence}%) - ${reason}`, 'ai');
            
            // Sinyal geçmişine ekle
            signalHistory.unshift(signal);
            if (signalHistory.length > 100) signalHistory.pop();
            
            // UI güncelle
            updateActiveSignalDisplay(signal);
            updateSignalHistoryDisplay();
            
            // Otomatik trading aktifse sinyali işle
            if (tradingEnabled) {
                processAISignal(signal);
            } else {
                showToast(`🎯 Yeni sinyal: ${side} ${currentSymbol} (${confidence}%)`, 'info');
                playSignalNotification();
            }
            
            lastSignalTime = now;
        }

        /**
         * Take Profit seviyesini hesaplar
         */
        function calculateTakeProfit(entryPrice, side) {
            const tpPercent = botSettings.takeProfitPercent / 100;
            if (side === 'LONG') {
                return entryPrice * (1 + tpPercent);
            } else {
                return entryPrice * (1 - tpPercent);
            }
        }

        /**
         * Stop Loss seviyesini hesaplar
         */
        function calculateStopLoss(entryPrice, side) {
            const slPercent = botSettings.stopLossPercent / 100;
            if (side === 'LONG') {
                return entryPrice * (1 - slPercent);
            } else {
                return entryPrice * (1 + slPercent);
            }
        }

        /**
         * Benzersiz sinyal ID'si oluşturur
         */
        function generateSignalId() {
            return `SIG_${Date.now()}_${Math.random().toString(36).substr(2, 6)}`;
        }

        /**
         * Sinyal üretimini kontrol eder
         */
        function checkForSignalGeneration() {
            // Çoklu strateji kombinasyonu kontrolü
            const recentSignals = signalHistory.filter(s => Date.now() - s.timestamp < 300000); // Son 5 dakika
            
            if (recentSignals.length >= 2) {
                const strategies = [...new Set(recentSignals.map(s => s.strategy))];
                const sides = [...new Set(recentSignals.map(s => s.side))];
                
                // Aynı yönde birden fazla strateji sinyali varsa güçlü sinyal
                if (strategies.length >= 2 && sides.length === 1) {
                    const avgConfidence = recentSignals.reduce((sum, s) => sum + s.confidence, 0) / recentSignals.length;
                    const combinedConfidence = Math.min(95, avgConfidence + 10);
                    
                    generateSignal('combined', sides[0], combinedConfidence, `Çoklu strateji konfirmasyonu: ${strategies.join(', ')}`);
                }
            }
        }

        // === SİNYAL GÖRÜNTÜLEME VE YÖNETİMİ ===
        
        /**
         * Aktif sinyal görüntüsünü günceller
         */
        function updateActiveSignalDisplay(signal = activeSignal) {
            const noSignalState = document.getElementById('noSignalState');
            const activeSignalState = document.getElementById('activeSignalState');
            
            if (!signal) {
                noSignalState.style.display = 'block';
                activeSignalState.style.display = 'none';
                
                // Güven seviyesi göstergesini sıfırla
                safeUpdateElement('confidencePercent', '0%');
                const confidenceBar = document.getElementById('confidenceBar');
                if (confidenceBar) confidenceBar.style.width = '0%';
                
                return;
            }
            
            noSignalState.style.display = 'none';
            activeSignalState.style.display = 'block';
            
            // Sinyal detaylarını güncelle
            safeUpdateElement('signalEntryPrice', formatPrice(signal.entryPrice));
            safeUpdateElement('signalStrategy', signal.strategy.toUpperCase());
            safeUpdateElement('signalTakeProfit', formatPrice(signal.takeProfit));
            safeUpdateElement('signalStopLoss', formatPrice(signal.stopLoss));
            safeUpdateElement('signalDuration', formatTime(Math.floor((Date.now() - signal.timestamp) / 1000)));
            safeUpdateElement('signalTimestamp', new Date(signal.timestamp).toLocaleTimeString());
            
            // Güven seviyesi göstergesi
            safeUpdateElement('confidencePercent', `${signal.confidence}%`);
            const confidenceBar = document.getElementById('confidenceBar');
            if (confidenceBar) {
                confidenceBar.style.width = `${signal.confidence}%`;
            }
            
            // Sinyal kartını güncelle
            const sideColor = signal.side === 'LONG' ? '#00D4AA' : '#F84960';
            const sideIcon = signal.side === 'LONG' ? '📈' : '📉';
            
            activeSignalState.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <div>
                        <div style="font-size: 1.3rem; font-weight: 700; color: ${sideColor}; display: flex; align-items: center; gap: 8px;">
                            ${sideIcon} ${signal.side} ${signal.symbol}
                        </div>
                        <div style="font-size: 0.85rem; color: #888; margin-top: 4px;">
                            ${signal.reason}
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 1.1rem; font-weight: 700; color: #4ECDC4;">
                            ${signal.confidence}%
                        </div>
                        <div style="font-size: 0.75rem; color: #888;">
                            Güven
                        </div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 15px; font-size: 0.8rem;">
                    <div style="text-align: center; padding: 8px; background: rgba(78,205,196,0.1); border-radius: 6px;">
                        <div style="color: #888; margin-bottom: 2px;">Entry</div>
                        <div style="color: #4ECDC4; font-weight: 600;">${formatPrice(signal.entryPrice)}</div>
                    </div>
                    <div style="text-align: center; padding: 8px; background: rgba(0,212,170,0.1); border-radius: 6px;">
                        <div style="color: #888; margin-bottom: 2px;">TP</div>
                        <div style="color: #00D4AA; font-weight: 600;">${formatPrice(signal.takeProfit)}</div>
                    </div>
                    <div style="text-align: center; padding: 8px; background: rgba(248,73,96,0.1); border-radius: 6px;">
                        <div style="color: #888; margin-bottom: 2px;">SL</div>
                        <div style="color: #F84960; font-weight: 600;">${formatPrice(signal.stopLoss)}</div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button class="btn success" onclick="acceptSignal()" style="padding: 10px; font-size: 0.85rem;">
                        ✅ Kabul Et
                    </button>
                    <button class="btn danger" onclick="rejectSignal()" style="padding: 10px; font-size: 0.85rem;">
                        ❌ Reddet
                    </button>
                </div>
            `;
            
            // Sinyal kabul/reddet butonlarını aktif et
            const acceptBtn = document.getElementById('acceptSignalBtn');
            const rejectBtn = document.getElementById('rejectSignalBtn');
            if (acceptBtn) acceptBtn.disabled = false;
            if (rejectBtn) rejectBtn.disabled = false;
        }

        /**
         * Sinyali kabul eder
         */
        function acceptSignal() {
            if (!activeSignal) return;
            
            debugLog(`✅ Sinyal kabul edildi: ${activeSignal.side} ${activeSignal.symbol}`, 'trade');
            
            if (tradingEnabled && isTradingConnected) {
                processAISignal(activeSignal);
            } else {
                showToast('⚠️ Trading kapalı veya bağlantı yok', 'warning');
            }
            
            activeSignal.status = 'ACCEPTED';
            showToast('✅ Sinyal kabul edildi', 'success');
        }

        /**
         * Sinyali reddeder
         */
        function rejectSignal() {
            if (!activeSignal) return;
            
            debugLog(`❌ Sinyal reddedildi: ${activeSignal.side} ${activeSignal.symbol}`, 'trade');
            
            activeSignal.status = 'REJECTED';
            activeSignal = null;
            updateActiveSignalDisplay();
            showToast('❌ Sinyal reddedildi', 'warning');
        }

        /**
         * Test sinyali oluşturur
         */
        function generateTestSignal() {
            if (!currentSymbol || lastPrice === 0) {
                showToast('❌ Önce bir coin bağlantısı kurun', 'error');
                return;
            }
            
            const testStrategies = ['whale', 'volume', 'imbalance', 'sr'];
            const testSides = ['LONG', 'SHORT'];
            
            const strategy = testStrategies[Math.floor(Math.random() * testStrategies.length)];
            const side = testSides[Math.floor(Math.random() * testSides.length)];
            const confidence = Math.floor(Math.random() * 30) + 65; // 65-95 arası
            
            generateSignal(strategy, side, confidence, 'Test sinyali - Manuel oluşturuldu');
            showToast('🧪 Test sinyali oluşturuldu', 'info');
        }


        // === BOT AYARLARI VE KONFİGÜRASYON ===
        
        /**
         * Bot ayarını günceller
         */
        function updateBotSetting(setting, value) {
            botSettings[setting] = value;
            debugLog(`⚙️ Bot ayarı güncellendi: ${setting} = ${value}`, 'info');
            
            // Adaptif eşikler aktifse otomatik optimizasyon yap
            if (botSettings.adaptiveThresholds && setting !== 'adaptiveThresholds') {
                optimizeSettings();
            }
        }

        /**
         * Slider görüntüsünü günceller
         */
        function updateSliderDisplay(elementId, value) {
            safeUpdateElement(elementId, value);
        }

        /**
         * Pozisyon büyüklüğünü günceller
         */
        function updatePositionSize(value) {
            positionSize = parseFloat(value);
            debugLog(`💰 Pozisyon büyüklüğü güncellendi: ${positionSize} USDT`, 'info');
        }

        /**
         * Ayarları kaydeder
         */
        function saveSettings() {
            try {
                localStorage.setItem('3c3_bot_settings', JSON.stringify(botSettings));
                localStorage.setItem('3c3_position_size', positionSize.toString());
                showToast('💾 Ayarlar kaydedildi', 'success');
                debugLog('💾 Bot ayarları localStorage\'a kaydedildi', 'info');
            } catch (error) {
                showToast('❌ Ayarlar kaydedilemedi', 'error');
                debugLog(`❌ Ayar kaydetme hatası: ${error.message}`, 'error');
            }
        }

        /**
         * Ayarları yükler
         */
        function loadSettings() {
            try {
                const savedSettings = localStorage.getItem('3c3_bot_settings');
                const savedPositionSize = localStorage.getItem('3c3_position_size');
                
                if (savedSettings) {
                    const settings = JSON.parse(savedSettings);
                    Object.assign(botSettings, settings);
                    updateSettingsUI();
                    debugLog('📂 Bot ayarları yüklendi', 'info');
                }
                
                if (savedPositionSize) {
                    positionSize = parseFloat(savedPositionSize);
                    safeUpdateElement('positionSizeInput', positionSize);
                }
            } catch (error) {
                debugLog(`❌ Ayar yükleme hatası: ${error.message}`, 'error');
            }
        }

        /**
         * Ayarları varsayılana döndürür
         */
        function resetSettings() {
            botSettings = {
                volumeThreshold: 2.0,
                takeProfitPercent: 0.8,
                stopLossPercent: 0.5,
                minConfidence: 70,
                signalCooldown: 30000,
                learningSpeed: 'medium',
                autoOptimization: true,
                adaptiveThresholds: true,
                riskManagement: true
            };
            positionSize = 50;
            updateSettingsUI();
            showToast('🔄 Ayarlar varsayılana döndürüldü', 'warning');
            debugLog('🔄 Bot ayarları varsayılana döndürüldü', 'info');
        }

        /**
         * Ayar UI'sını günceller
         */
        function updateSettingsUI() {
            safeUpdateElement('volumeThreshold', botSettings.volumeThreshold);
            safeUpdateElement('takeProfitPercent', botSettings.takeProfitPercent);
            safeUpdateElement('stopLossPercent', botSettings.stopLossPercent);
            safeUpdateElement('minConfidence', botSettings.minConfidence);
            safeUpdateElement('positionSizeInput', positionSize);
            
            // Slider değerlerini güncelle
            updateSliderDisplay('volumeThresholdValue', botSettings.volumeThreshold + 'x');
            updateSliderDisplay('takeProfitValue', botSettings.takeProfitPercent + '%');
            updateSliderDisplay('stopLossValue', botSettings.stopLossPercent + '%');
            updateSliderDisplay('minConfidenceValue', botSettings.minConfidence + '%');
            
            // Checkbox'ları güncelle
            const autoOptEl = document.getElementById('autoOptimization');
            const adaptiveEl = document.getElementById('adaptiveThresholds');
            const riskEl = document.getElementById('riskManagement');
            const learningEl = document.getElementById('learningSpeed');
            
            if (autoOptEl) autoOptEl.checked = botSettings.autoOptimization;
            if (adaptiveEl) adaptiveEl.checked = botSettings.adaptiveThresholds;
            if (riskEl) riskEl.checked = botSettings.riskManagement;
            if (learningEl) learningEl.value = botSettings.learningSpeed;
        }

        /**
         * Ayarları export eder
         */
        function exportSettings() {
            const exportData = {
                botSettings: botSettings,
                positionSize: positionSize,
                exportDate: new Date().toISOString(),
                version: '3C3_v4.2.1'
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `3C3_settings_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showToast('📤 Ayarlar export edildi', 'success');
        }

        /**
         * Ayarları import eder
         */
        function importSettings() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importData = JSON.parse(e.target.result);
                        
                        if (importData.botSettings) {
                            Object.assign(botSettings, importData.botSettings);
                        }
                        if (importData.positionSize) {
                            positionSize = importData.positionSize;
                        }
                        
                        updateSettingsUI();
                        showToast('📥 Ayarlar import edildi', 'success');
                        debugLog('📥 Bot ayarları import edildi', 'info');
                    } catch (error) {
                        showToast('❌ Import hatası', 'error');
                        debugLog(`❌ Import hatası: ${error.message}`, 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }

        /**
         * AI'yi sıfırlar
         */
        function resetAI() {
            aiLearningData = {
                totalProcessed: 0,
                learningProgress: 0,
                performanceScore: 0,
                accuracy: 0,
                strategies: {
                    whale: { total: 0, success: 0, profits: [], times: [], reliability: 0 },
                    imbalance: { total: 0, success: 0, profits: [], times: [], reliability: 0 },
                    volume: { total: 0, success: 0, profits: [], times: [], reliability: 0 },
                    sr: { total: 0, success: 0, profits: [], times: [], reliability: 0 }
                },
                lastModelUpdate: null
            };
            
            signalHistory = [];
            updateAIDisplays();
            updateSignalHistoryDisplay();
            showToast('🧠 AI sistemi sıfırlandı', 'warning');
            debugLog('🧠 AI öğrenme sistemi sıfırlandı', 'info');
        }

        /**
         * Ayarları otomatik optimize eder
         */
        function optimizeSettings() {
            if (!botSettings.autoOptimization) return;
            
            const totalTrades = tradingStats.totalTrades;
            if (totalTrades < 10) return; // Yeterli veri yok
            
            const winRate = tradingStats.winTrades / totalTrades;
            
            // Kazanma oranına göre ayarları optimize et
            if (winRate < 0.6) {
                // Düşük kazanma oranı - daha konservatif ayarlar
                botSettings.minConfidence = Math.min(90, botSettings.minConfidence + 5);
                botSettings.volumeThreshold = Math.min(5.0, botSettings.volumeThreshold + 0.2);
            } else if (winRate > 0.8) {
                // Yüksek kazanma oranı - daha agresif ayarlar
                botSettings.minConfidence = Math.max(50, botSettings.minConfidence - 3);
                botSettings.volumeThreshold = Math.max(1.2, botSettings.volumeThreshold - 0.1);
            }
            
            updateSettingsUI();
            debugLog(`🔧 Ayarlar optimize edildi (Win Rate: ${(winRate * 100).toFixed(1)}%)`, 'ai');
        }

        // === SİSTEM FONKSİYONLARI ===
        
        /**
         * Trading sistemini toggle eder
         */
        function toggleTrading() {
            tradingEnabled = !tradingEnabled;
            updateTradingStatus();
            
            if (tradingEnabled) {
                debugLog('🟢 Trading sistemi aktif edildi', 'trade');
                showToast('🟢 Trading sistemi başlatıldı', 'success');
            } else {
                debugLog('⏸️ Trading sistemi durduruldu', 'trade');
                showToast('⏸️ Trading sistemi durduruldu', 'warning');
            }
        }

        /**
         * API bağlantısını test eder
         */
        function testApiConnection() {
            debugLog('🧪 API bağlantısı test ediliyor...', 'api');
            showLoading('API bağlantısı test ediliyor...');
            
            // Simülasyon
            setTimeout(() => {
                hideLoading();
                const success = Math.random() > 0.2; // %80 başarı oranı
                
                if (success) {
                    showToast('✅ API bağlantısı başarılı', 'success');
                    debugLog('✅ API bağlantı testi başarılı', 'success');
                } else {
                    showToast('❌ API bağlantı hatası', 'error');
                    debugLog('❌ API bağlantı testi başarısız', 'error');
                }
            }, 2000);
        }

        /**
         * Farklı proxy'ler ile test yapar
         */
        function testWithDifferentProxies() {
            debugLog('🔄 Proxy sunucuları test ediliyor...', 'api');
            showLoading('Proxy sunucuları test ediliyor...');
            
            const proxies = ['US-East', 'EU-West', 'Asia-Pacific', 'Direct'];
            let currentProxy = 0;
            
            const testNextProxy = () => {
                if (currentProxy >= proxies.length) {
                    hideLoading();
                    showToast('✅ En iyi proxy seçildi', 'success');
                    debugLog('✅ Proxy test tamamlandı', 'success');
                    return;
                }
                
                safeUpdateElement('loadingMessage', `${proxies[currentProxy]} proxy test ediliyor...`);
                debugLog(`🔄 ${proxies[currentProxy]} proxy test ediliyor...`, 'api');
                
                setTimeout(() => {
                    currentProxy++;
                    testNextProxy();
                }, 1000);
            };
            
            testNextProxy();
        }

        /**
         * MEXC sunucularına ping atar
         */
        function pingMexcServers() {
            debugLog('📡 MEXC sunucularına ping atılıyor...', 'api');
            showLoading('MEXC sunucularına ping atılıyor...');
            
            const servers = ['Singapore', 'Tokyo', 'Frankfurt', 'New York'];
            const pings = [];
            
            servers.forEach((server, index) => {
                setTimeout(() => {
                    const ping = Math.floor(Math.random() * 100) + 20; // 20-120ms arası
                    pings.push({ server, ping });
                    debugLog(`📡 ${server}: ${ping}ms`, 'api');
                    
                    if (pings.length === servers.length) {
                        hideLoading();
                        const bestServer = pings.sort((a, b) => a.ping - b.ping)[0];
                        showToast(`📡 En iyi sunucu: ${bestServer.server} (${bestServer.ping}ms)`, 'success');
                        safeUpdateElement('networkPing', `${bestServer.ping}ms`);
                        safeUpdateElement('networkStatus', `${bestServer.server} sunucusu`);
                    }
                }, index * 500);
            });
        }

        /**
         * Sistem sağlığını kontrol eder
         */
        function checkSystemHealth() {
            debugLog('💚 Sistem sağlığı kontrol ediliyor...', 'info');
            showLoading('Sistem sağlığı kontrol ediliyor...');
            
            setTimeout(() => {
                hideLoading();
                
                const health = {
                    websocket: isConnected ? '✅ Bağlı' : '❌ Bağlantısız',
                    trading: isTradingConnected ? '✅ Aktif' : '❌ Kapalı',
                    ai: aiLearningData.learningProgress > 20 ? '✅ Çalışıyor' : '⚠️ Öğreniyor',
                    memory: '✅ Normal',
                    performance: '✅ İyi'
                };
                
                let healthMessage = 'Sistem Sağlığı:\n';
                Object.entries(health).forEach(([key, value]) => {
                    healthMessage += `${key}: ${value}\n`;
                });
                
                showToast('💚 Sistem sağlığı kontrol edildi', 'success');
                debugLog(healthMessage, 'info');
            }, 1500);
        }

        /**
         * Debug log'unu export eder
         */
        function exportDebugLog() {
            const consoleEl = document.getElementById('mobileDebugConsole');
            if (!consoleEl) return;
            
            const logs = Array.from(consoleEl.children).map(child => child.textContent).join('\n');
            const logBlob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(logBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `3C3_debug_log_${new Date().toISOString().split('T')[0]}.txt`;
            link.click();
            
            URL.revokeObjectURL(url);
            showToast('📤 Debug log export edildi', 'success');
        }

        /**
         * Sinyal geçmişini günceller
         */
        function updateSignalHistoryDisplay() {
            const container = document.getElementById('signalListContainer');
            const noSignalsMessage = document.getElementById('noSignalsMessage');
            
            if (!container) return;
            
            if (signalHistory.length === 0) {
                noSignalsMessage.style.display = 'block';
                container.innerHTML = '';
                return;
            }
            
            noSignalsMessage.style.display = 'none';
            
            container.innerHTML = signalHistory.slice(0, 20).map(signal => {
                const statusColor = {
                    'PENDING': '#FFC107',
                    'ACCEPTED': '#00D4AA',
                    'REJECTED': '#F84960',
                    'FILLED': '#00D4AA',
                    'CANCELLED': '#888'
                }[signal.status] || '#888';
                
                const sideColor = signal.side === 'LONG' ? '#00D4AA' : '#F84960';
                const timeAgo = formatTime(Math.floor((Date.now() - signal.timestamp) / 1000));
                
                return `
                    <div style="
                        background: rgba(255,255,255,0.03); 
                        border-radius: 8px; 
                        padding: 12px; 
                        margin-bottom: 8px; 
                        border-left: 3px solid ${sideColor};
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <div style="font-weight: 600; color: ${sideColor};">
                                ${signal.side} ${signal.symbol}
                            </div>
                            <div style="font-size: 0.75rem; color: ${statusColor}; font-weight: 600;">
                                ${signal.status}
                            </div>
                        </div>
                        <div style="font-size: 0.8rem; color: #888; margin-bottom: 6px;">
                            ${signal.reason}
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 0.75rem;">
                            <span style="color: #888;">Entry: ${formatPrice(signal.entryPrice)}</span>
                            <span style="color: #4ECDC4;">Güven: ${signal.confidence}%</span>
                            <span style="color: #666;">${timeAgo} önce</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        /**
         * Sinyal geçmişini filtreler
         */
        function filterSignals(filter) {
            // Filter butonlarının görünümünü güncelle
            document.querySelectorAll('[onclick^="filterSignals"]').forEach(btn => {
                btn.style.background = '';
            });
            document.getElementById(`filter${filter.charAt(0).toUpperCase() + filter.slice(1)}Btn`).style.background = 'rgba(78,205,196,0.8)';
            
            let filteredSignals = signalHistory;
            
            switch (filter) {
                case 'successful':
                    filteredSignals = signalHistory.filter(s => s.status === 'FILLED' || s.status === 'ACCEPTED');
                    break;
                case 'failed':
                    filteredSignals = signalHistory.filter(s => s.status === 'REJECTED' || s.status === 'CANCELLED');
                    break;
                case 'pending':
                    filteredSignals = signalHistory.filter(s => s.status === 'PENDING');
                    break;
                default:
                    filteredSignals = signalHistory;
            }
            
            // Geçici olarak filtrelenmiş listeyi göster
            const originalHistory = signalHistory;
            signalHistory = filteredSignals;
            updateSignalHistoryDisplay();
            signalHistory = originalHistory;
        }

        // === EVENT LISTENERS VE BAŞLATMA ===
        
        /**
         * Sayfa yüklendiğinde çalışır
         */
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('🚀 3C3 Trading Bot başlatılıyor...', 'info');
            
            // Ayarları yükle
            loadSettings();
            
            // UI'yi başlat
            updateConnectionUI('disconnected');
            updateTradingConnectionUI('disconnected');
            updateTradingStatus();
            updateAIDisplays();
            
            // Sistem timer'larını başlat
            setInterval(updateSystemUptime, 1000);
            setInterval(updateSystemMetrics, 5000);
            
            // Tema toggle event listener
            const themeToggle = document.getElementById('themeToggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', toggleTheme);
            }
            
            debugLog('✅ 3C3 Trading Bot başlatıldı', 'success');
            showToast('🚀 3C3 Trading Bot hazır', 'success');
        });

        /**
         * Sistem metriklerini günceller (simülasyon)
         */
        function updateSystemMetrics() {
            // CPU kullanımı simülasyonu
            const cpuUsage = Math.floor(Math.random() * 30) + 10; // 10-40% arası
            safeUpdateElement('cpuUsage', `${cpuUsage}%`);
            const cpuBar = document.getElementById('cpuBar');
            if (cpuBar) cpuBar.style.width = `${cpuUsage}%`;
            
            // Memory kullanımı simülasyonu
            const memoryUsage = Math.floor(Math.random() * 40) + 20; // 20-60% arası
            safeUpdateElement('memoryUsage', `${memoryUsage}%`);
            const memoryBar = document.getElementById('memoryBar');
            if (memoryBar) memoryBar.style.width = `${memoryUsage}%`;
        }

        /**
         * Tema değiştirir
         */
        function toggleTheme() {
            const body = document.body;
            const isLight = body.classList.contains('light-theme');
            
            if (isLight) {
                body.classList.remove('light-theme');
                localStorage.setItem('3c3_theme', 'dark');
                showToast('🌙 Karanlık tema aktif', 'info');
            } else {
                body.classList.add('light-theme');
                localStorage.setItem('3c3_theme', 'light');
                showToast('☀️ Aydınlık tema aktif', 'info');
            }
        }

        /**
         * Kaydedilmiş temayı yükler
         */
        function loadTheme() {
            const savedTheme = localStorage.getItem('3c3_theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-theme');
            }
        }

        // Tema yükleme
        loadTheme();

        // Enter tuşu ile bağlantı kurma
        document.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                const activeElement = document.activeElement;
                if (activeElement && activeElement.id === 'manualSymbol') {
                    connect();
                }
            }
        });

        // Sayfa kapatılırken bağlantıları temizle
        window.addEventListener('beforeunload', function() {
            if (ws) ws.close();
            if (tradingWs) tradingWs.close();
        });

        debugLog('📋 Tüm sistem fonksiyonları yüklendi', 'info');
    </script>
</body>
</html>

