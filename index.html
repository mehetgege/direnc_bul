<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üîç Akƒ±llƒ± PDF Model Tarayƒ±cƒ±</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
  <style>
    :root {
      --primary: #4361ee;
      --primary-dark: #3a0ca3;
      --secondary: #f72585;
      --success: #4cc9f0;
      --warning: #f8961e;
      --error: #ef233c;
      --info: #4895ef;
      --dark: #2b2d42;
      --light: #f8f9fa;
      --gray: #adb5bd;
      --dark-gray: #495057;
    }

    [data-theme="dark"] {
      --bg: var(--dark);
      --text: var(--light);
      --card: #1a1a2e;
      --border: #16213e;
    }

    [data-theme="light"] {
      --bg: var(--light);
      --text: var(--dark);
      --card: white;
      --border: #e9ecef;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      transition: all 0.3s ease;
      min-height: 100vh;
      line-height: 1.6;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
    }

    .header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .title {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(45deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: var(--text);
      opacity: 0.8;
      font-size: 1.1rem;
    }

    .theme-toggle {
      position: fixed;
      top: 1.5rem;
      right: 1.5rem;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 50%;
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      z-index: 100;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    .panel {
      background: var(--card);
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      border: 1px solid var(--border);
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border);
    }

    .panel-title {
      font-size: 1.25rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .badge {
      background: var(--primary);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .form-group {
      margin-bottom: 1rem;
    }

    label {
      display: block;
      font-weight: 500;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      color: var(--text);
    }

    input, select {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--card);
      color: var(--text);
      font-size: 1rem;
      transition: all 0.2s ease;
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
    }

    .btn-secondary {
      background: var(--secondary);
      color: white;
    }

    .btn-secondary:hover {
      background: #d91a6d;
    }

    .btn-success {
      background: var(--success);
      color: white;
    }

    .btn-warning {
      background: var(--warning);
      color: white;
    }

    .btn-error {
      background: var(--error);
      color: white;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .btn-group {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 1.5rem;
    }

    .models-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .model-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 1.5rem;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .model-card.scanning {
      border-left: 4px solid var(--info);
      animation: pulse 1.5s infinite;
    }

    .model-card.found {
      border-left: 4px solid var(--success);
    }

    .model-card.no-match {
      border-left: 4px solid var(--warning);
      opacity: 0.8;
    }

    .model-card.error {
      border-left: 4px solid var(--error);
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(72, 149, 239, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(72, 149, 239, 0); }
      100% { box-shadow: 0 0 0 0 rgba(72, 149, 239, 0); }
    }

    .model-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .model-name {
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .model-confidence {
      background: var(--success);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .model-status {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      font-size: 0.9rem;
    }

    .model-matches {
      margin-top: 1rem;
    }

    .matches-header {
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
      color: var(--success);
    }

    .matches-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .match-tag {
      background: var(--success);
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .model-link {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-block;
    }

    .model-link:hover {
      background: var(--primary-dark);
    }

    .status-panel {
      position: fixed;
      bottom: 1.5rem;
      left: 1.5rem;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 1rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      max-width: 350px;
      z-index: 100;
      transform: translateX(-400px);
      transition: transform 0.3s ease;
    }

    .status-panel.show {
      transform: translateX(0);
    }

    .status-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.75rem;
    }

    .status-title {
      font-size: 0.9rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .status-close {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text);
      opacity: 0.6;
    }

    .status-content {
      font-size: 0.85rem;
    }

    .status-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: var(--border);
      border-radius: 3px;
      margin-top: 1rem;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      width: 0%;
      transition: width 0.3s ease;
    }

    .connection-status {
      position: fixed;
      top: 1.5rem;
      left: 1.5rem;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 0.5rem 1rem;
      font-size: 0.85rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .connection-status.online {
      border-color: var(--success);
      color: var(--success);
    }

    .connection-status.offline {
      border-color: var(--error);
      color: var(--error);
    }

    .connection-status.loading {
      border-color: var(--warning);
      color: var(--warning);
    }

    .connection-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: currentColor;
    }

    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .loading-content {
      text-align: center;
      color: white;
      max-width: 400px;
      padding: 2rem;
    }

    .spinner {
      width: 3rem;
      height: 3rem;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1.5rem;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .toast {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      background: var(--success);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transform: translateX(400px);
      transition: transform 0.3s ease;
      z-index: 100;
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.error {
      background: var(--error);
    }

    .toast.warning {
      background: var(--warning);
    }

    .toast.info {
      background: var(--info);
    }

    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }

      .title {
        font-size: 1.8rem;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .models-grid {
        grid-template-columns: 1fr;
      }

      .btn-group {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }

      .status-panel {
        position: relative;
        bottom: auto;
        left: auto;
        transform: none;
        margin-bottom: 1rem;
        max-width: none;
      }

      .status-panel.show {
        transform: none;
      }
    }
  </style>
</head>
<body data-theme="light">
  <div class="theme-toggle" onclick="toggleTheme()">
    üåô
  </div>

  <div class="connection-status loading" id="connectionStatus">
    <div class="connection-dot"></div>
    <span id="connectionText">Baƒülantƒ± kontrol ediliyor...</span>
  </div>

  <div class="container">
    <div class="header">
      <h1 class="title">ü§ñ Akƒ±llƒ± PDF Model Tarayƒ±cƒ±</h1>
      <p class="subtitle">PDF belgelerinde diren√ß deƒüerlerini akƒ±llƒ± tarama</p>
    </div>

    <div class="panel">
      <div class="form-grid">
        <div class="form-group">
          <label>Min Deƒüer (Œ©)</label>
          <input type="number" id="minVal" placeholder="330000" value="330000">
        </div>

        <div class="form-group">
          <label>Max Deƒüer (Œ©)</label>
          <input type="number" id="maxVal" placeholder="2000000" value="2000000">
        </div>

        <div class="form-group">
          <label>Tarama Modu</label>
          <select id="scanMode">
            <option value="sequential">Sƒ±ralƒ± Tarama</option>
            <option value="parallel">Paralel Tarama</option>
            <option value="smart">Akƒ±llƒ± Tarama</option>
          </select>
        </div>

        <div class="form-group">
          <label>Hassasiyet</label>
          <select id="sensitivity">
            <option value="low">D√º≈ü√ºk (¬±10%)</option>
            <option value="medium" selected>Orta (¬±5%)</option>
            <option value="high">Y√ºksek (¬±1%)</option>
          </select>
        </div>
      </div>

      <div class="btn-group">
        <button class="btn btn-primary" id="scanBtn" onclick="startIntelligentScan()">
          üöÄ Tarama Ba≈ülat
        </button>
        <button class="btn btn-warning" onclick="stopScan()">
          ‚èπÔ∏è Durdur
        </button>
        <button class="btn btn-success" onclick="refreshModels()">
          üîÑ Modelleri Yenile
        </button>
      </div>
    </div>

    <div class="panel">
      <div class="panel-header">
        <div class="panel-title">
          üì± Algƒ±lanan Modeller
          <div class="badge" id="modelsCount">0</div>
        </div>
        <button class="btn btn-primary" onclick="refreshModels()" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
          üîç Yeniden Tara
        </button>
      </div>
      <div class="models-grid" id="modelsGrid">
        <div style="grid-column: 1/-1; text-align: center; padding: 2rem; color: var(--text); opacity: 0.6;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">üìÇ</div>
          <h3>Hen√ºz model bulunamadƒ±</h3>
          <p>"Modelleri Yenile" butonuna tƒ±klayƒ±n</p>
        </div>
      </div>
    </div>
  </div>

  <div class="status-panel" id="statusPanel">
    <div class="panel-header">
      <div class="panel-title">
        üìä Durum
      </div>
      <button class="status-close" onclick="toggleStatusPanel()">‚úï</button>
    </div>
    <div class="status-content" id="statusContent">
      <div class="status-item">
        <span>Durum:</span>
        <span id="currentStatus">Hazƒ±r</span>
      </div>
      <div class="status-item">
        <span>ƒ∞≈ülenen:</span>
        <span id="processedCount">0/0</span>
      </div>
      <div class="status-item">
        <span>Bulunan:</span>
        <span id="foundCount">0</span>
      </div>
      <div class="status-item">
        <span>Hata:</span>
        <span id="errorCount">0</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="statusProgress"></div>
      </div>
    </div>
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <h3>üß† PDF'ler analiz ediliyor...</h3>
      <p id="loadingText">L√ºtfen bekleyin...</p>
    </div>
  </div>

  <script>
    // PDF.js worker yolu
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.worker.min.js';

    // Uygulama durumu
    const state = {
      currentTheme: 'light',
      models: [],
      isScanning: false,
      scanProgress: 0,
      connectionStatus: 'loading',
      statusPanelVisible: true
    };

    // Telefon modelleri veritabanƒ±
    const phoneModels = [
      // iPhone Modelleri
      { name: 'iPhone 5s', keywords: ['iphone5s', 'iphone 5s'], confidence: 0.95, icon: 'üì±' },
      { name: 'iPhone 5c', keywords: ['iphone_5c', 'iphone 5c', '5c'], confidence: 0.93, icon: 'üì±' },
      { name: 'iPhone 6', keywords: ['iphone-6', 'iphone_6', 'iphone 6'], confidence: 0.94, icon: 'üì±' },
      { name: 'iPhone 6 Plus', keywords: ['iphone_6_plus', 'iphone-6-plus', '6_plus', '6plus'], confidence: 0.92, icon: 'üì±' },
      { name: 'iPhone 6s', keywords: ['iphone_6s', 'iphone-6s', '6s_schematic'], confidence: 0.93, icon: 'üì±' },
      { name: 'iPhone 6s Plus', keywords: ['iphone_6s_plus', '6s_plus', '6splus'], confidence: 0.91, icon: 'üì±' },
      { name: 'iPhone 7', keywords: ['iphone_7', 'iphone-7', '7_full'], confidence: 0.94, icon: 'üì±' },
      { name: 'iPhone 8', keywords: ['iphone8', 'iphone_8', '820-00871'], confidence: 0.95, icon: 'üì±' },
      { name: 'iPhone 8 Plus', keywords: ['iphone_8_plus', '8_plus', 'd21_mlb', '8plus'], confidence: 0.93, icon: 'üì±' },
      { name: 'iPhone SE', keywords: ['iphone_se', 'iphone-se', '820-00282', 'sen69'], confidence: 0.96, icon: 'üì±' },
      { name: 'iPhone X', keywords: ['iphone_x', 'iphone-x', 'qualcomm', 'intel_chipset'], confidence: 0.97, icon: 'üì±' },
      { name: 'iPhone XS Max', keywords: ['iphone_xsmax', 'xsmax', 'xs_max'], confidence: 0.95, icon: 'üì±' },
      { name: 'iPhone 11 Pro Max', keywords: ['iphone_11_pro_max', '11_pro_max', '11pro'], confidence: 0.98, icon: 'üì±' },
      
      // iPad Modelleri
      { name: 'iPad 3', keywords: ['ipad-3', 'ipad_3'], confidence: 0.90, icon: 'üìü' },
      { name: 'iPad 4', keywords: ['ipad-4', 'ipad_4'], confidence: 0.91, icon: 'üìü' },
      { name: 'iPad 5 (Air)', keywords: ['ipad5_air', 'ipad_5', 'apple_ipad5'], confidence: 0.92, icon: 'üìü' },
      { name: 'iPad Air', keywords: ['ipad-air', 'ipad_air', 'ipadair'], confidence: 0.93, icon: 'üìü' },
      { name: 'iPad Air 2', keywords: ['ipad_air2', 'air2', '820-3633'], confidence: 0.94, icon: 'üìü' },
      { name: 'iPad mini', keywords: ['ipad_mini', 'ipad-mini', 'mini_4g'], confidence: 0.89, icon: 'üìü' },
      { name: 'Apple PCB Layout', keywords: ['pcb', 'mlb', 'layout', '820-'], confidence: 0.85, icon: 'üîß' },
      { name: 'Schematic Diagram', keywords: ['schematic', 'schemitc', 'diagram'], confidence: 0.80, icon: 'üìã' }
    ];

    // Sayfa y√ºklendiƒüinde
    document.addEventListener('DOMContentLoaded', function() {
      loadTheme();
      checkConnection();
      showStatusPanel();
      
      // Ba≈ülangƒ±√ßta modelleri y√ºkle
      setTimeout(refreshModels, 1000);
    });

    // Tema i≈ülemleri
    function loadTheme() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      state.currentTheme = savedTheme;
      document.body.setAttribute('data-theme', state.currentTheme);
      document.querySelector('.theme-toggle').textContent = state.currentTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
    }

    function toggleTheme() {
      state.currentTheme = state.currentTheme === 'light' ? 'dark' : 'light';
      document.body.setAttribute('data-theme', state.currentTheme);
      document.querySelector('.theme-toggle').textContent = state.currentTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
      localStorage.setItem('theme', state.currentTheme);
      showToast(state.currentTheme === 'dark' ? 'üåô Karanlƒ±k mod aktif' : '‚òÄÔ∏è Aydƒ±nlƒ±k mod aktif');
    }

    // Baƒülantƒ± kontrol√º
    function checkConnection() {
      const statusEl = document.getElementById('connectionStatus');
      const textEl = document.getElementById('connectionText');
      
      updateStatus('Baƒülantƒ± kontrol ediliyor...');
      statusEl.className = 'connection-status loading';
      textEl.textContent = 'Baƒülantƒ± kontrol ediliyor...';
      
      // Sim√ºle edilmi≈ü baƒülantƒ± kontrol√º
      setTimeout(() => {
        // √ñnce PDF klas√∂r√ºn√º kontrol et
        checkPDFFolder()
          .then(() => {
            state.connectionStatus = 'online';
            statusEl.className = 'connection-status online';
            textEl.textContent = '‚úÖ Baƒülantƒ± ba≈üarƒ±lƒ±';
            updateStatus('PDF klas√∂r√ºne eri≈üim ba≈üarƒ±lƒ±');
          })
          .catch(error => {
            state.connectionStatus = 'offline';
            statusEl.className = 'connection-status offline';
            textEl.textContent = '‚ùå PDF klas√∂r√º yok';
            updateStatus('PDF klas√∂r√ºne eri≈üilemedi: ' + error.message);
            showToast('PDF klas√∂r√º bulunamadƒ±. "pdf" adƒ±nda bir klas√∂r olu≈üturun.', 'error');
          });
      }, 1000);
    }

    // PDF klas√∂r√ºn√º kontrol et
    function checkPDFFolder() {
      return new Promise((resolve, reject) => {
        fetch('pdf/')
          .then(response => {
            if (response.status === 404) {
              reject(new Error('PDF klas√∂r√º bulunamadƒ±'));
            } else {
              resolve();
            }
          })
          .catch(error => reject(error));
      });
    }

    // Modelleri yenile
    function refreshModels() {
      updateStatus('PDF dosyalarƒ± taranƒ±yor...');
      showLoading('PDF klas√∂r√º taranƒ±yor...');
      
      // PDF klas√∂r√ºnden dosya listesini al
      fetch('pdf/')
        .then(response => {
          if (!response.ok) throw new Error('PDF klas√∂r√ºne eri≈üilemedi');
          return response.text();
        })
        .then(html => {
          // HTML'den PDF dosyalarƒ±nƒ± √ßƒ±kar
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const links = doc.querySelectorAll('a[href$=".pdf"]');
          const pdfFiles = Array.from(links).map(link => link.href.split('/').pop());
          
          if (pdfFiles.length === 0) {
            throw new Error('PDF klas√∂r√ºnde dosya bulunamadƒ±');
          }
          
          state.models = pdfFiles.map(file => ({
            fileName: file,
            displayName: file,
            url: `pdf/${file}`,
            status: 'pending',
            matches: [],
            error: null,
            scanned: false
          }));
          
          updateStatus(`${state.models.length} PDF dosyasƒ± bulundu`);
          showToast(`üìÑ ${state.models.length} PDF dosyasƒ± bulundu`, 'success');
          
          const statusEl = document.getElementById('connectionStatus');
          const textEl = document.getElementById('connectionText');
          state.connectionStatus = 'online';
          statusEl.className = 'connection-status online';
          textEl.textContent = `‚úÖ ${state.models.length} PDF bulundu`;
          
          analyzeModels();
        })
        .catch(error => {
          console.error('PDF klas√∂r√º hatasƒ±:', error);
          updateStatus('PDF klas√∂r√º hatasƒ±: ' + error.message);
          showToast('‚ùå PDF klas√∂r√ºne eri≈üilemedi', 'error');
          
          // Demo modunu etkinle≈ütir
          activateDemoMode();
        })
        .finally(() => {
          document.getElementById('modelsCount').textContent = state.models.length;
        });
    }

    // Demo modu
    function activateDemoMode() {
      const statusEl = document.getElementById('connectionStatus');
      const textEl = document.getElementById('connectionText');
      
      state.connectionStatus = 'online';
      statusEl.className = 'connection-status online';
      textEl.textContent = 'üéÆ Demo Modu';
      updateStatus('Demo modu aktif - Ger√ßek PDF dosyalarƒ± bulunamadƒ±');
      showToast('‚ö†Ô∏è Demo modu aktif. PDF klas√∂r√ºne "pdf" adƒ±nda bir klas√∂r olu≈üturun.', 'warning');
      
      // Demo PDF'leri olu≈ütur
      const demoFiles = [
        'iPhone5_schematic.pdf',
        'iPhone6_repair_guide.pdf',
        'iPhone7_circuit_diagram.pdf',
        'iPad_Air_schematic.pdf',
        'iPad_mini_layout.pdf'
      ];
      
      state.models = demoFiles.map(file => ({
        fileName: file,
        displayName: file,
        url: `#demo-${file}`,
        status: 'pending',
        matches: [],
        error: null,
        scanned: false
      }));
      
      document.getElementById('modelsCount').textContent = state.models.length;
      analyzeModels();
    }

    // Modelleri analiz et
    function analyzeModels() {
      if (state.models.length === 0) {
        showToast('‚ùå Analiz edilecek PDF bulunamadƒ±', 'error');
        hideLoading();
        return;
      }
      
      updateStatus('AI model analizi ba≈ülatƒ±lƒ±yor...');
      showLoading('AI ile model t√ºrleri analiz ediliyor...');
      
      // Sim√ºle edilmi≈ü AI analizi
      setTimeout(() => {
        state.models = state.models.map(model => {
          const fileName = model.fileName.toLowerCase();
          let detectedModel = null;
          let confidence = 0;
          
          // Model e≈üle≈ütirme
          for (const phoneModel of phoneModels) {
            for (const keyword of phoneModel.keywords) {
              if (fileName.includes(keyword.toLowerCase())) {
                if (phoneModel.confidence > confidence) {
                  detectedModel = phoneModel;
                  confidence = phoneModel.confidence;
                }
              }
            }
          }
          
          return {
            ...model,
            modelType: detectedModel ? detectedModel.name : 'Bilinmeyen Model',
            confidence: detectedModel ? detectedModel.confidence : 0.1,
            icon: detectedModel ? detectedModel.icon : '‚ùì',
            aiDetected: !!detectedModel
          };
        });
        
        displayModels();
        hideLoading();
        updateStatus('Model analizi tamamlandƒ±');
        showToast('ü§ñ AI analizi tamamlandƒ±', 'success');
      }, 2000);
    }

    // Modelleri g√∂r√ºnt√ºle
    function displayModels() {
      const grid = document.getElementById('modelsGrid');
      grid.innerHTML = '';
      
      if (state.models.length === 0) {
        grid.innerHTML = `
          <div style="grid-column: 1/-1; text-align: center; padding: 2rem; color: var(--text); opacity: 0.6;">
            <div style="font-size: 3rem; margin-bottom: 1rem;">üìÇ</div>
            <h3>Hen√ºz model bulunamadƒ±</h3>
            <p>"Modelleri Yenile" butonuna tƒ±klayƒ±n</p>
          </div>
        `;
        return;
      }
      
      state.models.forEach((model, index) => {
        const card = createModelCard(model, index);
        grid.appendChild(card);
      });
      
      document.getElementById('modelsCount').textContent = state.models.length;
    }

    // Model kartƒ± olu≈ütur
    function createModelCard(model, index) {
      const card = document.createElement('div');
      card.className = 'model-card';
      card.id = `model-${index}`;
      
      const confidenceColor = model.confidence > 0.8 ? 'var(--success)' : 
                            model.confidence > 0.5 ? 'var(--warning)' : 'var(--error)';
      
      card.innerHTML = `
        <div class="model-header">
          <div class="model-name">
            ${model.icon} ${model.modelType}
          </div>
          ${model.aiDetected ? `
            <div class="model-confidence" style="background: ${confidenceColor}">
              ${Math.round(model.confidence * 100)}%
            </div>
          ` : ''}
        </div>
        
        <div style="font-size: 0.9rem; opacity: 0.7; margin-bottom: 0.5rem;">
          üìÑ ${model.fileName}
        </div>
        
        <div class="model-status">
          <div class="status-icon" id="status-icon-${index}">‚è≥</div>
          <div class="status-text" id="status-text-${index}">Tarama bekleniyor</div>
        </div>
        
        <div class="model-matches" id="matches-${index}" style="display: none;">
          <div class="matches-header">üéØ Bulunan Deƒüerler:</div>
          <div class="matches-list" id="matches-list-${index}"></div>
        </div>
        
        <button class="model-link" id="link-${index}" onclick="openModelPDF(${index})">
          üìñ PDF'i A√ß
        </button>
      `;
      
      return card;
    }

    // Tarama i≈ülemini ba≈ülat
    async function startIntelligentScan() {
      if (state.isScanning) {
        showToast('‚ö†Ô∏è Tarama zaten devam ediyor', 'warning');
        return;
      }

      if (state.models.length === 0) {
        showToast('‚ùå Taranacak PDF bulunamadƒ±', 'error');
        return;
      }

      const minVal = parseInt(document.getElementById('minVal').value);
      const maxVal = parseInt(document.getElementById('maxVal').value);
      const scanMode = document.getElementById('scanMode').value;

      if (!minVal || !maxVal || minVal >= maxVal) {
        showToast('‚ùå Ge√ßerli deƒüer aralƒ±ƒüƒ± girin', 'error');
        return;
      }

      state.isScanning = true;
      state.scanProgress = 0;
      
      document.getElementById('scanBtn').disabled = true;
      document.getElementById('scanBtn').textContent = 'üîÑ Tarama devam ediyor...';
      
      updateStatus(`${scanMode} tarama ba≈ülatƒ±lƒ±yor (${minVal}Œ© - ${maxVal}Œ©)`);
      showStatusPanel();

      try {
        if (scanMode === 'sequential') {
          await sequentialScan(minVal, maxVal);
        } else if (scanMode === 'parallel') {
          await parallelScan(minVal, maxVal);
        } else {
          await smartScan(minVal, maxVal);
        }
      } catch (error) {
        console.error('Tarama hatasƒ±:', error);
        showToast('‚ùå Tarama hatasƒ±: ' + error.message, 'error');
      } finally {
        state.isScanning = false;
        document.getElementById('scanBtn').disabled = false;
        document.getElementById('scanBtn').textContent = 'üöÄ Tarama Ba≈ülat';
        
        const totalFound = state.models.reduce((acc, m) => acc + m.matches.length, 0);
        const scannedCount = state.models.filter(m => m.scanned).length;
        updateStatus(`Tarama tamamlandƒ±: ${scannedCount} dosya, ${totalFound} e≈üle≈üme`);
        showToast(`üéâ Tarama tamamlandƒ±: ${totalFound} e≈üle≈üme`, 'success');
      }
    }

    // Sƒ±ralƒ± tarama
    async function sequentialScan(minVal, maxVal) {
      updateStatus('Sƒ±ralƒ± tarama ba≈üladƒ±');
      
      for (let i = 0; i < state.models.length; i++) {
        if (!state.isScanning) break;
        
        await scanModel(i, minVal, maxVal);
        state.scanProgress = ((i + 1) / state.models.length) * 100;
        updateProgress();
        
        await new Promise(resolve => setTimeout(resolve, 300));
      }
    }

    // Paralel tarama
    async function parallelScan(minVal, maxVal) {
      updateStatus('Paralel tarama ba≈üladƒ±');
      
      const promises = state.models.map((model, index) => 
        scanModel(index, minVal, maxVal)
      );
      
      await Promise.all(promises);
      state.scanProgress = 100;
      updateProgress();
    }

    // Akƒ±llƒ± tarama
    async function smartScan(minVal, maxVal) {
      updateStatus('Akƒ±llƒ± tarama ba≈üladƒ±');
      
      // Y√ºksek confidence √∂ncelikli
      const sortedIndexes = state.models
        .map((model, index) => ({ index, confidence: model.confidence || 0 }))
        .sort((a, b) => b.confidence - a.confidence)
        .map(item => item.index);
      
      for (let i = 0; i < sortedIndexes.length; i++) {
        if (!state.isScanning) break;
        
        const modelIndex = sortedIndexes[i];
        await scanModel(modelIndex, minVal, maxVal);
        state.scanProgress = ((i + 1) / sortedIndexes.length) * 100;
        updateProgress();
        
        await new Promise(resolve => setTimeout(resolve, 200));
      }
    }

    // Tek bir modeli tara
    async function scanModel(index, minVal, maxVal) {
      const model = state.models[index];
      const card = document.getElementById(`model-${index}`);
      const statusIcon = document.getElementById(`status-icon-${index}`);
      const statusText = document.getElementById(`status-text-${index}`);
      
      // Tarama durumunu g√ºncelle
      card.classList.add('scanning');
      statusIcon.textContent = 'üîÑ';
      statusText.textContent = 'PDF hazƒ±rlanƒ±yor...';
      
      updateStatus(`${model.modelType} taranƒ±yor...`);
      updateCounts();
      
      try {
        let matches = [];
        
        // Demo PDF ise sim√ºle edilmi≈ü sonu√ßlar √ºret
        if (model.url.startsWith('#demo')) {
          statusText.textContent = 'Demo veri olu≈üturuluyor...';
          await new Promise(resolve => setTimeout(resolve, 1000));
          matches = generateDemoMatches(minVal, maxVal, model.modelType);
        } else {
          // Ger√ßek PDF'i i≈üle
          statusText.textContent = 'PDF indiriliyor...';
          const response = await fetch(model.url);
          
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: Dosya bulunamadƒ±`);
          }
          
          statusText.textContent = 'PDF analiz ediliyor...';
          const arrayBuffer = await response.arrayBuffer();
          const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
          
          let fullText = '';
          statusText.textContent = `${pdf.numPages} sayfa i≈üleniyor...`;
          
          // T√ºm sayfalarƒ± oku
          for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            const content = await page.getTextContent();
            const strings = content.items.map(item => item.str).join(' ');
            fullText += strings + '\n';
            
            statusText.textContent = `Sayfa ${i}/${pdf.numPages} i≈üleniyor...`;
          }

          // Diren√ß deƒüerlerini bul
          statusText.textContent = 'Diren√ß deƒüerleri aranƒ±yor...';
          matches = findResistorValues(fullText, minVal, maxVal);
        }
        
        // Sonu√ßlarƒ± kaydet
        model.matches = matches;
        model.scanned = true;
        model.status = matches.length > 0 ? 'found' : 'no-match';
        
        // UI g√ºncelleme
        card.classList.remove('scanning');
        
        if (matches.length > 0) {
          card.classList.add('found');
          statusIcon.textContent = '‚úÖ';
          statusText.textContent = `${matches.length} deƒüer bulundu`;
          
          // E≈üle≈ümeleri g√∂ster
          const matchesDiv = document.getElementById(`matches-${index}`);
          const matchesList = document.getElementById(`matches-list-${index}`);
          
          matchesList.innerHTML = matches.map(match => 
            `<span class="match-tag">‚ö° ${match}Œ©</span>`
          ).join('');
          
          matchesDiv.style.display = 'block';
          
          // PDF a√ßma baƒülantƒ±sƒ±nƒ± etkinle≈ütir
          const link = document.getElementById(`link-${index}`);
          link.style.display = 'inline-block';
          
          updateStatus(`${model.fileName}: ${matches.length} e≈üle≈üme bulundu`);
        } else {
          card.classList.add('no-match');
          statusIcon.textContent = '‚ùå';
          statusText.textContent = 'E≈üle≈üme bulunamadƒ±';
          updateStatus(`${model.fileName}: E≈üle≈üme bulunamadƒ±`);
        }
      } catch (error) {
        model.error = error.message;
        model.status = 'error';
        
        card.classList.remove('scanning');
        card.classList.add('error');
        statusIcon.textContent = '‚ö†Ô∏è';
        statusText.textContent = 'Hata: ' + error.message;
        
        updateStatus(`${model.fileName}: Hata - ${error.message}`);
      }
      
      updateCounts();
    }

    // PDF metninden diren√ß deƒüerlerini bul
    function findResistorValues(text, minVal, maxVal) {
      const matches = [];
      const patterns = [
        /\b(\d+(?:\.\d+)?)\s*([kKmM]?)\s*[Œ©œâ]\b/g,  // 330KŒ©, 1.5MŒ©
        /\b(\d+(?:\.\d+)?)\s*([kKmM]?)\s*[Oo]hm[s]?\b/g,  // 330 Ohm, 1.5K Ohms
        /\b(\d+(?:\.\d+)?)\s*([kKmM]?)\s*[Rr]\b/g   // 330R, 1.5KR
      ];
      
      patterns.forEach(regex => {
        let match;
        while ((match = regex.exec(text)) !== null) {
          let value = parseFloat(match[1]);
          const unit = match[2].toUpperCase();
          
          // Birim d√∂n√º≈ü√ºm√º
          if (unit === 'K') value *= 1000;
          if (unit === 'M') value *= 1000000;
          
          // Aralƒ±k kontrol√º
          if (value >= minVal && value <= maxVal) {
            let displayValue;
            if (value >= 1000000) {
              displayValue = (value / 1000000).toFixed(1) + 'M';
            } else if (value >= 1000) {
              displayValue = (value / 1000).toFixed(1) + 'K';
            } else {
              displayValue = Math.round(value).toString();
            }
            
            if (!matches.includes(displayValue)) {
              matches.push(displayValue);
            }
          }
        }
      });
      
      return matches;
    }

    // Demo i√ßin rastgele e≈üle≈ümeler √ºret
    function generateDemoMatches(minVal, maxVal, modelType) {
      // Bazƒ± modellerde daha fazla e≈üle≈üme olma ihtimali
      const probability = modelType.includes('Schematic') ? 0.8 : 
                        modelType.includes('Layout') ? 0.7 : 0.5;
      
      if (Math.random() > probability) return [];
      
      const matchCount = Math.floor(Math.random() * 5) + 1;
      const matches = [];
      
      for (let i = 0; i < matchCount; i++) {
        const value = minVal + Math.random() * (maxVal - minVal);
        let displayValue;
        
        if (value >= 1000000) {
          displayValue = (value / 1000000).toFixed(1) + 'M';
        } else if (value >= 1000) {
          displayValue = (value / 1000).toFixed(1) + 'K';
        } else {
          displayValue = Math.round(value).toString();
        }
        
        matches.push(displayValue);
      }
      
      return [...new Set(matches)];
    }

    // Taramayƒ± durdur
    function stopScan() {
      if (!state.isScanning) {
        showToast('‚ùå Aktif tarama yok', 'warning');
        return;
      }
      
      state.isScanning = false;
      updateStatus('Tarama durduruldu');
      showToast('‚èπÔ∏è Tarama durduruldu', 'warning');
    }

    // PDF a√ß
    function openModelPDF(index) {
      const model = state.models[index];
      
      if (model.status === 'error') {
        showToast('‚ùå Bu dosyada hata var', 'error');
        return;
      }
      
      if (model.url.startsWith('#demo')) {
        // Demo PDF
        showToast(`üéÆ Demo: ${model.fileName} - ${model.matches.length} e≈üle≈üme`, 'info');
        
        // Demo bilgi penceresi
        const infoWindow = window.open('', '_blank', 'width=600,height=400');
        infoWindow.document.write(`
          <html>
            <head><title>Demo PDF - ${model.fileName}</title></head>
            <body style="font-family: Arial; padding: 20px;">
              <h2>üìÑ ${model.fileName}</h2>
              <h3>üéØ Bulunan Diren√ß Deƒüerleri:</h3>
              <div style="display: flex; flex-wrap: wrap; gap: 10px; margin: 20px 0;">
                ${model.matches.map(match => `
                  <span style="background: #4361ee; color: white; padding: 8px 12px; border-radius: 15px;">
                    ‚ö° ${match}Œ©
                  </span>
                `).join('')}
              </div>
              <p style="color: #666;">Bu bir demo PDF'dir. Ger√ßek dosyalar i√ßin "pdf" klas√∂r√º olu≈üturun.</p>
            </body>
          </html>
        `);
      } else {
        // Ger√ßek PDF
        window.open(model.url, '_blank');
        showToast(`üìñ ${model.fileName} a√ßƒ±lƒ±yor...`, 'success');
      }
    }

    // Durum g√ºncelleme fonksiyonlarƒ±
    function updateStatus(message) {
      document.getElementById('currentStatus').textContent = message;
      const statusContent = document.getElementById('statusContent');
      statusContent.scrollTop = statusContent.scrollHeight;
    }

    function updateProgress() {
      document.getElementById('statusProgress').style.width = state.scanProgress + '%';
    }

    function updateCounts() {
      const processed = state.models.filter(m => m.scanned).length;
      const found = state.models.reduce((acc, m) => acc + m.matches.length, 0);
      const errors = state.models.filter(m => m.error).length;
      
      document.getElementById('processedCount').textContent = `${processed}/${state.models.length}`;
      document.getElementById('foundCount').textContent = found;
      document.getElementById('errorCount').textContent = errors;
    }

    function showStatusPanel() {
      state.statusPanelVisible = true;
      document.getElementById('statusPanel').classList.add('show');
    }

    function hideStatusPanel() {
      state.statusPanelVisible = false;
      document.getElementById('statusPanel').classList.remove('show');
    }

    function toggleStatusPanel() {
      state.statusPanelVisible ? hideStatusPanel() : showStatusPanel();
    }

    function showLoading(text = 'Y√ºkleniyor...') {
      document.getElementById('loadingText').textContent = text;
      document.getElementById('loadingOverlay').style.display = 'flex';
    }

    function hideLoading() {
      document.getElementById('loadingOverlay').style.display = 'none';
    }

    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      
      document.body.appendChild(toast);
      setTimeout(() => toast.classList.add('show'), 100);
      
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
      }, 4000);
    }

    // Klavye kƒ±sayollarƒ±
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey || e.metaKey) {
        switch(e.key) {
          case 'Enter':
            if (!state.isScanning) startIntelligentScan();
            break;
          case 's':
            if (state.isScanning) stopScan();
            break;
          case 'r':
            refreshModels();
            break;
          case 'd':
            toggleTheme();
            break;
          case 'm':
            toggleStatusPanel();
            break;
        }
      }
    });
  </script>
</body>
</html>
