<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProSignal Bot - Advanced Trading Assistant</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #0f172a;
            --card-bg: #1e293b;
            --border: #334155;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --success: #22c55e;
            --gradient: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            --gradient-success: linear-gradient(135deg, #10b981 0%, #22c55e 100%);
            --gradient-danger: linear-gradient(135deg, #ef4444 0%, #f97316 100%);
            --gradient-warning: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark);
            color: var(--text-primary);
            overflow-x: hidden;
            line-height: 1.6;
        }

        .background-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            z-index: -1;
            animation: backgroundPulse 15s ease-in-out infinite;
        }

        @keyframes backgroundPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Header */
        .header {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
        }

        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .status-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid var(--border);
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--danger);
            animation: pulse 2s infinite;
        }

        .status-dot.online {
            background: var(--success);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-start {
            background: var(--gradient-success);
            color: white;
        }

        .btn-stop {
            background: var(--gradient-danger);
            color: white;
        }

        .control-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Navigation */
        .navigation {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 73px;
            z-index: 99;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1.5rem;
            overflow-x: auto;
        }

        .nav-tabs {
            display: flex;
        }

        .nav-tab {
            padding: 16px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            color: var(--text-primary);
            background: rgba(59, 130, 246, 0.1);
        }

        .nav-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(59, 130, 246, 0.1);
        }

        /* Main Content */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Grid System */
        .grid {
            display: grid;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .grid-cols-1 { grid-template-columns: 1fr; }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-cols-4 { grid-template-columns: repeat(4, 1fr); }

        @media (max-width: 1024px) {
            .grid-cols-4 { grid-template-columns: repeat(2, 1fr); }
            .grid-cols-3 { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 640px) {
            .grid-cols-4,
            .grid-cols-3,
            .grid-cols-2 { grid-template-columns: 1fr; }
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            border-color: var(--primary);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-title i {
            color: var(--primary);
        }

        /* Price Display */
        .price-section {
            text-align: center;
            padding: 1rem 0;
        }

        .current-price {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        .price-change {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .price-up { color: var(--success); }
        .price-down { color: var(--danger); }

        /* Order Book */
        .orderbook {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
        }

        .orderbook-header {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            padding: 8px;
            background: rgba(51, 65, 85, 0.5);
            border-radius: 6px;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .orderbook-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            padding: 6px 8px;
            border-radius: 4px;
            margin-bottom: 1px;
            transition: background 0.2s ease;
        }

        .orderbook-row:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .asks-section .orderbook-row {
            background: linear-gradient(90deg, rgba(239, 68, 68, 0.1) 0%, transparent 100%);
            border-left: 2px solid var(--danger);
        }

        .bids-section .orderbook-row {
            background: linear-gradient(90deg, transparent 0%, rgba(34, 197, 94, 0.1) 100%);
            border-right: 2px solid var(--success);
        }

        .spread-display {
            text-align: center;
            padding: 8px;
            margin: 8px 0;
            background: linear-gradient(90deg, var(--danger), var(--success));
            border-radius: 6px;
            font-weight: 600;
            color: white;
            font-size: 0.9rem;
        }

        /* Signals */
        .signal {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .signal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .signal-buy::before {
            background: var(--success);
        }

        .signal-sell::before {
            background: var(--danger);
        }

        .signal-hit-tp1::before {
            background: var(--success);
            animation: pulseSuccess 2s infinite;
        }

        .signal-hit-tp2::before {
            background: var(--success);
            animation: pulseSuccessFast 1.5s infinite;
        }

        .signal-hit-sl::before {
            background: var(--danger);
            animation: pulseDanger 2s infinite;
        }

        @keyframes pulseSuccess {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes pulseSuccessFast {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes pulseDanger {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .signal:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .signal-type {
            padding: 6px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        .signal-type.buy {
            background: var(--gradient-success);
            color: white;
        }

        .signal-type.sell {
            background: var(--gradient-danger);
            color: white;
        }

        .signal-time {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .signal-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .signal-detail {
            text-align: center;
            padding: 10px;
            background: rgba(51, 65, 85, 0.3);
            border-radius: 6px;
            position: relative;
        }

        .signal-detail.hit {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid var(--success);
        }

        .signal-detail.miss {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
        }

        .signal-detail-label {
            color: var(--text-secondary);
            font-size: 0.75rem;
            margin-bottom: 4px;
            text-transform: uppercase;
            font-weight: 500;
        }

        .signal-detail-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .signal-score {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: rgba(51, 65, 85, 0.3);
            border-radius: 6px;
            margin-top: 0.5rem;
        }

        .score-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .score-value {
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 12px;
        }

        .score-high {
            background: rgba(34, 197, 94, 0.2);
            color: var(--success);
        }

        .score-medium {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .score-low {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .signal-result {
            margin-top: 0.75rem;
            padding: 8px;
            border-radius: 6px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .result-success {
            background: rgba(34, 197, 94, 0.1);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .result-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .result-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        /* Statistics */
        .stat-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1.25rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            border-color: var(--primary);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 0.5rem 0;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-transform: uppercase;
            font-weight: 500;
        }

        /* Progress Bars */
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(51, 65, 85, 0.5);
            border-radius: 4px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-success {
            background: var(--gradient-success);
        }

        .progress-warning {
            background: var(--gradient-warning);
        }

        .progress-danger {
            background: var(--gradient-danger);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            background: rgba(51, 65, 85, 0.5);
            border: 1px solid var(--border);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-danger {
            background: var(--gradient-danger);
            color: white;
        }

        .btn-success {
            background: var(--gradient-success);
            color: white;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn-block {
            width: 100%;
            justify-content: center;
        }

        /* Loading & Empty States */
        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.6;
        }

        /* Alerts */
        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid;
            animation: slideInRight 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .alert-success {
            background: rgba(34, 197, 94, 0.1);
            border-color: var(--success);
            color: var(--success);
        }

        .alert-danger {
            background: rgba(239, 68, 68, 0.1);
            border-color: var(--danger);
            color: var(--danger);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--warning);
            color: var(--warning);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .status-controls {
                width: 100%;
                justify-content: space-between;
            }

            .current-price {
                font-size: 2rem;
            }

            .signal-details {
                grid-template-columns: repeat(2, 1fr);
            }

            .nav-tabs {
                justify-content: space-between;
            }

            .nav-tab {
                padding: 12px 16px;
                font-size: 0.9rem;
            }

            .signal-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .signal-type {
                align-self: flex-start;
            }
        }

        /* Floating Notifications */
        .notifications-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            max-width: 400px;
            width: 90%;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--card-bg);
            color: var(--text-primary);
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid var(--border);
            font-size: 0.8rem;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="background-effect"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="logo-text">
                    <h1>ProSignal Bot</h1>
                </div>
            </div>
            
            <div class="status-controls">
                <div id="connection-status" class="connection-status">
                    <div class="status-dot" id="status-dot"></div>
                    <span id="status-text">Offline</span>
                </div>
                
                <button id="start-btn" class="control-btn btn-start">
                    <i class="fas fa-play"></i>
                    Start
                </button>
                
                <button id="stop-btn" class="control-btn btn-stop" disabled>
                    <i class="fas fa-stop"></i>
                    Stop
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="navigation">
        <div class="nav-container">
            <div class="nav-tabs">
                <div class="nav-tab active" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    Dashboard
                </div>
                <div class="nav-tab" data-tab="signals">
                    <i class="fas fa-bolt"></i>
                    Signals
                </div>
                <div class="nav-tab" data-tab="settings">
                    <i class="fas fa-cog"></i>
                    Settings
                </div>
                <div class="nav-tab" data-tab="analytics">
                    <i class="fas fa-chart-bar"></i>
                    Analytics
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="grid grid-cols-3">
                <!-- Price Monitor -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-coins"></i>
                            Price Monitor
                        </div>
                        <div id="symbol-display">BTC/USDT</div>
                    </div>
                    <div class="price-section">
                        <div id="current-price" class="current-price">$0.00</div>
                        <div id="price-change" class="price-change">
                            <i class="fas fa-minus"></i>
                            <span>0.00 (0.00%)</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 1rem;">
                        <div class="loading-spinner"></div>
                        <span id="ws-status" style="color: var(--text-secondary); font-size: 0.9rem;">Connecting...</span>
                    </div>
                </div>

                <!-- Order Book -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-layer-group"></i>
                            Order Book
                        </div>
                        <div id="spread-info">Spread: 0.00</div>
                    </div>
                    <div class="orderbook">
                        <div class="orderbook-header">
                            <div>Price</div>
                            <div>Amount</div>
                            <div>Total</div>
                        </div>
                        <div class="asks-section" id="asks-container">
                            <!-- Asks will be populated here -->
                        </div>
                        <div class="spread-display" id="spread-display">
                            Spread: $0.00
                        </div>
                        <div class="bids-section" id="bids-container">
                            <!-- Bids will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Latest Signal -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-bolt"></i>
                            Latest Signal
                        </div>
                        <div id="signal-count">0 signals</div>
                    </div>
                    <div id="latest-signal-container">
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <p>Scanning for opportunities...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Market Stats -->
            <div class="grid grid-cols-4">
                <div class="stat-card">
                    <div class="stat-label">24h Volume</div>
                    <div id="volume-24h" class="stat-value">$0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">RSI (14)</div>
                    <div id="rsi-value" class="stat-value">50.0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Success Rate</div>
                    <div id="success-rate" class="stat-value">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Signals</div>
                    <div id="total-signals-dash" class="stat-value">0</div>
                </div>
            </div>
        </div>

        <!-- Signals Tab -->
        <div id="signals" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-history"></i>
                        Signal History
                    </div>
                    <button id="clear-signals" class="btn btn-danger">
                        <i class="fas fa-trash"></i>
                        Clear All
                    </button>
                </div>
                <div id="signals-container">
                    <div class="empty-state">
                        <i class="fas fa-chart-line"></i>
                        <p>No signals generated yet</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="grid grid-cols-2">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-cog"></i>
                            Trading Configuration
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label class="form-label">Trading Pair</label>
                            <select id="trading-pair" class="form-control">
                                <option value="BTCUSDT">BTC/USDT</option>
                                <option value="ETHUSDT">ETH/USDT</option>
                                <option value="BNBUSDT">BNB/USDT</option>
                                <option value="ADAUSDT">ADA/USDT</option>
                                <option value="SOLUSDT">SOL/USDT</option>
                                <option value="DOTUSDT">DOT/USDT</option>
                                <option value="LINKUSDT">LINK/USDT</option>
                                <option value="XRPUSDT">XRP/USDT</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Minimum Profit (%)</label>
                            <input type="number" id="min-profit" class="form-control" value="0.15" step="0.01" min="0.01">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Maximum Risk (%)</label>
                            <input type="number" id="max-risk" class="form-control" value="0.5" step="0.01" min="0.01">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Volume Threshold</label>
                            <input type="number" id="volume-threshold" class="form-control" value="50000" step="1000">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Signal Cooldown (seconds)</label>
                            <input type="number" id="signal-cooldown" class="form-control" value="45" min="10" max="300">
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-target"></i>
                            Target & Risk Management
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label class="form-label">TP1 Ratio (%)</label>
                            <input type="number" id="tp1-ratio" class="form-control" value="40" min="10" max="90">
                        </div>
                        <div class="form-group">
                            <label class="form-label">TP2 Ratio (%)</label>
                            <input type="number" id="tp2-ratio" class="form-control" value="80" min="10" max="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Stop Loss Ratio (%)</label>
                            <input type="number" id="sl-ratio" class="form-control" value="30" min="10" max="50">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Max Daily Signals</label>
                            <input type="number" id="max-daily-signals" class="form-control" value="20" min="1" max="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Min Success Score</label>
                            <input type="number" id="min-success-score" class="form-control" value="70" min="50" max="95">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <button id="save-settings" class="btn btn-primary btn-block">
                    <i class="fas fa-save"></i>
                    Save Settings
                </button>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="grid grid-cols-4">
                <div class="stat-card">
                    <div class="stat-label">Total Signals</div>
                    <div id="total-signals" class="stat-value">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Successful Signals</div>
                    <div id="successful-signals" class="stat-value">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Average Profit</div>
                    <div id="avg-profit" class="stat-value">0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Win Rate</div>
                    <div id="win-rate" class="stat-value">0%</div>
                </div>
            </div>
            
            <div class="grid grid-cols-2">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-pie"></i>
                            Performance Overview
                        </div>
                    </div>
                    <div class="grid grid-cols-2">
                        <div class="stat-card">
                            <div class="stat-label">Best Signal</div>
                            <div id="best-signal" class="stat-value">0%</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Signals/Hour</div>
                            <div id="signals-per-hour" class="stat-value">0</div>
                        </div>
                    </div>
                    <div style="padding: 1rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>Signal Accuracy</span>
                            <span id="accuracy-percentage">0%</span>
                        </div>
                        <div class="progress-container">
                            <div id="accuracy-bar" class="progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-clock"></i>
                            Recent Activity
                        </div>
                    </div>
                    <div id="recent-activity">
                        <div class="empty-state">
                            <i class="fas fa-history"></i>
                            <p>No recent activity</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Notifications Container -->
    <div id="notifications-container" class="notifications-container"></div>

    <script>
        class ProSignalBot {
            constructor() {
                this.ws = null;
                this.isRunning = false;
                this.currentSymbol = 'BTCUSDT';
                this.currentPrice = 0;
                this.previousPrice = 0;
                this.orderBook = { bids: [], asks: [] };
                this.signals = [];
                this.lastSignalTime = 0;
                this.dailySignalCount = 0;
                this.priceHistory = [];
                this.settings = this.loadSettings();
                this.activeSignals = {};
                
                this.initializeApp();
            }

            loadSettings() {
                const defaultSettings = {
                    tradingPair: 'BTCUSDT',
                    minProfit: 0.15,
                    maxRisk: 0.5,
                    volumeThreshold: 50000,
                    signalCooldown: 45,
                    tp1Ratio: 40,
                    tp2Ratio: 80,
                    slRatio: 30,
                    maxDailySignals: 20,
                    minSuccessScore: 70
                };
                
                const saved = localStorage.getItem('prosignal-settings');
                return saved ? { ...defaultSettings, ...JSON.parse(saved) } : defaultSettings;
            }

            saveSettings() {
                localStorage.setItem('prosignal-settings', JSON.stringify(this.settings));
            }

            initializeApp() {
                this.setupEventListeners();
                this.loadSignalHistory();
                this.updateSettingsUI();
                this.updateUI();
                this.showNotification('ProSignal Bot initialized successfully!', 'success');
                
                // Request notification permission
                if ('Notification' in window && Notification.permission === 'default') {
                    setTimeout(() => Notification.requestPermission(), 2000);
                }
            }

            setupEventListeners() {
                // Navigation tabs
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.dataset.tab;
                        this.switchTab(tabId);
                    });
                });

                // Control buttons
                document.getElementById('start-btn').addEventListener('click', () => this.start());
                document.getElementById('stop-btn').addEventListener('click', () => this.stop());

                // Settings
                document.getElementById('save-settings').addEventListener('click', () => this.saveSettingsFromUI());
                document.getElementById('clear-signals').addEventListener('click', () => this.clearSignals());

                // Trading pair change
                document.getElementById('trading-pair').addEventListener('change', (e) => {
                    this.currentSymbol = e.target.value;
                    document.getElementById('symbol-display').textContent = this.formatSymbol(this.currentSymbol);
                    if (this.isRunning) {
                        this.reconnect();
                    }
                });
            }

            switchTab(tabId) {
                // Remove active class from all tabs and contents
                document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // Add active class to selected tab and content
                document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
                document.getElementById(tabId).classList.add('active');
            }

            start() {
                if (this.isRunning) return;
                
                this.isRunning = true;
                this.connectWebSocket();
                this.updateControlButtons();
                this.showNotification('Bot started successfully!', 'success');
            }

            stop() {
                if (!this.isRunning) return;
                
                this.isRunning = false;
                this.disconnectWebSocket();
                this.updateControlButtons();
                this.updateConnectionStatus(false);
                this.showNotification('Bot stopped.', 'warning');
            }

            connectWebSocket() {
                const symbol = this.currentSymbol.toLowerCase();
                const wsUrl = `wss://stream.binance.com:9443/ws/${symbol}@ticker/${symbol}@depth10@100ms`;
                
                try {
                    this.ws = new WebSocket(wsUrl);
                    
                    this.ws.onopen = () => {
                        this.updateConnectionStatus(true);
                        document.getElementById('ws-status').textContent = 'Connected to live data';
                        this.showNotification('Connected to live market data!', 'success');
                    };
                    
                    this.ws.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        this.handleMarketData(data);
                    };
                    
                    this.ws.onclose = () => {
                        this.updateConnectionStatus(false);
                        if (this.isRunning) {
                            setTimeout(() => this.reconnect(), 5000);
                        }
                    };
                    
                    this.ws.onerror = () => {
                        this.showNotification('Connection error. Attempting to reconnect...', 'danger');
                    };
                    
                } catch (error) {
                    this.showNotification('Failed to connect to market data.', 'danger');
                }
            }

            handleMarketData(data) {
                if (data.e === '24hrTicker') {
                    this.updatePriceData(data);
                } else if (data.e === 'depthUpdate' || data.bids) {
                    this.updateOrderBook(data);
                }
                
                if (this.isRunning) {
                    this.analyzeForSignals();
                    this.checkActiveSignals();
                }
            }

            updatePriceData(data) {
                this.previousPrice = this.currentPrice;
                this.currentPrice = parseFloat(data.c);
                
                const change = parseFloat(data.c) - parseFloat(data.o);
                const changePercent = parseFloat(data.P);
                
                document.getElementById('current-price').textContent = `${this.formatPrice(this.currentPrice)}`;
                
                const priceChangeEl = document.getElementById('price-change');
                const isPositive = change >= 0;
                priceChangeEl.className = `price-change ${isPositive ? 'price-up' : 'price-down'}`;
                priceChangeEl.innerHTML = `
                    <i class="fas fa-${isPositive ? 'arrow-up' : 'arrow-down'}"></i>
                    <span>${isPositive ? '+' : ''}${this.formatPrice(change)} (${isPositive ? '+' : ''}${changePercent.toFixed(2)}%)</span>
                `;
                
                // Update volume
                const volume = parseFloat(data.q);
                document.getElementById('volume-24h').textContent = this.formatVolume(volume);
                
                // Store price history
                this.priceHistory.push({
                    timestamp: Date.now(),
                    price: this.currentPrice
                });
                
                if (this.priceHistory.length > 200) {
                    this.priceHistory = this.priceHistory.slice(-200);
                }
                
                this.updateTechnicalIndicators();
            }

            updateOrderBook(data) {
                if (data.bids && data.asks) {
                    this.orderBook.bids = data.bids.slice(0, 5).map(([price, qty]) => [parseFloat(price), parseFloat(qty)]);
                    this.orderBook.asks = data.asks.slice(0, 5).map(([price, qty]) => [parseFloat(price), parseFloat(qty)]);
                    
                    this.renderOrderBook();
                    this.updateSpreadInfo();
                }
            }

            renderOrderBook() {
                const asksContainer = document.getElementById('asks-container');
                const bidsContainer = document.getElementById('bids-container');
                
                // Render asks (sell orders)
                asksContainer.innerHTML = this.orderBook.asks
                    .reverse()
                    .map(([price, qty]) => `
                        <div class="orderbook-row">
                            <div>${this.formatPrice(price)}</div>
                            <div>${qty.toFixed(4)}</div>
                            <div>${this.formatPrice(price * qty)}</div>
                        </div>
                    `).join('');
                
                // Render bids (buy orders)
                bidsContainer.innerHTML = this.orderBook.bids
                    .map(([price, qty]) => `
                        <div class="orderbook-row">
                            <div>${this.formatPrice(price)}</div>
                            <div>${qty.toFixed(4)}</div>
                            <div>${this.formatPrice(price * qty)}</div>
                        </div>
                    `).join('');
            }

            updateSpreadInfo() {
                if (this.orderBook.asks.length > 0 && this.orderBook.bids.length > 0) {
                    const bestAsk = this.orderBook.asks[0][0];
                    const bestBid = this.orderBook.bids[0][0];
                    const spread = bestAsk - bestBid;
                    const spreadPercent = (spread / bestBid) * 100;
                    
                    document.getElementById('spread-info').textContent = `Spread: ${this.formatPrice(spread)} (${spreadPercent.toFixed(3)}%)`;
                    document.getElementById('spread-display').textContent = `Spread: ${this.formatPrice(spread)}`;
                }
            }

            analyzeForSignals() {
                const now = Date.now();
                if (now - this.lastSignalTime < this.settings.signalCooldown * 1000) return;
                if (this.dailySignalCount >= this.settings.maxDailySignals) return;
                
                const signal = this.generateSignal();
                if (signal && signal.successScore >= this.settings.minSuccessScore) {
                    this.addSignal(signal);
                    this.lastSignalTime = now;
                    this.dailySignalCount++;
                }
            }

            generateSignal() {
                if (this.orderBook.bids.length === 0 || this.orderBook.asks.length === 0) return null;
                
                const bidVolume = this.orderBook.bids.reduce((sum, [p, q]) => sum + (p * q), 0);
                const askVolume = this.orderBook.asks.reduce((sum, [p, q]) => sum + (p * q), 0);
                const volumeRatio = bidVolume / askVolume;
                
                const rsi = this.calculateRSI();
                let signal = null;
                let successScore = 50;
                
                // Buy signal conditions
                if (volumeRatio > 1.3 && rsi < 45) {
                    const entryPrice = this.currentPrice;
                    const profitAmount = entryPrice * (this.settings.minProfit / 100);
                    const tp1 = entryPrice + (profitAmount * this.settings.tp1Ratio / 100);
                    const tp2 = entryPrice + (profitAmount * this.settings.tp2Ratio / 100);
                    const stopLoss = entryPrice - (entryPrice * this.settings.slRatio / 100);
                    
                    successScore = Math.min(95, 60 + (volumeRatio - 1) * 15 + (45 - rsi));
                    
                    signal = {
                        id: this.generateId(),
                        type: 'BUY',
                        timestamp: new Date().toISOString(),
                        entryPrice: entryPrice,
                        tp1: tp1,
                        tp2: tp2,
                        stopLoss: stopLoss,
                        successScore: Math.round(successScore),
                        reason: `Strong bid support. Volume ratio: ${volumeRatio.toFixed(2)}, RSI: ${rsi.toFixed(1)}`,
                        symbol: this.currentSymbol,
                        status: 'active',
                        hitTp1: false,
                        hitTp2: false,
                        hitSl: false
                    };
                }
                // Sell signal conditions
                else if (volumeRatio < 0.8 && rsi > 55) {
                    const entryPrice = this.currentPrice;
                    const profitAmount = entryPrice * (this.settings.minProfit / 100);
                    const tp1 = entryPrice - (profitAmount * this.settings.tp1Ratio / 100);
                    const tp2 = entryPrice - (profitAmount * this.settings.tp2Ratio / 100);
                    const stopLoss = entryPrice + (entryPrice * this.settings.slRatio / 100);
                    
                    successScore = Math.min(95, 60 + (1 - volumeRatio) * 20 + (rsi - 55));
                    
                    signal = {
                        id: this.generateId(),
                        type: 'SELL',
                        timestamp: new Date().toISOString(),
                        entryPrice: entryPrice,
                        tp1: tp1,
                        tp2: tp2,
                        stopLoss: stopLoss,
                        successScore: Math.round(successScore),
                        reason: `Strong ask pressure. Volume ratio: ${volumeRatio.toFixed(2)}, RSI: ${rsi.toFixed(1)}`,
                        symbol: this.currentSymbol,
                        status: 'active',
                        hitTp1: false,
                        hitTp2: false,
                        hitSl: false
                    };
                }
                
                return signal;
            }

            checkActiveSignals() {
                this.signals.forEach(signal => {
                    if (signal.status === 'active') {
                        if (signal.type === 'BUY') {
                            if (!signal.hitTp1 && this.currentPrice >= signal.tp1) {
                                signal.hitTp1 = true;
                                signal.result = 'TP1 Hit';
                                this.showNotification(`TP1 hit for ${signal.type} signal at ${this.formatPrice(signal.tp1)}`, 'success');
                            }
                            if (!signal.hitTp2 && this.currentPrice >= signal.tp2) {
                                signal.hitTp2 = true;
                                signal.status = 'completed';
                                signal.result = 'TP2 Hit';
                                this.showNotification(`TP2 hit for ${signal.type} signal at ${this.formatPrice(signal.tp2)}`, 'success');
                            }
                            if (!signal.hitSl && this.currentPrice <= signal.stopLoss) {
                                signal.hitSl = true;
                                signal.status = 'completed';
                                signal.result = 'SL Hit';
                                this.showNotification(`SL hit for ${signal.type} signal at ${this.formatPrice(signal.stopLoss)}`, 'danger');
                            }
                        } else { // SELL signal
                            if (!signal.hitTp1 && this.currentPrice <= signal.tp1) {
                                signal.hitTp1 = true;
                                signal.result = 'TP1 Hit';
                                this.showNotification(`TP1 hit for ${signal.type} signal at ${this.formatPrice(signal.tp1)}`, 'success');
                            }
                            if (!signal.hitTp2 && this.currentPrice <= signal.tp2) {
                                signal.hitTp2 = true;
                                signal.status = 'completed';
                                signal.result = 'TP2 Hit';
                                this.showNotification(`TP2 hit for ${signal.type} signal at ${this.formatPrice(signal.tp2)}`, 'success');
                            }
                            if (!signal.hitSl && this.currentPrice >= signal.stopLoss) {
                                signal.hitSl = true;
                                signal.status = 'completed';
                                signal.result = 'SL Hit';
                                this.showNotification(`SL hit for ${signal.type} signal at ${this.formatPrice(signal.stopLoss)}`, 'danger');
                            }
                        }
                    }
                });
                
                this.saveSignalHistory();
                this.renderSignalsHistory();
                this.updateAnalytics();
            }

            addSignal(signal) {
                this.signals.unshift(signal);
                this.saveSignalHistory();
                this.renderLatestSignal(signal);
                this.renderSignalsHistory();
                this.updateAnalytics();
                
                this.showNotification(`New ${signal.type} signal! Score: ${signal.successScore}%`, 'success');
                
                // Browser notification
                if (Notification.permission === 'granted') {
                    new Notification(`ProSignal Bot - ${signal.type} Signal`, {
                        body: `Entry: ${this.formatPrice(signal.entryPrice)} | Score: ${signal.successScore}%`,
                        icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzNiODJmNiIvPgo8cGF0aCBkPSJNMTYgOEwxOSAxNEgxM0wxNiA4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTE2IDI0TDEzIDE4SDE5TDE2IDI0WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+'
                    });
                }
            }

            renderLatestSignal(signal) {
                const container = document.getElementById('latest-signal-container');
                
                if (!signal) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <p>Scanning for opportunities...</p>
                        </div>
                    `;
                    return;
                }
                
                const tp1Class = signal.hitTp1 ? 'hit' : '';
                const tp2Class = signal.hitTp2 ? 'hit' : '';
                const slClass = signal.hitSl ? 'miss' : '';
                
                container.innerHTML = `
                    <div class="signal signal-${signal.type.toLowerCase()} ${signal.status === 'completed' ? 'signal-completed' : ''}">
                        <div class="signal-header">
                            <div class="signal-type ${signal.type.toLowerCase()}">${signal.type}</div>
                            <div class="signal-time">${new Date(signal.timestamp).toLocaleTimeString()}</div>
                        </div>
                        <div class="signal-details">
                            <div class="signal-detail">
                                <div class="signal-detail-label">Entry</div>
                                <div class="signal-detail-value">${this.formatPrice(signal.entryPrice)}</div>
                            </div>
                            <div class="signal-detail ${tp1Class}">
                                <div class="signal-detail-label">TP1</div>
                                <div class="signal-detail-value">${this.formatPrice(signal.tp1)}</div>
                            </div>
                            <div class="signal-detail ${tp2Class}">
                                <div class="signal-detail-label">TP2</div>
                                <div class="signal-detail-value">${this.formatPrice(signal.tp2)}</div>
                            </div>
                            <div class="signal-detail ${slClass}">
                                <div class="signal-detail-label">SL</div>
                                <div class="signal-detail-value">${this.formatPrice(signal.stopLoss)}</div>
                            </div>
                        </div>
                        <div class="signal-score">
                            <span class="score-label">Success Score</span>
                            <span class="score-value ${this.getScoreClass(signal.successScore)}">
                                <i class="fas fa-star"></i>
                                ${signal.successScore}%
                            </span>
                        </div>
                        ${signal.result ? `
                        <div class="signal-result ${signal.result.includes('Hit') ? 'result-success' : 'result-danger'}">
                            <i class="fas fa-${signal.result.includes('Hit') ? 'check-circle' : 'exclamation-circle'}"></i>
                            ${signal.result} (${this.getProfitPercentage(signal)}%)
                        </div>
                        ` : ''}
                    </div>
                `;
            }

            getProfitPercentage(signal) {
                if (signal.type === 'BUY') {
                    if (signal.hitTp2) return (((signal.tp2 - signal.entryPrice) / signal.entryPrice) * 100).toFixed(2);
                    if (signal.hitTp1) return (((signal.tp1 - signal.entryPrice) / signal.entryPrice) * 100).toFixed(2);
                    if (signal.hitSl) return (((signal.stopLoss - signal.entryPrice) / signal.entryPrice) * 100).toFixed(2);
                } else { // SELL
                    if (signal.hitTp2) return (((signal.entryPrice - signal.tp2) / signal.entryPrice) * 100).toFixed(2);
                    if (signal.hitTp1) return (((signal.entryPrice - signal.tp1) / signal.entryPrice) * 100).toFixed(2);
                    if (signal.hitSl) return (((signal.entryPrice - signal.stopLoss) / signal.entryPrice) * 100).toFixed(2);
                }
                return '0.00';
            }

            renderSignalsHistory() {
                const container = document.getElementById('signals-container');
                
                if (this.signals.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-chart-line"></i>
                            <p>No signals generated yet</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = this.signals.map(signal => {
                    const tp1Class = signal.hitTp1 ? 'hit' : '';
                    const tp2Class = signal.hitTp2 ? 'hit' : '';
                    const slClass = signal.hitSl ? 'miss' : '';
                    
                    return `
                    <div class="signal signal-${signal.type.toLowerCase()} ${signal.status === 'completed' ? 'signal-completed' : ''}">
                        <div class="signal-header">
                            <div class="signal-type ${signal.type.toLowerCase()}">${signal.type}</div>
                            <div class="signal-time">${new Date(signal.timestamp).toLocaleString()}</div>
                        </div>
                        <div class="signal-details">
                            <div class="signal-detail">
                                <div class="signal-detail-label">Entry</div>
                                <div class="signal-detail-value">${this.formatPrice(signal.entryPrice)}</div>
                            </div>
                            <div class="signal-detail ${tp1Class}">
                                <div class="signal-detail-label">TP1</div>
                                <div class="signal-detail-value">${this.formatPrice(signal.tp1)}</div>
                            </div>
                            <div class="signal-detail ${tp2Class}">
                                <div class="signal-detail-label">TP2</div>
                                <div class="signal-detail-value">${this.formatPrice(signal.tp2)}</div>
                            </div>
                            <div class="signal-detail ${slClass}">
                                <div class="signal-detail-label">SL</div>
                                <div class="signal-detail-value">${this.formatPrice(signal.stopLoss)}</div>
                            </div>
                        </div>
                        <div class="signal-score">
                            <span class="score-label">Success Score</span>
                            <span class="score-value ${this.getScoreClass(signal.successScore)}">
                                <i class="fas fa-star"></i>
                                ${signal.successScore}%
                            </span>
                        </div>
                        ${signal.result ? `
                        <div class="signal-result ${signal.result.includes('Hit') ? 'result-success' : 'result-danger'}">
                            <i class="fas fa-${signal.result.includes('Hit') ? 'check-circle' : 'exclamation-circle'}"></i>
                            ${signal.result} (${this.getProfitPercentage(signal)}%)
                        </div>
                        ` : ''}
                        <div style="margin-top: 0.75rem; font-size: 0.9rem; color: var(--text-secondary);">
                            ${signal.reason}
                        </div>
                    </div>
                    `;
                }).join('');
            }

            updateAnalytics() {
                const totalSignals = this.signals.length;
                const completedSignals = this.signals.filter(s => s.status === 'completed').length;
                const successfulSignals = this.signals.filter(s => (s.hitTp1 || s.hitTp2) && !s.hitSl).length;
                const winRate = completedSignals > 0 ? (successfulSignals / completedSignals * 100) : 0;
                
                const profits = this.signals
                    .filter(s => s.status === 'completed')
                    .map(s => parseFloat(this.getProfitPercentage(s)));
                
                const avgProfit = profits.length > 0 ? profits.reduce((a, b) => a + b, 0) / profits.length : 0;
                const bestSignal = profits.length > 0 ? Math.max(...profits) : 0;
                
                // Calculate accuracy based on success score vs actual results
                let accuracyScore = 0;
                if (completedSignals > 0) {
                    const scoreSum = this.signals
                        .filter(s => s.status === 'completed')
                        .reduce((sum, signal) => {
                            const predictedSuccess = signal.successScore / 100;
                            const actualSuccess = (signal.hitTp1 || signal.hitTp2) ? 1 : 0;
                            return sum + (1 - Math.abs(predictedSuccess - actualSuccess));
                        }, 0);
                    
                    accuracyScore = (scoreSum / completedSignals) * 100;
                }
                
                // Update displays
                document.getElementById('signal-count').textContent = `${totalSignals} signals`;
                document.getElementById('total-signals').textContent = totalSignals;
                document.getElementById('total-signals-dash').textContent = totalSignals;
                document.getElementById('successful-signals').textContent = successfulSignals;
                document.getElementById('avg-profit').textContent = `${avgProfit.toFixed(2)}%`;
                document.getElementById('win-rate').textContent = `${winRate.toFixed(1)}%`;
                document.getElementById('success-rate').textContent = `${winRate.toFixed(1)}%`;
                document.getElementById('best-signal').textContent = `${bestSignal.toFixed(2)}%`;
                document.getElementById('signals-per-hour').textContent = this.calculateSignalsPerHour();
                
                // Update accuracy bar
                document.getElementById('accuracy-percentage').textContent = `${accuracyScore.toFixed(1)}%`;
                document.getElementById('accuracy-bar').style.width = `${accuracyScore}%`;
                document.getElementById('accuracy-bar').className = `progress-bar ${
                    accuracyScore >= 70 ? 'progress-success' : 
                    accuracyScore >= 50 ? 'progress-warning' : 'progress-danger'
                }`;
            }

            calculateSignalsPerHour() {
                if (this.signals.length === 0) return '0';
                
                const now = new Date();
                const oneHourAgo = new Date(now.getTime() - 60 * 60 * 1000);
                const recentSignals = this.signals.filter(s => new Date(s.timestamp) > oneHourAgo);
                
                return recentSignals.length.toString();
            }

            calculateRSI(period = 14) {
                if (this.priceHistory.length < period + 1) return 50;
                
                const prices = this.priceHistory.slice(-period - 1).map(p => p.price);
                let gains = 0, losses = 0;
                
                for (let i = 1; i < prices.length; i++) {
                    const change = prices[i] - prices[i - 1];
                    if (change > 0) gains += change;
                    else losses -= change;
                }
                
                const avgGain = gains / period;
                const avgLoss = losses / period;
                
                if (avgLoss === 0) return 100;
                
                const rs = avgGain / avgLoss;
                return 100 - (100 / (1 + rs));
            }

            updateTechnicalIndicators() {
                const rsi = this.calculateRSI();
                document.getElementById('rsi-value').textContent = rsi.toFixed(1);
            }

            clearSignals() {
                if (confirm('Are you sure you want to clear all signal history?')) {
                    this.signals = [];
                    this.saveSignalHistory();
                    this.renderSignalsHistory();
                    this.updateAnalytics();
                    this.renderLatestSignal(null);
                    this.showNotification('Signal history cleared.', 'warning');
                }
            }

            saveSettingsFromUI() {
                this.settings = {
                    tradingPair: document.getElementById('trading-pair').value,
                    minProfit: parseFloat(document.getElementById('min-profit').value),
                    maxRisk: parseFloat(document.getElementById('max-risk').value),
                    volumeThreshold: parseFloat(document.getElementById('volume-threshold').value),
                    signalCooldown: parseInt(document.getElementById('signal-cooldown').value),
                    tp1Ratio: parseFloat(document.getElementById('tp1-ratio').value),
                    tp2Ratio: parseFloat(document.getElementById('tp2-ratio').value),
                    slRatio: parseFloat(document.getElementById('sl-ratio').value),
                    maxDailySignals: parseInt(document.getElementById('max-daily-signals').value),
                    minSuccessScore: parseInt(document.getElementById('min-success-score').value)
                };
                
                this.saveSettings();
                this.showNotification('Settings saved successfully!', 'success');
            }

            updateSettingsUI() {
                document.getElementById('trading-pair').value = this.settings.tradingPair;
                document.getElementById('min-profit').value = this.settings.minProfit;
                document.getElementById('max-risk').value = this.settings.maxRisk;
                document.getElementById('volume-threshold').value = this.settings.volumeThreshold;
                document.getElementById('signal-cooldown').value = this.settings.signalCooldown;
                document.getElementById('tp1-ratio').value = this.settings.tp1Ratio;
                document.getElementById('tp2-ratio').value = this.settings.tp2Ratio;
                document.getElementById('sl-ratio').value = this.settings.slRatio;
                document.getElementById('max-daily-signals').value = this.settings.maxDailySignals;
                document.getElementById('min-success-score').value = this.settings.minSuccessScore;
                
                this.currentSymbol = this.settings.tradingPair;
                document.getElementById('symbol-display').textContent = this.formatSymbol(this.currentSymbol);
            }

            loadSignalHistory() {
                const saved = localStorage.getItem('prosignal-signals');
                if (saved) {
                    this.signals = JSON.parse(saved);
                    this.updateAnalytics();
                    this.renderSignalsHistory();
                    if (this.signals.length > 0) {
                        this.renderLatestSignal(this.signals[0]);
                    }
                }
            }

            saveSignalHistory() {
                localStorage.setItem('prosignal-signals', JSON.stringify(this.signals));
            }

            reconnect() {
                if (this.ws) {
                    this.ws.close();
                }
                if (this.isRunning) {
                    setTimeout(() => this.connectWebSocket(), 2000);
                }
            }

            disconnectWebSocket() {
                if (this.ws) {
                    this.ws.close();
                    this.ws = null;
                }
            }

            updateConnectionStatus(isConnected) {
                const statusDot = document.getElementById('status-dot');
                const statusText = document.getElementById('status-text');
                
                if (isConnected) {
                    statusDot.classList.add('online');
                    statusText.textContent = 'Online';
                } else {
                    statusDot.classList.remove('online');
                    statusText.textContent = 'Offline';
                }
            }

            updateControlButtons() {
                const startBtn = document.getElementById('start-btn');
                const stopBtn = document.getElementById('stop-btn');
                
                startBtn.disabled = this.isRunning;
                stopBtn.disabled = !this.isRunning;
            }

            updateUI() {
                this.updateAnalytics();
                this.updateControlButtons();
            }

            showNotification(message, type = 'success') {
                const container = document.getElementById('notifications-container');
                
                const notification = document.createElement('div');
                notification.className = `alert alert-${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'danger' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    ${message}
                `;
                
                container.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 5000);
            }

            getScoreClass(score) {
                if (score >= 80) return 'score-high';
                if (score >= 60) return 'score-medium';
                return 'score-low';
            }

            generateId() {
                return 'signal_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }

            formatPrice(price) {
                if (price >= 1000) return price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                if (price >= 1) return price.toFixed(4);
                if (price >= 0.001) return price.toFixed(6);
                return price.toFixed(8);
            }

            formatVolume(volume) {
                if (volume >= 1e9) return (volume / 1e9).toFixed(2) + 'B';
                if (volume >= 1e6) return (volume / 1e6).toFixed(2) + 'M';
                if (volume >= 1e3) return (volume / 1e3).toFixed(2) + 'K';
                return volume.toFixed(2);
            }

            formatSymbol(symbol) {
                return symbol.replace('USDT', '/USDT');
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            window.proSignalBot = new ProSignalBot();
            
            // Add some demo data for testing
            setTimeout(() => {
                if (window.proSignalBot.signals.length === 0) {
                    const demoSignals = [
                        {
                            id: 'demo1',
                            type: 'BUY',
                            timestamp: new Date(Date.now() - 300000).toISOString(),
                            entryPrice: 43250.50,
                            tp1: 43318.70,
                            tp2: 43386.90,
                            stopLoss: 43120.25,
                            successScore: 85,
                            reason: 'Strong bullish momentum with high volume support',
                            symbol: 'BTCUSDT',
                            status: 'completed',
                            hitTp1: true,
                            hitTp2: true,
                            hitSl: false,
                            result: 'TP2 Hit'
                        },
                        {
                            id: 'demo2',
                            type: 'SELL',
                            timestamp: new Date(Date.now() - 600000).toISOString(),
                            entryPrice: 43420.75,
                            tp1: 43352.15,
                            tp2: 43283.55,
                            stopLoss: 43551.05,
                            successScore: 78,
                            reason: 'Resistance level reached with decreasing volume',
                            symbol: 'BTCUSDT',
                            status: 'completed',
                            hitTp1: true,
                            hitTp2: false,
                            hitSl: false,
                            result: 'TP1 Hit'
                        },
                        {
                            id: 'demo3',
                            type: 'BUY',
                            timestamp: new Date(Date.now() - 900000).toISOString(),
                            entryPrice: 43180.25,
                            tp1: 43248.45,
                            tp2: 43316.65,
                            stopLoss: 43050.85,
                            successScore: 92,
                            reason: 'Strong support level bounce with increasing volume',
                            symbol: 'BTCUSDT',
                            status: 'completed',
                            hitTp1: false,
                            hitTp2: false,
                            hitSl: true,
                            result: 'SL Hit'
                        }
                    ];
                    
                    window.proSignalBot.signals = demoSignals;
                    window.proSignalBot.renderSignalsHistory();
                    window.proSignalBot.updateAnalytics();
                    window.proSignalBot.renderLatestSignal(demoSignals[0]);
                }
            }, 1000);

            // Auto-save every minute
            setInterval(() => {
                if (window.proSignalBot) {
                    window.proSignalBot.saveSignalHistory();
                }
            }, 60000);

            // Reset daily signal count at midnight
            setInterval(() => {
                const now = new Date();
                if (now.getHours() === 0 && now.getMinutes() === 0 && now.getSeconds() === 0) {
                    if (window.proSignalBot) {
                        window.proSignalBot.dailySignalCount = 0;
                    }
                }
            }, 1000);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        if (window.proSignalBot) {
                            window.proSignalBot.isRunning ? window.proSignalBot.stop() : window.proSignalBot.start();
                        }
                        break;
                    case 'r':
                        e.preventDefault();
                        if (window.proSignalBot && window.proSignalBot.isRunning) {
                            window.proSignalBot.reconnect();
                        }
                        break;
                    case '1':
                        e.preventDefault();
                        document.querySelector('[data-tab="dashboard"]').click();
                        break;
                    case '2':
                        e.preventDefault();
                        document.querySelector('[data-tab="signals"]').click();
                        break;
                    case '3':
                        e.preventDefault();
                        document.querySelector('[data-tab="settings"]').click();
                        break;
                    case '4':
                        e.preventDefault();
                        document.querySelector('[data-tab="analytics"]').click();
                        break;
                }
            }
        });

        // Visibility change handler for performance optimization
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                // Page is hidden, reduce activity
                console.log('Page hidden - reducing background activity');
            } else {
                // Page is visible, resume normal activity
                console.log('Page visible - resuming normal activity');
                if (window.proSignalBot) {
                    window.proSignalBot.updateUI();
                }
            }
        });

        // Handle online/offline events
        window.addEventListener('online', () => {
            if (window.proSignalBot && window.proSignalBot.isRunning) {
                window.proSignalBot.showNotification('Internet connection restored. Reconnecting...', 'success');
                window.proSignalBot.reconnect();
            }
        });

        window.addEventListener('offline', () => {
            if (window.proSignalBot) {
                window.proSignalBot.showNotification('Internet connection lost.', 'warning');
                window.proSignalBot.updateConnectionStatus(false);
            }
        });

        // Service worker registration for offline support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Service worker would be registered here in a production environment
                console.log('Service Worker support detected');
            });
        }

        // Performance monitoring
        if ('performance' in window) {
            window.addEventListener('load', () => {
                setTimeout(() => {
                    const perfData = performance.timing;
                    const loadTime = perfData.loadEventEnd - perfData.navigationStart;
                    console.log(`Page load time: ${loadTime}ms`);
                }, 0);
            });
        }
		
		// ProSignal Bot Backend Bağlantısı
class BackendConnector {
    constructor() {
        this.ws = null;
        this.connected = false;
        this.reconnectAttempts = 0;
        this.maxReconnectAttempts = 10;
        this.reconnectDelay = 1000;
    }

    connect() {
        try {
            this.ws = new WebSocket('ws://localhost:8765');
            
            this.ws.onopen = () => {
                this.connected = true;
                this.reconnectAttempts = 0;
                console.log('✅ Backend bağlantısı kuruldu');
                this.onConnect();
            };
            
            this.ws.onclose = () => {
                this.connected = false;
                console.log('❌ Backend bağlantısı koptu');
                this.attemptReconnect();
            };
            
            this.ws.onerror = (error) => {
                console.error('WebSocket hatası:', error);
            };
            
            this.ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                this.handleMessage(data);
            };
            
        } catch (error) {
            console.error('Bağlantı hatası:', error);
            this.attemptReconnect();
        }
    }

    attemptReconnect() {
        if (this.reconnectAttempts < this.maxReconnectAttempts) {
            this.reconnectAttempts++;
            console.log(`Yeniden bağlanma denemesi ${this.reconnectAttempts}/${this.maxReconnectAttempts}`);
            setTimeout(() => this.connect(), this.reconnectDelay * this.reconnectAttempts);
        }
    }

    send(data) {
        if (this.connected && this.ws.readyState === WebSocket.OPEN) {
            this.ws.send(JSON.stringify(data));
        }
    }

    onConnect() {
        // Bağlantı kurulduğunda pozisyonları iste
        this.send({ type: 'get_positions' });
    }

    handleMessage(data) {
        switch (data.type) {
            case 'dashboard_update':
                this.updateDashboard(data);
                break;
            case 'position_update':
                this.updatePosition(data.position);
                break;
            case 'positions':
                this.updateAllPositions(data.positions);
                break;
            case 'alert':
                window.proSignalBot.showNotification(data.message, data.level);
                break;
            case 'price_update':
                // Fiyat güncellemelerini işle
                break;
        }
    }

    updateDashboard(data) {
        // Kasa bilgilerini güncelle
        const dashboardHTML = `
            <div class="grid grid-cols-4">
                <div class="stat-card">
                    <div class="stat-label">Bakiye</div>
                    <div class="stat-value">${data.balance.toFixed(2)}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Günlük Kar/Zarar</div>
                    <div class="stat-value" style="color: ${data.daily_pnl >= 0 ? 'var(--success)' : 'var(--danger)'}">
                        ${data.daily_pnl >= 0 ? '+' : ''}${data.daily_pnl.toFixed(2)}
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Toplam Kar/Zarar</div>
                    <div class="stat-value" style="color: ${data.total_pnl >= 0 ? 'var(--success)' : 'var(--danger)'}">
                        ${data.total_pnl >= 0 ? '+' : ''}${data.total_pnl.toFixed(2)}
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Başarı Oranı</div>
                    <div class="stat-value">${data.win_rate.toFixed(1)}%</div>
                </div>
            </div>
        `;
        
        // Dashboard'a kasa bölümü ekle
        const kasaSection = document.getElementById('kasa-section');
        if (kasaSection) {
            kasaSection.innerHTML = dashboardHTML;
        }
    }

    updatePosition(position) {
        // Pozisyon güncellemesi
        console.log('Pozisyon güncellendi:', position);
    }

    updateAllPositions(positions) {
        // Tüm pozisyonları güncelle
        const positionsHTML = positions.map(pos => {
            const pnlColor = pos.pnl >= 0 ? 'var(--success)' : 'var(--danger)';
            const statusClass = pos.status === 'active' ? 'active' : 'closed';
            
            return `
                <div class="signal signal-${pos.side.toLowerCase()} position-${statusClass}">
                    <div class="signal-header">
                        <div class="signal-type ${pos.side.toLowerCase()}">${pos.side}</div>
                        <div class="signal-time">${new Date(pos.open_time).toLocaleString()}</div>
                    </div>
                    <div class="signal-details">
                        <div class="signal-detail">
                            <div class="signal-detail-label">Giriş</div>
                            <div class="signal-detail-value">${pos.entry_price.toFixed(2)}</div>
                        </div>
                        <div class="signal-detail ${pos.tp1_hit ? 'hit' : ''}">
                            <div class="signal-detail-label">TP1</div>
                            <div class="signal-detail-value">${pos.tp1.toFixed(2)}</div>
                        </div>
                        <div class="signal-detail ${pos.tp2_hit ? 'hit' : ''}">
                            <div class="signal-detail-label">TP2</div>
                            <div class="signal-detail-value">${pos.tp2.toFixed(2)}</div>
                        </div>
                        <div class="signal-detail ${pos.sl_hit ? 'miss' : ''}">
                            <div class="signal-detail-label">SL</div>
                            <div class="signal-detail-value">${pos.sl.toFixed(2)}</div>
                        </div>
                    </div>
                    <div class="signal-score">
                        <span class="score-label">Kar/Zarar</span>
                        <span class="score-value" style="color: ${pnlColor}">
                            ${pos.pnl >= 0 ? '+' : ''}${pos.pnl.toFixed(2)}
                        </span>
                    </div>
                    ${pos.status === 'active' ? `
                        <button class="btn btn-danger btn-block" onclick="window.backendConnector.closePosition('${pos.id}')">
                            <i class="fas fa-times"></i> Pozisyonu Kapat
                        </button>
                    ` : ''}
                </div>
            `;
        }).join('');
        
        const positionsContainer = document.getElementById('active-positions');
        if (positionsContainer) {
            positionsContainer.innerHTML = positionsHTML || '<div class="empty-state"><i class="fas fa-chart-line"></i><p>Aktif pozisyon yok</p></div>';
        }
    }

    closePosition(positionId) {
        if (confirm('Bu pozisyonu kapatmak istediğinize emin misiniz?')) {
            this.send({
                type: 'close_position',
                position_id: positionId
            });
        }
    }
}

// Backend connector'ı başlat
window.backendConnector = new BackendConnector();

// ProSignalBot'a backend entegrasyonu ekle
const originalAddSignal = window.proSignalBot.addSignal;
window.proSignalBot.addSignal = function(signal) {
    // Orijinal fonksiyonu çağır
    originalAddSignal.call(this, signal);
    
    // Backend'e sinyal gönder
    if (window.backendConnector.connected) {
        window.backendConnector.send({
            type: 'signal',
            signal: signal
        });
    }
};

// Sayfa yüklendiğinde backend'e bağlan
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
        window.backendConnector.connect();
        
        // Dashboard'a kasa bölümü ekle
        const dashboardTab = document.getElementById('dashboard');
        if (dashboardTab) {
            const kasaSection = document.createElement('div');
            kasaSection.id = 'kasa-section';
            kasaSection.style.marginTop = '2rem';
            dashboardTab.appendChild(kasaSection);
            
            // Aktif pozisyonlar bölümü
            const positionsSection = document.createElement('div');
            positionsSection.className = 'card';
            positionsSection.style.marginTop = '2rem';
            positionsSection.innerHTML = `
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-chart-line"></i>
                        Aktif Pozisyonlar
                    </div>
                </div>
                <div id="active-positions">
                    <div class="empty-state">
                        <i class="fas fa-chart-line"></i>
                        <p>Aktif pozisyon yok</p>
                    </div>
                </div>
            `;
            dashboardTab.appendChild(positionsSection);
        }
    }, 1000);
});

    </script>
</body>
</html>
